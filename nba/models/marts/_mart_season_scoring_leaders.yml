version: 2

models:
  - name: mart_season_scoring_leaders
    description: This model identifies the highest scoring player for each NBA regular season
    meta:
      owner: "dinoai"
    columns:
      - name: season
        description: The NBA season in YYYY format
        tests:
          - not_null
          - unique

      - name: player_id
        description: Unique identifier for the player
        tests:
          - not_null

      - name: player_name
        description: Full name of the player
        tests:
          - not_null

      - name: total_points
        description: Total points scored by the player in the regular season
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0

      - name: games_played
        description: Number of games played by the player in the regular season
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 1
              max_value: 82

      - name: points_per_game
        description: Average points scored per game (total_points / games_played)
        tests:
          - not_null