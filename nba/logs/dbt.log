[0m05:05:50.697974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d983350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d977210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc2fad0>]}


============================== 05:05:50.701110 | 396963c5-343a-4884-823a-5092cc415fe6 ==============================
[0m05:05:50.701110 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:05:50.702114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_season_scoring_leaders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:05:51.677419 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m05:05:51.678171 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m05:05:51.679364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff679afe90>]}
[0m05:05:51.753573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd37e90>]}
[0m05:05:51.754643 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:05:51.892869 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:05:51.893854 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:05:51.894664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6595f350>]}
[0m05:05:52.899875 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:05:52.900610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65630510>]}
[0m05:05:53.058773 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_player_salaries_by_season' in the 'models' section of file 'models/staging/schema.yml'
[0m05:05:53.175960 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m05:05:53.355284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64d1a790>]}
[0m05:05:53.479368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff659d6e50>]}
[0m05:05:53.480131 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 1 exposure, 461 macros
[0m05:05:53.480890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67ca3a90>]}
[0m05:05:53.482863 [info ] [MainThread]: 
[0m05:05:53.483589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:05:53.484857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m05:05:53.498477 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m05:05:53.499045 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m05:05:53.499932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:55.465557 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.966 seconds
[0m05:05:55.467609 [debug] [ThreadPool]: On list_NBA: Close
[0m05:05:55.682269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m05:05:55.683131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_dbt_parker'
[0m05:05:55.683851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m05:05:55.699319 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m05:05:55.699824 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m05:05:55.700716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:55.690315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m05:05:55.705947 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m05:05:55.694494 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m05:05:55.706535 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m05:05:55.708353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:55.707429 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m05:05:55.696997 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m05:05:55.711335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:55.712246 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m05:05:55.714172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:56.314710 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.601 seconds
[0m05:05:56.316792 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m05:05:56.320147 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.609 seconds
[0m05:05:56.323264 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m05:05:56.346201 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.645 seconds
[0m05:05:56.349251 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m05:05:56.389882 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.681 seconds
[0m05:05:56.392064 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m05:05:56.564745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f222ad0>]}
[0m05:05:56.565542 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:05:56.566360 [info ] [MainThread]: 
[0m05:05:56.572372 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m05:05:56.573084 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_parker.mart_season_scoring_leaders ............. [RUN]
[0m05:05:56.573923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.mart_season_scoring_leaders)
[0m05:05:56.574637 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m05:05:56.582538 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m05:05:56.589197 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m05:05:56.617442 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m05:05:56.625422 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m05:05:56.626037 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace   view NBA.dbt_parker.mart_season_scoring_leaders
  
   as (
    WITH player_season_stats AS (
    SELECT
        player_id,
        player_name,
        season,
        SUM(points) as total_pts,
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points)::FLOAT / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        season,
        player_id,
        player_name,
        total_points,
        games_played,
        points_per_game,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_points DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1
  );
[0m05:05:56.626854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:57.224281 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1ab1-0106-75c0-0011-7a4300023172
[0m05:05:57.224942 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 8
invalid identifier 'TOTAL_POINTS'
[0m05:05:57.226280 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m05:05:57.408390 [debug] [Thread-1 (]: Database Error in model mart_season_scoring_leaders (models/marts/mart_season_scoring_leaders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'TOTAL_POINTS'
  compiled code at target/run/nba/models/marts/mart_season_scoring_leaders.sql
[0m05:05:57.410320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396963c5-343a-4884-823a-5092cc415fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64b47390>]}
[0m05:05:57.411212 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_parker.mart_season_scoring_leaders .... [[31mERROR[0m in 0.84s]
[0m05:05:57.412041 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m05:05:57.414056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:57.414532 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m05:05:57.415411 [debug] [MainThread]: Connection 'list_NBA_dbt_parker' was properly closed.
[0m05:05:57.416228 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m05:05:57.416985 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m05:05:57.417844 [info ] [MainThread]: 
[0m05:05:57.418670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m05:05:57.419846 [debug] [MainThread]: Command end result
[0m05:05:57.462798 [info ] [MainThread]: 
[0m05:05:57.463486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:05:57.464234 [info ] [MainThread]: 
[0m05:05:57.465120 [error] [MainThread]:   Database Error in model mart_season_scoring_leaders (models/marts/mart_season_scoring_leaders.sql)
  000904 (42000): SQL compilation error: error line 25 at position 8
  invalid identifier 'TOTAL_POINTS'
  compiled code at target/run/nba/models/marts/mart_season_scoring_leaders.sql
[0m05:05:57.465881 [info ] [MainThread]: 
[0m05:05:57.466776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:05:57.468163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.83314, "process_user_time": 4.349096, "process_kernel_time": 0.361587, "process_mem_max_rss": "243420", "process_out_blocks": "4264", "command_success": false, "process_in_blocks": "0"}
[0m05:05:57.468879 [debug] [MainThread]: Command `dbt run` failed at 05:05:57.468767 after 6.83 seconds
[0m05:05:57.469703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9d1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803f4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d977350>]}
[0m05:05:57.470418 [debug] [MainThread]: Flushing usage events
[0m05:25:12.663704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8246a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83375190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8246a290>]}


============================== 05:25:12.667021 | 4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729 ==============================
[0m05:25:12.667021 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:25:12.668032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:25:13.667903 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m05:25:13.668652 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m05:25:13.669835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aaca090>]}
[0m05:25:13.740214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82828090>]}
[0m05:25:13.741311 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:25:13.884359 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:25:14.020607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:25:14.021616 [debug] [MainThread]: Partial parsing: updated file: nba://models/marts/mart_season_scoring_leaders.sql
[0m05:25:14.295932 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:25:14.296693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff696fb5d0>]}
[0m05:25:14.433416 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m05:25:14.545214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a04a550>]}
[0m05:25:14.665700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2f1a50>]}
[0m05:25:14.666451 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 1 exposure, 461 macros
[0m05:25:14.667245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69704650>]}
[0m05:25:14.669855 [info ] [MainThread]: 
[0m05:25:14.670586 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:14.676369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m05:25:14.677104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m05:25:14.764990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m05:25:14.776691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m05:25:14.791054 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m05:25:14.797791 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m05:25:14.799107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:14.794335 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m05:25:14.798624 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m05:25:14.797175 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m05:25:14.806550 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m05:25:14.805138 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m05:25:14.803688 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m05:25:14.809484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:14.808197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:14.807371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:15.619520 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.812 seconds
[0m05:25:15.622240 [debug] [ThreadPool]: On list_NBA: Close
[0m05:25:15.629812 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.822 seconds
[0m05:25:15.632277 [debug] [ThreadPool]: On list_NBA: Close
[0m05:25:15.634860 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.836 seconds
[0m05:25:15.638281 [debug] [ThreadPool]: On list_NBA: Close
[0m05:25:16.477435 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.668 seconds
[0m05:25:16.479469 [debug] [ThreadPool]: On list_NBA: Close
[0m05:25:16.684480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m05:25:16.685254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_dbt_parker)
[0m05:25:16.685975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m05:25:16.695533 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m05:25:16.696404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m05:25:16.698959 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m05:25:16.701235 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m05:25:16.701842 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m05:25:16.704465 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m05:25:16.707482 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m05:25:16.705902 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m05:25:16.709127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:16.705019 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m05:25:16.708279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:16.706660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:16.712116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:17.357997 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.650 seconds
[0m05:25:17.360533 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m05:25:17.484721 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.773 seconds
[0m05:25:17.486656 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m05:25:17.543151 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.836 seconds
[0m05:25:17.544975 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m05:25:18.581376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.872 seconds
[0m05:25:18.583496 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m05:25:18.851781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a6bfdd0>]}
[0m05:25:18.852632 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m05:25:18.853418 [info ] [MainThread]: 
[0m05:25:18.857991 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m05:25:18.858723 [info ] [Thread-1 (]: 1 of 13 START sql view model staging.stg_common_player_info .................... [RUN]
[0m05:25:18.861741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_common_player_info)
[0m05:25:18.859974 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m05:25:18.860470 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m05:25:18.866592 [info ] [Thread-4 (]: 4 of 13 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m05:25:18.867497 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_team_spend_by_season)
[0m05:25:18.864120 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m05:25:18.863545 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m05:25:18.865168 [info ] [Thread-3 (]: 3 of 13 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m05:25:18.879172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_dbt_parker, now model.nba.stg_player_game_logs)
[0m05:25:18.862863 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m05:25:18.880932 [info ] [Thread-6 (]: 6 of 13 START sql view model staging.stg_teams ................................. [RUN]
[0m05:25:18.882191 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m05:25:18.882761 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m05:25:18.859424 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m05:25:18.891137 [info ] [Thread-2 (]: 2 of 13 START sql view model staging.stg_games ................................. [RUN]
[0m05:25:18.893460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_games)
[0m05:25:18.877374 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m05:25:18.878153 [info ] [Thread-5 (]: 5 of 13 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m05:25:18.889386 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m05:25:18.879991 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m05:25:18.868846 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m05:25:18.907182 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m05:25:18.897294 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m05:25:18.894872 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m05:25:18.907781 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m05:25:18.908894 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m05:25:18.909678 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m05:25:18.913735 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m05:25:18.919567 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m05:25:18.920126 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m05:25:18.957773 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m05:25:18.948421 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m05:25:18.953155 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m05:25:18.953770 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m05:25:18.944981 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m05:25:18.959186 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m05:25:18.963810 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m05:25:18.964827 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m05:25:18.976959 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m05:25:18.967396 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m05:25:18.972568 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m05:25:18.974335 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m05:25:18.965351 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m05:25:18.985878 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m05:25:18.979445 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m05:25:18.980272 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m05:25:18.994252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:25:18.978812 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m05:25:18.997285 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m05:25:18.998163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:25:18.982310 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m05:25:18.989163 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m05:25:19.002253 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m05:25:19.003318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m05:25:18.993589 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m05:25:19.006383 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m05:25:19.007347 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m05:25:19.001182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:19.656812 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m05:25:19.680890 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m05:25:19.701717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m05:25:19.703718 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m05:25:19.723658 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m05:25:19.725656 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m05:25:19.745474 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m05:25:19.747795 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m05:25:19.831699 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m05:25:19.833915 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m05:25:19.835205 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m05:25:19.837856 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m05:25:19.854435 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff705b91d0>]}
[0m05:25:19.855369 [info ] [Thread-4 (]: 4 of 13 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 0.99s]
[0m05:25:19.856392 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m05:25:19.860874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6962aed0>]}
[0m05:25:19.861705 [info ] [Thread-1 (]: 1 of 13 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.00s]
[0m05:25:19.862455 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m05:25:19.863526 [debug] [Thread-8 (]: Began running node model.nba.fct_players_by_college_example
[0m05:25:19.864197 [info ] [Thread-8 (]: 7 of 13 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m05:25:19.865097 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_players_by_college_example'
[0m05:25:19.865823 [debug] [Thread-8 (]: Began compiling node model.nba.fct_players_by_college_example
[0m05:25:19.869626 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m05:25:19.873173 [debug] [Thread-8 (]: Began executing node model.nba.fct_players_by_college_example
[0m05:25:19.894697 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m05:25:19.896888 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2d4310>]}
[0m05:25:19.897743 [info ] [Thread-6 (]: 6 of 13 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.01s]
[0m05:25:19.899304 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m05:25:19.900568 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m05:25:19.902018 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m05:25:19.902931 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m05:25:19.911955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6963ecd0>]}
[0m05:25:19.912882 [info ] [Thread-3 (]: 3 of 13 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.03s]
[0m05:25:19.913714 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m05:25:19.914957 [debug] [Thread-4 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m05:25:19.915523 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m05:25:19.916845 [debug] [Thread-7 (]: Began running node model.nba.player_game_logs_agg_example
[0m05:25:19.917631 [info ] [Thread-4 (]: 8 of 13 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m05:25:19.919427 [info ] [Thread-1 (]: 9 of 13 START sql view model dbt_parker.mart_season_scoring_leaders ............ [RUN]
[0m05:25:19.920294 [info ] [Thread-7 (]: 10 of 13 START sql view model intermediate.player_game_logs_agg_example ........ [RUN]
[0m05:25:19.922506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_playoff_games_by_player_example)
[0m05:25:19.923599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now model.nba.mart_season_scoring_leaders)
[0m05:25:19.924465 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.player_game_logs_agg_example'
[0m05:25:19.926857 [debug] [Thread-7 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m05:25:19.926048 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m05:25:19.925200 [debug] [Thread-4 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m05:25:19.932771 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m05:25:19.935985 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m05:25:19.939413 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m05:25:19.942579 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m05:25:19.947835 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m05:25:19.948383 [debug] [Thread-7 (]: Began executing node model.nba.player_game_logs_agg_example
[0m05:25:19.948900 [debug] [Thread-4 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m05:25:19.952744 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m05:25:19.955619 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m05:25:19.957452 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m05:25:19.958931 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace   view NBA.dbt_parker.mart_season_scoring_leaders
  
   as (
    WITH player_season_stats AS (
    SELECT
        player_id,
        player_name,
        season,
        SUM(points) as total_points,
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points)::FLOAT / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        season,
        player_id,
        player_name,
        total_points,
        games_played,
        points_per_game,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_points DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1
  );
[0m05:25:19.959691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:19.961699 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m05:25:19.965653 [debug] [Thread-7 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m05:25:19.967465 [debug] [Thread-4 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m05:25:19.969095 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m05:25:19.968225 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m05:25:19.971803 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m05:25:20.004588 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff697899d0>]}
[0m05:25:20.005633 [info ] [Thread-5 (]: 5 of 13 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.11s]
[0m05:25:20.006576 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m05:25:20.007908 [debug] [Thread-3 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m05:25:20.008852 [info ] [Thread-3 (]: 11 of 13 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m05:25:20.010538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_playoff_appearances_by_team_example)
[0m05:25:20.011344 [debug] [Thread-3 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m05:25:20.015306 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m05:25:20.018017 [debug] [Thread-3 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m05:25:20.020955 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m05:25:20.025267 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m05:25:20.026520 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m05:25:20.027210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m05:25:20.028813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831fab90>]}
[0m05:25:20.030891 [info ] [Thread-2 (]: 2 of 13 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.14s]
[0m05:25:20.032004 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m05:25:20.703982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m05:25:20.706218 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m05:25:20.789774 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m05:25:20.792022 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: Close
[0m05:25:20.904972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69ff6450>]}
[0m05:25:20.905948 [info ] [Thread-1 (]: 9 of 13 OK created sql view model dbt_parker.mart_season_scoring_leaders ....... [[32mSUCCESS 1[0m in 0.98s]
[0m05:25:20.906944 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m05:25:20.972734 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff705b9710>]}
[0m05:25:20.973651 [info ] [Thread-7 (]: 10 of 13 OK created sql view model intermediate.player_game_logs_agg_example ... [[32mSUCCESS 1[0m in 1.05s]
[0m05:25:20.974844 [debug] [Thread-7 (]: Finished running node model.nba.player_game_logs_agg_example
[0m05:25:20.976398 [debug] [Thread-5 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m05:25:20.978061 [info ] [Thread-5 (]: 12 of 13 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m05:25:20.976954 [debug] [Thread-6 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m05:25:20.979496 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.fct_player_points_per_playoff_season_example)
[0m05:25:20.980584 [info ] [Thread-6 (]: 13 of 13 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m05:25:20.982333 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_player_points_per_regular_season_example)
[0m05:25:20.981483 [debug] [Thread-5 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m05:25:20.983092 [debug] [Thread-6 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m05:25:20.987620 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m05:25:20.990378 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m05:25:21.003929 [debug] [Thread-6 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m05:25:21.014098 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m05:25:21.015029 [debug] [Thread-5 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m05:25:21.018380 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m05:25:21.022256 [debug] [Thread-6 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m05:25:21.022866 [debug] [Thread-6 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m05:25:21.024196 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m05:25:21.026125 [debug] [Thread-5 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m05:25:21.028697 [debug] [Thread-5 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m05:25:21.029280 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m05:25:21.853615 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.826 seconds
[0m05:25:21.855807 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m05:25:21.988956 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 2.086 seconds
[0m05:25:21.991166 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: Close
[0m05:25:22.034922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff695b9350>]}
[0m05:25:22.035856 [info ] [Thread-3 (]: 11 of 13 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 2.02s]
[0m05:25:22.037839 [debug] [Thread-3 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m05:25:22.190170 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a091350>]}
[0m05:25:22.191106 [info ] [Thread-8 (]: 7 of 13 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 2.32s]
[0m05:25:22.192239 [debug] [Thread-8 (]: Finished running node model.nba.fct_players_by_college_example
[0m05:25:22.195498 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.226 seconds
[0m05:25:22.197483 [debug] [Thread-4 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m05:25:22.372154 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836ab190>]}
[0m05:25:22.373069 [info ] [Thread-4 (]: 8 of 13 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 2.45s]
[0m05:25:22.374947 [debug] [Thread-4 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m05:25:22.780183 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.751 seconds
[0m05:25:22.782504 [debug] [Thread-5 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m05:25:22.811378 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.787 seconds
[0m05:25:22.814074 [debug] [Thread-6 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m05:25:22.952993 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a4bcb90>]}
[0m05:25:22.954140 [info ] [Thread-5 (]: 12 of 13 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.97s]
[0m05:25:22.955344 [debug] [Thread-5 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m05:25:23.367793 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c2b5b66-67df-4bf4-b8cb-4e84bb6e8729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8321ed90>]}
[0m05:25:23.368720 [info ] [Thread-6 (]: 13 of 13 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 2.39s]
[0m05:25:23.370118 [debug] [Thread-6 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m05:25:23.372364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:23.372856 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m05:25:23.373715 [debug] [MainThread]: Connection 'model.nba.stg_games' was properly closed.
[0m05:25:23.374535 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m05:25:23.375717 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m05:25:23.376626 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m05:25:23.377455 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m05:25:23.378428 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m05:25:23.379228 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m05:25:23.380220 [info ] [MainThread]: 
[0m05:25:23.381035 [info ] [MainThread]: Finished running 8 view models, 5 table models in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m05:25:23.383375 [debug] [MainThread]: Command end result
[0m05:25:23.428779 [info ] [MainThread]: 
[0m05:25:23.429507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:23.430354 [info ] [MainThread]: 
[0m05:25:23.431197 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m05:25:23.432689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.827504, "process_user_time": 4.247875, "process_kernel_time": 0.470918, "process_mem_max_rss": "248792", "process_out_blocks": "6216", "process_in_blocks": "0"}
[0m05:25:23.433422 [debug] [MainThread]: Command `dbt run` succeeded at 05:25:23.433297 after 10.83 seconds
[0m05:25:23.434205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824b8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8244ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8244bad0>]}
[0m05:25:23.434983 [debug] [MainThread]: Flushing usage events
