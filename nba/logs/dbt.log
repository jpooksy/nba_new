[0m01:17:27.343683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1cee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b216e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b387d90>]}


============================== 01:17:27.347060 | 8cd3b9f6-b2c9-4661-b2ea-87246d2420c5 ==============================
[0m01:17:27.347060 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:17:27.349012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_common_player_info', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:17:28.379644 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:17:28.380464 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:17:28.382783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8923be10>]}
[0m01:17:28.455068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b593d90>]}
[0m01:17:28.456208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:17:28.594900 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:17:28.766253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:28.766891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:28.769071 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:17:28.816139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893eb890>]}
[0m01:17:28.938291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831c2fd0>]}
[0m01:17:28.939112 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 460 macros
[0m01:17:28.940971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893c0c50>]}
[0m01:17:28.944170 [info ] [MainThread]: 
[0m01:17:28.945071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:28.947525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:17:28.964808 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:17:28.965454 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:17:28.967489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:29.515655 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m01:17:29.517650 [debug] [ThreadPool]: On list_NBA: Close
[0m01:17:29.698361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:17:29.699269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:17:29.700957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:17:29.709988 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:17:29.712649 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:17:29.715070 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:17:29.715676 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:17:29.717596 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:17:29.719430 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:17:29.721281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:29.723061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:29.724931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:30.167232 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.442 seconds
[0m01:17:30.169422 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:17:30.324011 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m01:17:30.326650 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:17:30.327923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.605 seconds
[0m01:17:30.330838 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:17:30.532506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f088d0>]}
[0m01:17:30.533364 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:17:30.536288 [info ] [MainThread]: 
[0m01:17:30.544327 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:17:30.545210 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_common_player_info ..................... [RUN]
[0m01:17:30.547383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_common_player_info)
[0m01:17:30.549196 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:17:30.558764 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:17:30.574872 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:17:30.609123 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:17:30.624990 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:17:30.625748 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:17:30.627586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:31.256079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m01:17:31.281492 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:17:31.469859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83183e10>]}
[0m01:17:31.481443 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_common_player_info ................ [[32mSUCCESS 1[0m in 0.92s]
[0m01:17:31.482412 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:17:31.486128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:31.488022 [debug] [MainThread]: Connection 'model.nba.stg_common_player_info' was properly closed.
[0m01:17:31.489902 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:17:31.492381 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m01:17:31.494854 [info ] [MainThread]: 
[0m01:17:31.497357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m01:17:31.500316 [debug] [MainThread]: Command end result
[0m01:17:31.551684 [info ] [MainThread]: 
[0m01:17:31.552486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:31.554268 [info ] [MainThread]: 
[0m01:17:31.556247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:17:31.558763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.279582, "process_user_time": 3.213458, "process_kernel_time": 0.301261, "process_mem_max_rss": "232192", "process_in_blocks": "1112", "process_out_blocks": "2904"}
[0m01:17:31.560893 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:31.560738 after 4.28 seconds
[0m01:17:31.562673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc38cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1a7810>]}
[0m01:17:31.564525 [debug] [MainThread]: Flushing usage events
[0m01:17:39.039035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d54dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d4a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f076d0>]}


============================== 01:17:39.042313 | 5baefe50-b396-4bf3-975b-91ec22ef2664 ==============================
[0m01:17:39.042313 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:17:39.044466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:17:40.075875 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:17:40.076714 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:17:40.079050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa219e050>]}
[0m01:17:40.151343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb910bd50>]}
[0m01:17:40.152469 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:17:40.289437 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:17:40.432180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:40.432818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:40.435146 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:17:40.482773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dee310>]}
[0m01:17:40.619068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0854f50>]}
[0m01:17:40.619942 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 460 macros
[0m01:17:40.621799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d4be10>]}
[0m01:17:40.625399 [info ] [MainThread]: 
[0m01:17:40.626257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:40.633242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:17:40.634103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:17:40.642168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:17:40.653161 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:17:40.655974 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:17:40.658546 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:17:40.659182 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:17:40.664941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:40.663001 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:17:40.661095 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:17:40.670259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:40.671651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:41.192347 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.527 seconds
[0m01:17:41.194827 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:17:41.287270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:17:41.289451 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:17:41.416045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.744 seconds
[0m01:17:41.418326 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:17:41.586593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21dd7d0>]}
[0m01:17:41.587458 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:17:41.589289 [info ] [MainThread]: 
[0m01:17:41.593851 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m01:17:41.594445 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.595010 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.595658 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m01:17:41.597596 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m01:17:41.599461 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m01:17:41.602134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.not_null_full_name.26df58b172)
[0m01:17:41.603223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_player_id.2d6184285e)
[0m01:17:41.605068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.unique_player_id.489f92cfc7)
[0m01:17:41.606906 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m01:17:41.608647 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.610493 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.628399 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.632990 [debug] [Thread-2 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.639868 [debug] [Thread-3 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.647042 [debug] [Thread-1 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m01:17:41.653015 [debug] [Thread-2 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.670400 [debug] [Thread-1 (]: Writing runtime sql for node "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.673438 [debug] [Thread-2 (]: Writing runtime sql for node "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.674046 [debug] [Thread-3 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.680864 [debug] [Thread-3 (]: Writing runtime sql for node "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.683946 [debug] [Thread-2 (]: Using snowflake connection "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.685111 [debug] [Thread-1 (]: Using snowflake connection "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.686158 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_player_id.2d6184285e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from NBA.staging.stg_common_player_info
where player_id is null



      
    ) dbt_internal_test
[0m01:17:41.687968 [debug] [Thread-3 (]: Using snowflake connection "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.688603 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_full_name.26df58b172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_name
from NBA.staging.stg_common_player_info
where full_name is null



      
    ) dbt_internal_test
[0m01:17:41.690449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:41.692350 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.unique_player_id.489f92cfc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    player_id as unique_field,
    count(*) as n_records

from NBA.staging.stg_common_player_info
where player_id is not null
group by player_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:17:41.694209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:41.698251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:17:42.290059 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m01:17:42.300558 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: Close
[0m01:17:42.314663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:17:42.317222 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: Close
[0m01:17:42.324801 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m01:17:42.326965 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: Close
[0m01:17:42.483004 [info ] [Thread-2 (]: 2 of 3 PASS not_null_player_id ................................................. [[32mPASS[0m in 0.88s]
[0m01:17:42.483964 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m01:17:42.516375 [info ] [Thread-3 (]: 3 of 3 PASS unique_player_id ................................................... [[32mPASS[0m in 0.91s]
[0m01:17:42.517399 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m01:17:42.518487 [info ] [Thread-1 (]: 1 of 3 PASS not_null_full_name ................................................. [[32mPASS[0m in 0.92s]
[0m01:17:42.521323 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m01:17:42.524223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:42.524812 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m01:17:42.526691 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m01:17:42.528561 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m01:17:42.530498 [info ] [MainThread]: 
[0m01:17:42.532343 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m01:17:42.534754 [debug] [MainThread]: Command end result
[0m01:17:42.661155 [info ] [MainThread]: 
[0m01:17:42.661905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:42.663829 [info ] [MainThread]: 
[0m01:17:42.665723 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:17:42.668334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6889415, "process_user_time": 3.207024, "process_kernel_time": 0.430943, "process_mem_max_rss": "232880", "process_in_blocks": "112", "process_out_blocks": "3112"}
[0m01:17:42.669830 [debug] [MainThread]: Command `dbt test` succeeded at 01:17:42.669697 after 3.69 seconds
[0m01:17:42.671694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb795c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb796610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb797b50>]}
[0m01:17:42.673595 [debug] [MainThread]: Flushing usage events
[0m01:22:37.532309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b33110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b7bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b7bf90>]}


============================== 01:22:37.535662 | 6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0 ==============================
[0m01:22:37.535662 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:37.537840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select player_game_logs_agg_example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:38.584383 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:22:38.585199 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:22:38.587474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bb3c50>]}
[0m01:22:38.659409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d81c10>]}
[0m01:22:38.660526 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:38.796365 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:22:38.944888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:22:38.945867 [debug] [MainThread]: Partial parsing: updated file: nba://models/intermediate/player_game_logs_agg_example.sql
[0m01:22:39.255779 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:22:39.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f9f4b90>]}
[0m01:22:39.454524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fa89310>]}
[0m01:22:39.455374 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:22:39.457211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee8e350>]}
[0m01:22:39.460220 [info ] [MainThread]: 
[0m01:22:39.461743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:22:39.464130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:22:39.478883 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:22:39.479532 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:22:39.481553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.205520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.724 seconds
[0m01:22:40.207516 [debug] [ThreadPool]: On list_NBA: Close
[0m01:22:40.386973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:22:40.387893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:22:40.401234 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:22:40.398476 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:22:40.401817 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:22:40.405877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.404001 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:22:40.388714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:22:40.410166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:40.413904 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:22:40.416697 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:22:40.418571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.973958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.555 seconds
[0m01:22:40.976418 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:22:41.000360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.590 seconds
[0m01:22:41.002438 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:22:41.011372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.605 seconds
[0m01:22:41.013483 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:22:41.187634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f895810>]}
[0m01:22:41.188500 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:22:41.190285 [info ] [MainThread]: 
[0m01:22:41.194968 [debug] [Thread-1 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:22:41.195789 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.player_game_logs_agg_example .......... [RUN]
[0m01:22:41.197690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.player_game_logs_agg_example)
[0m01:22:41.199456 [debug] [Thread-1 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:22:41.211668 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:22:41.218435 [debug] [Thread-1 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:22:41.248463 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:22:41.258042 [debug] [Thread-1 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:22:41.258857 [debug] [Thread-1 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:22:41.260915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:41.903641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m01:22:41.928026 [debug] [Thread-1 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:22:42.088885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89150f90>]}
[0m01:22:42.089917 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.player_game_logs_agg_example ..... [[32mSUCCESS 1[0m in 0.89s]
[0m01:22:42.092047 [debug] [Thread-1 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:22:42.094901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:42.096225 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:22:42.098073 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:22:42.099970 [debug] [MainThread]: Connection 'list_NBA_staging' was properly closed.
[0m01:22:42.101892 [info ] [MainThread]: 
[0m01:22:42.103687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m01:22:42.105850 [debug] [MainThread]: Command end result
[0m01:22:42.155234 [info ] [MainThread]: 
[0m01:22:42.156030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:42.157816 [info ] [MainThread]: 
[0m01:22:42.159677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:22:42.162256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6920414, "process_user_time": 3.535202, "process_kernel_time": 0.3437, "process_mem_max_rss": "235044", "process_in_blocks": "1112", "process_out_blocks": "4040"}
[0m01:22:42.163728 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:42.163602 after 4.69 seconds
[0m01:22:42.165505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a57f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a57cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b0b6d0>]}
[0m01:22:42.167293 [debug] [MainThread]: Flushing usage events
[0m01:22:58.994751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9150910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9152550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9151650>]}


============================== 01:22:58.998055 | 0b65e6de-cbc0-4470-a509-550b98ec07ad ==============================
[0m01:22:58.998055 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:59.000291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_player_points_per_playoff_season_example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:00.041735 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:23:00.042577 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:23:00.044799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931c3350>]}
[0m01:23:00.118520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3b5d50>]}
[0m01:23:00.119669 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:00.254934 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:00.405374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:00.406023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:00.408246 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:23:00.455650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9188d50>]}
[0m01:23:00.576999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd2f10>]}
[0m01:23:00.577840 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:23:00.579645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9120c3d0>]}
[0m01:23:00.582586 [info ] [MainThread]: 
[0m01:23:00.584123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:00.586445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:00.603756 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:00.604409 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:00.606457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.159729 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.553 seconds
[0m01:23:01.161784 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:01.319107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:23:01.320081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:23:01.321695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:23:01.336581 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:23:01.333727 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:23:01.339203 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:23:01.341075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.337215 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:23:01.330788 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:23:01.348900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.350930 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:23:01.355023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:01.864275 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.523 seconds
[0m01:23:01.866616 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:23:01.880861 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.532 seconds
[0m01:23:01.881982 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.527 seconds
[0m01:23:01.883927 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:23:01.886782 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:23:02.099689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92553d0>]}
[0m01:23:02.100547 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:23:02.102431 [info ] [MainThread]: 
[0m01:23:02.107154 [debug] [Thread-1 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.108000 [info ] [Thread-1 (]: 1 of 1 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:23:02.109852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:23:02.111696 [debug] [Thread-1 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.121623 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.128432 [debug] [Thread-1 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.161369 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.169034 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.169756 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:23:02.171573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:03.711918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.540 seconds
[0m01:23:03.745947 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:23:03.925049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fdf2d0>]}
[0m01:23:03.926069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.81s]
[0m01:23:03.928259 [debug] [Thread-1 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:03.931500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:03.932029 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:23:03.934453 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:23:03.952009 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m01:23:03.954718 [info ] [MainThread]: 
[0m01:23:03.957181 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m01:23:03.960002 [debug] [MainThread]: Command end result
[0m01:23:04.010175 [info ] [MainThread]: 
[0m01:23:04.011650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:04.014220 [info ] [MainThread]: 
[0m01:23:04.016768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:23:04.019948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.085011, "process_user_time": 3.100673, "process_kernel_time": 0.38883, "process_mem_max_rss": "231340", "process_in_blocks": "1112", "process_out_blocks": "2912"}
[0m01:23:04.022827 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:04.022654 after 5.09 seconds
[0m01:23:04.025410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa919c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb7a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91368d0>]}
[0m01:23:04.027985 [debug] [MainThread]: Flushing usage events
[0m01:23:10.397575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0853ad0>]}


============================== 01:23:10.400963 | e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed ==============================
[0m01:23:10.400963 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:23:10.403105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:11.462772 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:23:11.463616 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:23:11.465894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a81b9d0>]}
[0m01:23:11.537980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a05c10>]}
[0m01:23:11.539073 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:11.676341 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:11.822011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:11.822684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:11.824802 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:23:11.872951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883c4d0>]}
[0m01:23:12.004481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887d3590>]}
[0m01:23:12.005784 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:23:12.007551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885d8bd0>]}
[0m01:23:12.011557 [info ] [MainThread]: 
[0m01:23:12.013247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:12.020984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.021876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.022686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.039556 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.042312 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.045597 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.046258 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.048201 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.050052 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.051857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.053706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.055547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.583456 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.528 seconds
[0m01:23:12.585444 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.625208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.573 seconds
[0m01:23:12.627178 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.629574 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.576 seconds
[0m01:23:12.631806 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.835454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:23:12.846852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:23:12.847842 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:23:12.848704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m01:23:12.851506 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:23:12.852123 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:23:12.856062 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:23:12.856691 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:23:12.858519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:12.860388 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:23:12.862322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:12.866395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:13.275238 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.417 seconds
[0m01:23:13.277531 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:23:13.333846 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.467 seconds
[0m01:23:13.336089 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:23:13.398220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.536 seconds
[0m01:23:13.400657 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:23:13.563205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07dd950>]}
[0m01:23:13.564096 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:23:13.565865 [info ] [MainThread]: 
[0m01:23:13.571131 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:23:13.571787 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:23:13.576990 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m01:23:13.572992 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:23:13.573794 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:23:13.583702 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m01:23:13.575237 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m01:23:13.572382 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:23:13.579461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:23:13.581433 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m01:23:13.574442 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:23:13.586047 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:23:13.588029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m01:23:13.590357 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m01:23:13.604409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_player_game_logs)
[0m01:23:13.606201 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:23:13.598160 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m01:23:13.599853 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:23:13.602408 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:23:13.624795 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:23:13.595433 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:23:13.627480 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:23:13.616669 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:23:13.621313 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:23:13.593049 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:23:13.615787 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:23:13.632217 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:23:13.632841 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:23:13.633435 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:23:13.640069 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:23:13.640905 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:23:13.649645 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:23:13.674292 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:23:13.685030 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:23:13.687128 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:23:13.691544 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m01:23:13.695295 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m01:23:13.695981 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:23:13.717555 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m01:23:13.707964 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:23:13.721036 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.713970 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m01:23:13.726504 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.720166 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m01:23:13.708846 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m01:23:13.723861 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m01:23:13.724531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:13.706039 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:23:13.728290 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:23:13.730206 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:23:13.733918 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.738279 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m01:23:13.742527 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m01:23:13.745526 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:23:13.747451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:23:13.749355 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:23:13.757476 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m01:23:13.760380 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.758417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:23:13.762184 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:23:14.347437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m01:23:14.445402 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m01:23:14.451705 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m01:23:14.452413 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:23:14.454603 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m01:23:14.455555 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m01:23:14.457605 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m01:23:14.465055 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m01:23:14.467407 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m01:23:14.472858 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m01:23:14.527868 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m01:23:14.530187 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m01:23:14.623708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883933d0>]}
[0m01:23:14.624713 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.03s]
[0m01:23:14.627055 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:23:14.629853 [debug] [Thread-8 (]: Began running node model.nba.fct_players_by_college_example
[0m01:23:14.631047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864bf710>]}
[0m01:23:14.632377 [info ] [Thread-8 (]: 7 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m01:23:14.636641 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_players_by_college_example'
[0m01:23:14.634863 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.03s]
[0m01:23:14.633899 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8641f890>]}
[0m01:23:14.637621 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b4a50>]}
[0m01:23:14.638317 [debug] [Thread-8 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:23:14.640375 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:23:14.642304 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.02s]
[0m01:23:14.651529 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:23:14.648736 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:23:14.649818 [debug] [Thread-1 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.650387 [debug] [Thread-7 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:23:14.644161 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.06s]
[0m01:23:14.657130 [info ] [Thread-1 (]: 8 of 12 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m01:23:14.664026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now model.nba.fct_playoff_games_by_player_example)
[0m01:23:14.660550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26fc410>]}
[0m01:23:14.659593 [info ] [Thread-7 (]: 9 of 12 START sql view model intermediate.player_game_logs_agg_example ......... [RUN]
[0m01:23:14.669692 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.player_game_logs_agg_example'
[0m01:23:14.658539 [debug] [Thread-8 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:23:14.665790 [debug] [Thread-1 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.700027 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.662222 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:23:14.671366 [debug] [Thread-7 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:23:14.711087 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:23:14.667918 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.07s]
[0m01:23:14.714118 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:23:14.696170 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m01:23:14.704787 [debug] [Thread-1 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.716804 [debug] [Thread-7 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:23:14.727822 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:23:14.723999 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m01:23:14.722854 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.729716 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a948150>]}
[0m01:23:14.730799 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m01:23:14.738960 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:23:14.737452 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.14s]
[0m01:23:14.736315 [debug] [Thread-7 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:23:14.746595 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:23:14.744885 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:23:14.741783 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.748344 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:23:14.750533 [debug] [Thread-3 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.752029 [debug] [Thread-1 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m01:23:14.756182 [info ] [Thread-3 (]: 10 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m01:23:14.757676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:14.759587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_playoff_appearances_by_team_example)
[0m01:23:14.763643 [debug] [Thread-3 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.768864 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.773653 [debug] [Thread-3 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.776904 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.783304 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.784045 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m01:23:14.785845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:23:15.439493 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m01:23:15.441983 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:23:15.633211 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a7490>]}
[0m01:23:15.634175 [info ] [Thread-7 (]: 9 of 12 OK created sql view model intermediate.player_game_logs_agg_example .... [[32mSUCCESS 1[0m in 0.96s]
[0m01:23:15.637244 [debug] [Thread-7 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:23:15.640125 [debug] [Thread-2 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.640855 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.642212 [info ] [Thread-2 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:23:15.647701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:23:15.645104 [info ] [Thread-4 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m01:23:15.650328 [debug] [Thread-2 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.658359 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.652420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_regular_season_example)
[0m01:23:15.663168 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.668528 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.669116 [debug] [Thread-2 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.675048 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.676328 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.680507 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.684226 [debug] [Thread-2 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.685069 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:23:15.686516 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.689362 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m01:23:15.687229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:23:15.691428 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:23:15.947165 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.208 seconds
[0m01:23:15.949433 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: Close
[0m01:23:16.086644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m01:23:16.088919 [debug] [Thread-1 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m01:23:16.153075 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8833fed0>]}
[0m01:23:16.154455 [info ] [Thread-8 (]: 7 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 1.52s]
[0m01:23:16.157726 [debug] [Thread-8 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:23:16.184863 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.399 seconds
[0m01:23:16.187410 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m01:23:16.255633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa153d4d0>]}
[0m01:23:16.256593 [info ] [Thread-1 (]: 8 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.59s]
[0m01:23:16.259724 [debug] [Thread-1 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:23:16.357466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1567710>]}
[0m01:23:16.358463 [info ] [Thread-3 (]: 10 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.60s]
[0m01:23:16.360804 [debug] [Thread-3 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:16.879711 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.192 seconds
[0m01:23:16.882357 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:23:17.051381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a7310>]}
[0m01:23:17.052389 [info ] [Thread-2 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.40s]
[0m01:23:17.055640 [debug] [Thread-2 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:17.066480 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m01:23:17.068715 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m01:23:17.238064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b6610>]}
[0m01:23:17.239019 [info ] [Thread-4 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.59s]
[0m01:23:17.241086 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:23:17.244364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:17.245633 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:23:17.247473 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:23:17.249309 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:23:17.251194 [debug] [MainThread]: Connection 'model.nba.stg_team_stats_by_season' was properly closed.
[0m01:23:17.253577 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:23:17.255495 [debug] [MainThread]: Connection 'model.nba.stg_teams' was properly closed.
[0m01:23:17.257540 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:23:17.260083 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:23:17.262650 [info ] [MainThread]: 
[0m01:23:17.265137 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m01:23:17.269103 [debug] [MainThread]: Command end result
[0m01:23:17.321028 [info ] [MainThread]: 
[0m01:23:17.321814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:17.323785 [info ] [MainThread]: 
[0m01:23:17.326078 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:23:17.328612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.990214, "process_user_time": 3.833849, "process_kernel_time": 0.444224, "process_mem_max_rss": "238392", "process_out_blocks": "4696", "process_in_blocks": "0"}
[0m01:23:17.330189 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:17.330035 after 6.99 seconds
[0m01:23:17.332182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c8fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15aefd0>]}
[0m01:23:17.334078 [debug] [MainThread]: Flushing usage events
[0m01:25:16.855527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fe9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8011610>]}


============================== 01:25:16.858930 | e77697ba-4586-419e-a8fb-a358d36099d5 ==============================
[0m01:25:16.858930 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:16.861091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls --select exposure:*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:25:17.931101 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:25:17.931923 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:25:17.934131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0077e50>]}
[0m01:25:18.008211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9281d10>]}
[0m01:25:18.009370 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:18.147890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:18.313644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:18.314288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:18.316511 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:25:18.369525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd87050>]}
[0m01:25:18.517479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e1d150>]}
[0m01:25:18.518332 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:25:18.520108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0011090>]}
[0m01:25:18.523133 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.7292532, "process_user_time": 2.758059, "process_kernel_time": 0.429697, "process_mem_max_rss": "221756", "process_in_blocks": "1144", "process_out_blocks": "1344"}
[0m01:25:18.524632 [debug] [MainThread]: Command `dbt ls` succeeded at 01:25:18.524504 after 1.73 seconds
[0m01:25:18.526354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa4a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa4ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fce850>]}
[0m01:25:18.528187 [debug] [MainThread]: Flushing usage events
[0m01:25:36.024246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0442790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb048bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb046a6d0>]}


============================== 01:25:36.027603 | 4b5a853c-70a3-411f-9164-8f3d4eac4aac ==============================
[0m01:25:36.027603 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:36.029664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m01:25:37.056800 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:25:37.057618 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:25:37.059755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986c2790>]}
[0m01:25:37.131836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16d9d90>]}
[0m01:25:37.132972 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:37.270043 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:37.421955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:37.422588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:37.424888 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:25:37.477083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9845e990>]}
[0m01:25:37.501108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98107e50>]}
[0m01:25:37.501928 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:25:37.503728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982d3290>]}
[0m01:25:37.507481 [info ] [MainThread]: 
[0m01:25:37.508355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:37.515033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:25:37.516021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:25:37.516820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:25:37.539333 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:25:37.541947 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:25:37.544484 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:25:37.545122 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:25:37.547007 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:25:37.548847 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:25:37.550747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:37.552570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:37.554347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:38.094250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m01:25:38.096475 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:25:38.100990 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m01:25:38.103201 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:25:38.169583 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m01:25:38.171881 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:25:38.355273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985282d0>]}
[0m01:25:38.356127 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:25:38.357983 [info ] [MainThread]: 
[0m01:25:38.362676 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:25:38.363274 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:25:38.363850 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:25:38.365702 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:25:38.366272 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:25:38.366944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m01:25:38.367940 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:25:38.368628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:25:38.370664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_player_game_logs)
[0m01:25:38.372699 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:25:38.374588 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:25:38.376294 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:25:38.378249 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:25:38.379991 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:25:38.381788 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:25:38.383610 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:25:38.385467 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:25:38.394575 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:25:38.395262 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:25:38.400174 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:25:38.403634 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:25:38.407114 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:25:38.410472 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:25:38.415838 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:25:38.418476 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:25:38.420994 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:25:38.423728 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:25:38.426152 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:25:38.434068 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:25:38.428541 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:25:38.429113 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:25:38.430424 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:25:38.432268 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:25:38.427779 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:25:38.435848 [debug] [Thread-8 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.437675 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:25:38.439477 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:25:38.443113 [debug] [Thread-5 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:25:38.444937 [debug] [Thread-2 (]: Began running node model.nba.fct_players_by_college_example
[0m01:25:38.445481 [debug] [Thread-3 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.446051 [debug] [Thread-7 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m01:25:38.446613 [debug] [Thread-1 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.447379 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_appearances_by_team_example'
[0m01:25:38.449066 [debug] [Thread-6 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.452800 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.player_game_logs_agg_example)
[0m01:25:38.454617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_players_by_college_example)
[0m01:25:38.467477 [debug] [Thread-2 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:25:38.458678 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.nba.not_null_full_name.26df58b172'
[0m01:25:38.472815 [debug] [Thread-7 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m01:25:38.461961 [debug] [Thread-8 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.463834 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now test.nba.unique_player_id.489f92cfc7)
[0m01:25:38.465604 [debug] [Thread-5 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:25:38.456504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_playoff_games_by_player_example)
[0m01:25:38.472136 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:25:38.460131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now test.nba.not_null_player_id.2d6184285e)
[0m01:25:38.503008 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.490848 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:25:38.491606 [debug] [Thread-6 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.498455 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:25:38.499188 [debug] [Thread-3 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.487102 [debug] [Thread-7 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m01:25:38.510643 [debug] [Thread-2 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:25:38.511394 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m01:25:38.523058 [debug] [Thread-6 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m01:25:38.525814 [debug] [Thread-8 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.529752 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:25:38.530379 [debug] [Thread-5 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:25:38.544385 [debug] [Thread-5 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:25:38.535871 [debug] [Thread-7 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m01:25:38.538580 [debug] [Thread-1 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.539684 [debug] [Thread-8 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.541133 [debug] [Thread-6 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.533432 [debug] [Thread-2 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:25:38.546105 [debug] [Thread-3 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.547223 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.547825 [debug] [Thread-5 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.549081 [debug] [Thread-7 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m01:25:38.550952 [debug] [Thread-1 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.554571 [debug] [Thread-6 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.558252 [debug] [Thread-3 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.559770 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:25:38.561598 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.player_game_logs_agg_example, now model.nba.fct_player_points_per_regular_season_example)
[0m01:25:38.570877 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.572611 [debug] [Thread-5 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.577466 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:25:38.581318 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:25:38.586866 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.587921 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.588429 [debug] [Thread-5 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.591616 [debug] [Thread-5 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.599806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:38.600428 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m01:25:38.602421 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:25:38.604248 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:25:38.606166 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:25:38.607998 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m01:25:38.609838 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:25:38.611696 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:25:38.613522 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m01:25:38.617057 [debug] [MainThread]: Command end result
[0m01:25:38.754641 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:25:38.755243 [info ] [MainThread]: Building catalog
[0m01:25:38.769008 [debug] [ThreadPool]: Acquiring new snowflake connection 'NBA.information_schema'
[0m01:25:38.863234 [debug] [ThreadPool]: Using snowflake connection "NBA.information_schema"
[0m01:25:38.864301 [debug] [ThreadPool]: On NBA.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "NBA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from NBA.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from NBA.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m01:25:38.865979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:45.483820 [debug] [ThreadPool]: SQL status: SUCCESS 340 in 6.618 seconds
[0m01:25:46.384288 [debug] [ThreadPool]: On NBA.information_schema: Close
[0m01:25:46.669162 [info ] [MainThread]: Catalog written to /workspaces/fxtn7c3oiwkalwzz/repository/nba/target/catalog.json
[0m01:25:46.671376 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.706602, "process_user_time": 3.723911, "process_kernel_time": 0.401499, "process_mem_max_rss": "239032", "process_in_blocks": "3056", "process_out_blocks": "8944"}
[0m01:25:46.672320 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:25:46.672193 after 10.71 seconds
[0m01:25:46.673886 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:25:46.675650 [debug] [MainThread]: Connection 'NBA.information_schema' was properly closed.
[0m01:25:46.677566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0929390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2eacbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ea21d0>]}
[0m01:25:46.679542 [debug] [MainThread]: Flushing usage events
[0m01:26:32.023992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e282e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e21b950>]}


============================== 01:26:32.027598 | f3b9192c-19d1-48ca-bd70-232da83e312c ==============================
[0m01:26:32.027598 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:26:32.030079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:33.068776 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:26:33.069602 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:26:33.071812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b9192c-19d1-48ca-bd70-232da83e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7689d290>]}
[0m01:26:33.144303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b9192c-19d1-48ca-bd70-232da83e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f499b10>]}
[0m01:26:33.167653 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m01:26:33.172073 [error] [MainThread]: Traceback (most recent call last):
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m01:26:33.173453 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.2146667, "process_user_time": 2.520541, "process_kernel_time": 0.191561, "process_mem_max_rss": "212596", "process_in_blocks": "72", "process_out_blocks": "3032", "command_success": false}
[0m01:26:33.175189 [debug] [MainThread]: Command `dbt docs serve` failed at 01:26:33.175037 after 1.22 seconds
[0m01:26:33.176899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e264c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e228a50>]}
[0m01:26:33.178771 [debug] [MainThread]: Flushing usage events
[0m01:27:17.393965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de97110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de978d0>]}


============================== 01:27:17.397247 | 967686e0-e51a-4b8d-8354-0e9f869e49cd ==============================
[0m01:27:17.397247 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:27:17.399291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:27:18.450841 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:27:18.451691 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:27:18.453924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967686e0-e51a-4b8d-8354-0e9f869e49cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ff8410>]}
[0m01:27:18.526625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967686e0-e51a-4b8d-8354-0e9f869e49cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e20fe10>]}
[0m01:27:32.947256 [error] [MainThread]: Encountered an error:

[0m01:27:32.950752 [error] [MainThread]: Traceback (most recent call last):
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pyenv/versions/3.11.8/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m01:27:32.952220 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 15.621014, "process_user_time": 2.594236, "process_kernel_time": 0.180687, "process_mem_max_rss": "212332", "process_in_blocks": "40", "process_out_blocks": "3032", "command_success": false}
[0m01:27:32.953946 [debug] [MainThread]: Command `dbt docs serve` failed at 01:27:32.953810 after 15.62 seconds
[0m01:27:32.955642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4f450>]}
[0m01:27:32.957458 [debug] [MainThread]: Flushing usage events
[0m01:28:02.669009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f32250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f7ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f7bb10>]}


============================== 01:28:02.672387 | 30b6fa2b-f359-4844-b519-a136ca768101 ==============================
[0m01:28:02.672387 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:28:02.674673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:03.708907 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:28:03.709735 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:28:03.712089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af7fb90>]}
[0m01:28:03.785086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12f7e10>]}
[0m01:28:03.786212 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:28:03.924890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:28:04.083969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:04.084603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:04.086709 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:28:04.138643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5ff10>]}
[0m01:28:04.270396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c90310>]}
[0m01:28:04.271288 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:28:04.273047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c046d0>]}
[0m01:28:04.276681 [info ] [MainThread]: 
[0m01:28:04.277498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:04.284213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.285050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.293080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.301783 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.307689 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.306996 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.304560 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.310483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:04.312357 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.314226 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.319476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:04.320865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:05.016153 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.706 seconds
[0m01:28:05.018172 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.024527 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.705 seconds
[0m01:28:05.026331 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.258677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.938 seconds
[0m01:28:05.260621 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.755258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m01:28:05.765738 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:28:05.766477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:28:05.772173 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:28:05.767965 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:28:05.772769 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:28:05.767342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:28:05.774699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:05.776549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:05.780576 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:28:05.785865 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:28:05.787690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:06.359535 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.583 seconds
[0m01:28:06.361669 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:28:06.880626 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.093 seconds
[0m01:28:06.882922 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:28:06.959866 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.185 seconds
[0m01:28:06.962071 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:28:07.214557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f6fcd0>]}
[0m01:28:07.215427 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:28:07.217262 [info ] [MainThread]: 
[0m01:28:07.221818 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:28:07.222394 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:28:07.222950 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:28:07.223527 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:28:07.225374 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:28:07.232482 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m01:28:07.224981 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m01:28:07.226829 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m01:28:07.228664 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m01:28:07.230555 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m01:28:07.225893 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:28:07.234358 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:28:07.236099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_common_player_info)
[0m01:28:07.237994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:28:07.239812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_player_game_logs)
[0m01:28:07.241723 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:28:07.243596 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m01:28:07.245257 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:28:07.247110 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:28:07.248961 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:28:07.250835 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:28:07.252641 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:28:07.254704 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:28:07.263741 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:28:07.267303 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:28:07.272380 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:28:07.275706 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:28:07.278965 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:28:07.279710 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:28:07.285509 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:28:07.287306 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:28:07.289039 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:28:07.294543 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:28:07.295153 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:28:07.303407 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:28:07.329152 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m01:28:07.332522 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:28:07.335885 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m01:28:07.340942 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m01:28:07.345485 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m01:28:07.346098 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:28:07.351933 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m01:28:07.354500 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:28:07.356185 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m01:28:07.360007 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m01:28:07.438433 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m01:28:07.439773 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m01:28:07.440466 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.442576 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.444438 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.446308 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:28:07.448107 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:28:07.451801 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:28:07.453555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.454698 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m01:28:07.455945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:28:07.457878 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:28:07.459764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:28:07.465974 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.474068 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:28:08.085444 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m01:28:08.109878 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m01:28:08.121554 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m01:28:08.123812 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m01:28:08.132220 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m01:28:08.134348 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m01:28:08.145251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m01:28:08.147936 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:28:08.169967 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m01:28:08.172242 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m01:28:08.275332 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2610810>]}
[0m01:28:08.276359 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.04s]
[0m01:28:08.278331 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:28:08.280356 [debug] [Thread-8 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.282242 [info ] [Thread-8 (]: 7 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m01:28:08.284107 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_appearances_by_team_example'
[0m01:28:08.285764 [debug] [Thread-8 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.291112 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.293265 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m01:28:08.294873 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98acbd50>]}
[0m01:28:08.297413 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m01:28:08.297975 [debug] [Thread-8 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.298835 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.04s]
[0m01:28:08.325759 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.327189 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:28:08.329056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b4b650>]}
[0m01:28:08.334103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b5c5d0>]}
[0m01:28:08.335041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fcc9d0>]}
[0m01:28:08.337181 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.338077 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.09s]
[0m01:28:08.339928 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.10s]
[0m01:28:08.341782 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.10s]
[0m01:28:08.343441 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m01:28:08.345336 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:28:08.347188 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:28:08.348985 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:28:08.350639 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:28:08.354587 [debug] [Thread-5 (]: Began running node model.nba.fct_players_by_college_example
[0m01:28:08.356333 [debug] [Thread-6 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.356877 [debug] [Thread-4 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:28:08.360282 [info ] [Thread-5 (]: 8 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m01:28:08.361861 [info ] [Thread-6 (]: 9 of 12 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m01:28:08.363737 [info ] [Thread-4 (]: 10 of 12 START sql view model intermediate.player_game_logs_agg_example ........ [RUN]
[0m01:28:08.365540 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.fct_players_by_college_example)
[0m01:28:08.367288 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_playoff_games_by_player_example)
[0m01:28:08.369096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.player_game_logs_agg_example)
[0m01:28:08.370919 [debug] [Thread-5 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:28:08.372712 [debug] [Thread-6 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.374537 [debug] [Thread-4 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:28:08.379461 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:28:08.383319 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.388783 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:28:08.393376 [debug] [Thread-5 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:28:08.399644 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m01:28:08.400391 [debug] [Thread-6 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.402535 [debug] [Thread-4 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:28:08.407545 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.410920 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:28:08.412813 [debug] [Thread-5 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m01:28:08.418787 [debug] [Thread-6 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.419427 [debug] [Thread-5 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m01:28:08.420128 [debug] [Thread-6 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m01:28:08.424460 [debug] [Thread-4 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:28:08.425102 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:28:08.427069 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:28:08.429018 [debug] [Thread-4 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:28:08.434955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:28:08.491776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b7b710>]}
[0m01:28:08.492758 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.25s]
[0m01:28:08.494664 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:28:09.192453 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m01:28:09.194783 [debug] [Thread-4 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:28:09.398140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0f38d0>]}
[0m01:28:09.399143 [info ] [Thread-4 (]: 10 of 12 OK created sql view model intermediate.player_game_logs_agg_example ... [[32mSUCCESS 1[0m in 1.03s]
[0m01:28:09.401285 [debug] [Thread-4 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:28:09.403285 [debug] [Thread-7 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.403927 [debug] [Thread-3 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.405018 [info ] [Thread-7 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:28:09.406976 [info ] [Thread-3 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m01:28:09.408888 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.fct_player_points_per_playoff_season_example'
[0m01:28:09.410652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_player_points_per_regular_season_example)
[0m01:28:09.412519 [debug] [Thread-7 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.414388 [debug] [Thread-3 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.419731 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.423168 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.427715 [debug] [Thread-7 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.430916 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.431516 [debug] [Thread-3 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.436302 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.439728 [debug] [Thread-7 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.441126 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:28:09.443123 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.443740 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:28:09.445652 [debug] [Thread-3 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m01:28:09.449538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:28:09.708801 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.284 seconds
[0m01:28:09.711139 [debug] [Thread-5 (]: On model.nba.fct_players_by_college_example: Close
[0m01:28:09.787057 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.436 seconds
[0m01:28:09.790213 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m01:28:09.797826 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.371 seconds
[0m01:28:09.799863 [debug] [Thread-6 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m01:28:09.901460 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c93310>]}
[0m01:28:09.902487 [info ] [Thread-5 (]: 8 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 1.54s]
[0m01:28:09.904584 [debug] [Thread-5 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:28:09.957403 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b62290>]}
[0m01:28:09.958466 [info ] [Thread-8 (]: 7 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.67s]
[0m01:28:09.960376 [debug] [Thread-8 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:09.968924 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2188610>]}
[0m01:28:09.969864 [info ] [Thread-6 (]: 9 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.60s]
[0m01:28:09.971701 [debug] [Thread-6 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:28:10.698445 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.249 seconds
[0m01:28:10.700629 [debug] [Thread-3 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m01:28:10.714324 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m01:28:10.716508 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:28:10.882012 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b0e810>]}
[0m01:28:10.883010 [info ] [Thread-3 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.47s]
[0m01:28:10.885059 [debug] [Thread-3 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:28:10.929025 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d51910>]}
[0m01:28:10.930047 [info ] [Thread-7 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.52s]
[0m01:28:10.932097 [debug] [Thread-7 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:10.937533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:10.938119 [debug] [MainThread]: Connection 'model.nba.stg_games' was properly closed.
[0m01:28:10.940446 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:28:10.942826 [debug] [MainThread]: Connection 'model.nba.stg_common_player_info' was properly closed.
[0m01:28:10.944968 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:28:10.947314 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:28:10.949194 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:28:10.950961 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:28:10.952800 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:28:10.954831 [info ] [MainThread]: 
[0m01:28:10.956523 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m01:28:10.959963 [debug] [MainThread]: Command end result
[0m01:28:11.011413 [info ] [MainThread]: 
[0m01:28:11.012169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:11.014060 [info ] [MainThread]: 
[0m01:28:11.015949 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:28:11.018512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.409383, "process_user_time": 3.972234, "process_kernel_time": 0.4092, "process_mem_max_rss": "243340", "process_out_blocks": "9168", "process_in_blocks": "0"}
[0m01:28:11.020015 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:11.019864 after 8.41 seconds
[0m01:28:11.021787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3992250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a7e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f0b5d0>]}
[0m01:28:11.023594 [debug] [MainThread]: Flushing usage events
[0m17:38:02.527875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9424c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94296990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94284750>]}


============================== 17:38:02.531153 | c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646 ==============================
[0m17:38:02.531153 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:38:02.533928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:03.593335 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:38:03.594143 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:38:03.596631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e29fed0>]}
[0m17:38:03.669960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954b1a90>]}
[0m17:38:03.671163 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:03.818550 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:38:03.985369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:03.986007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:03.988447 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:38:04.041219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfb2c10>]}
[0m17:38:04.178240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3e4f90>]}
[0m17:38:04.179062 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:38:04.180954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c180690>]}
[0m17:38:04.184720 [info ] [MainThread]: 
[0m17:38:04.185615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:04.201058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:38:04.201964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:38:04.202781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:38:04.219208 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:38:04.225067 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:38:04.224443 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:38:04.229520 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:38:04.231866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:04.221899 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:38:04.237267 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:38:04.227563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:04.238702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:04.913591 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.682 seconds
[0m17:38:04.916050 [debug] [ThreadPool]: On list_NBA: Close
[0m17:38:04.917627 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.679 seconds
[0m17:38:04.923176 [debug] [ThreadPool]: On list_NBA: Close
[0m17:38:05.061738 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.834 seconds
[0m17:38:05.063957 [debug] [ThreadPool]: On list_NBA: Close
[0m17:38:05.234869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m17:38:05.237971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m17:38:05.244042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m17:38:05.248173 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:38:05.251784 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:38:05.255174 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:38:05.258410 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:38:05.260364 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:38:05.266917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:05.264984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:05.262355 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:38:05.275407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:05.821958 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.555 seconds
[0m17:38:05.824190 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:38:05.838287 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.563 seconds
[0m17:38:05.840249 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:38:05.959084 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.694 seconds
[0m17:38:05.962561 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:38:06.163830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0eaf10>]}
[0m17:38:06.164662 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:38:06.166577 [info ] [MainThread]: 
[0m17:38:06.171308 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m17:38:06.171940 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m17:38:06.176836 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m17:38:06.178718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_games)
[0m17:38:06.174075 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m17:38:06.174698 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m17:38:06.175425 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m17:38:06.172750 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m17:38:06.173292 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m17:38:06.190112 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m17:38:06.192077 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m17:38:06.184351 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m17:38:06.195801 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m17:38:06.197563 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m17:38:06.206512 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m17:38:06.180502 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m17:38:06.193790 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m17:38:06.186223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_common_player_info)
[0m17:38:06.188179 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m17:38:06.182537 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m17:38:06.222913 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m17:38:06.224643 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m17:38:06.218338 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m17:38:06.218950 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m17:38:06.220942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_player_game_logs)
[0m17:38:06.213526 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m17:38:06.216967 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m17:38:06.229387 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m17:38:06.263762 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m17:38:06.265796 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m17:38:06.266586 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m17:38:06.283909 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m17:38:06.275041 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m17:38:06.277592 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m17:38:06.280166 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m17:38:06.272531 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m17:38:06.301597 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m17:38:06.290231 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m17:38:06.293600 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m17:38:06.296979 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m17:38:06.289066 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m17:38:06.302223 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m17:38:06.304812 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:38:06.309043 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m17:38:06.313006 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m17:38:06.314782 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m17:38:06.397237 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m17:38:06.397958 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:38:06.399263 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m17:38:06.413453 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:38:06.415378 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:06.404673 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:38:06.412657 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m17:38:06.400622 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:38:06.402573 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:38:06.426536 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:38:06.422828 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:38:06.424705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:06.420532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:06.430874 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:07.097536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m17:38:07.121814 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m17:38:07.125864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m17:38:07.127164 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m17:38:07.129192 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m17:38:07.131253 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m17:38:07.164965 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m17:38:07.167708 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m17:38:07.174626 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m17:38:07.176806 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m17:38:07.209015 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m17:38:07.211414 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m17:38:07.288452 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2951d0>]}
[0m17:38:07.290807 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.07s]
[0m17:38:07.292634 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m17:38:07.294862 [debug] [Thread-8 (]: Began running node model.nba.player_game_logs_agg_example
[0m17:38:07.296592 [info ] [Thread-8 (]: 7 of 12 START sql view model intermediate.player_game_logs_agg_example ......... [RUN]
[0m17:38:07.298478 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.player_game_logs_agg_example'
[0m17:38:07.300176 [debug] [Thread-8 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m17:38:07.307308 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m17:38:07.309704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e373810>]}
[0m17:38:07.311352 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.12s]
[0m17:38:07.312483 [debug] [Thread-8 (]: Began executing node model.nba.player_game_logs_agg_example
[0m17:38:07.314116 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m17:38:07.318487 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m17:38:07.319528 [debug] [Thread-3 (]: Began running node model.nba.fct_players_by_college_example
[0m17:38:07.320098 [debug] [Thread-7 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m17:38:07.323070 [info ] [Thread-3 (]: 8 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m17:38:07.324896 [info ] [Thread-7 (]: 9 of 12 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m17:38:07.328300 [debug] [Thread-8 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m17:38:07.329087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_players_by_college_example)
[0m17:38:07.331082 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_games_by_player_example'
[0m17:38:07.333242 [debug] [Thread-8 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m17:38:07.334806 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c195990>]}
[0m17:38:07.335496 [debug] [Thread-3 (]: Began compiling node model.nba.fct_players_by_college_example
[0m17:38:07.337884 [debug] [Thread-7 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m17:38:07.339711 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:38:07.342002 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.14s]
[0m17:38:07.346766 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m17:38:07.352350 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m17:38:07.353938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95472190>]}
[0m17:38:07.356626 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m17:38:07.362884 [debug] [Thread-3 (]: Began executing node model.nba.fct_players_by_college_example
[0m17:38:07.362385 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.16s]
[0m17:38:07.365653 [debug] [Thread-7 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m17:38:07.389672 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m17:38:07.390523 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m17:38:07.394240 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m17:38:07.395158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79f36c10>]}
[0m17:38:07.402561 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.22s]
[0m17:38:07.400385 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m17:38:07.396692 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15e350>]}
[0m17:38:07.405010 [debug] [Thread-7 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m17:38:07.405903 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m17:38:07.407656 [debug] [Thread-3 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m17:38:07.409685 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.17s]
[0m17:38:07.411347 [debug] [Thread-7 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m17:38:07.415114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:07.417118 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m17:38:07.418841 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:38:07.423713 [debug] [Thread-1 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m17:38:07.427656 [info ] [Thread-1 (]: 10 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m17:38:07.429279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now model.nba.fct_playoff_appearances_by_team_example)
[0m17:38:07.431085 [debug] [Thread-1 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m17:38:07.436111 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:38:07.440716 [debug] [Thread-1 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m17:38:07.443745 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:38:07.449745 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m17:38:07.450463 [debug] [Thread-1 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m17:38:07.452350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:08.144443 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m17:38:08.146729 [debug] [Thread-8 (]: On model.nba.player_game_logs_agg_example: Close
[0m17:38:08.669802 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e429410>]}
[0m17:38:08.670845 [info ] [Thread-8 (]: 7 of 12 OK created sql view model intermediate.player_game_logs_agg_example .... [[32mSUCCESS 1[0m in 1.37s]
[0m17:38:08.672797 [debug] [Thread-8 (]: Finished running node model.nba.player_game_logs_agg_example
[0m17:38:08.674942 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m17:38:08.675522 [debug] [Thread-2 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m17:38:08.676592 [info ] [Thread-4 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m17:38:08.678455 [info ] [Thread-2 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m17:38:08.680358 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_playoff_season_example)
[0m17:38:08.682216 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_player_points_per_regular_season_example)
[0m17:38:08.684017 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m17:38:08.685922 [debug] [Thread-2 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m17:38:08.691156 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:38:08.694566 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:38:08.699049 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m17:38:08.703513 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:38:08.704150 [debug] [Thread-2 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m17:38:08.709120 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:38:08.712615 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m17:38:08.714116 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m17:38:08.715954 [debug] [Thread-2 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m17:38:08.716653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:08.719115 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m17:38:08.723062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:08.778943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.327 seconds
[0m17:38:08.781216 [debug] [Thread-1 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m17:38:08.783796 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.365 seconds
[0m17:38:08.785838 [debug] [Thread-7 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m17:38:08.955503 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d97790>]}
[0m17:38:08.956479 [info ] [Thread-7 (]: 9 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.62s]
[0m17:38:08.958538 [debug] [Thread-7 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m17:38:08.960969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d97790>]}
[0m17:38:08.962576 [info ] [Thread-1 (]: 10 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.53s]
[0m17:38:08.964493 [debug] [Thread-1 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m17:38:09.185967 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.771 seconds
[0m17:38:09.188153 [debug] [Thread-3 (]: On model.nba.fct_players_by_college_example: Close
[0m17:38:09.360129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9463b6d0>]}
[0m17:38:09.361147 [info ] [Thread-3 (]: 8 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 2.03s]
[0m17:38:09.363212 [debug] [Thread-3 (]: Finished running node model.nba.fct_players_by_college_example
[0m17:38:10.021716 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.305 seconds
[0m17:38:10.023884 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m17:38:10.128545 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.405 seconds
[0m17:38:10.130746 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m17:38:10.205437 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79e0b1d0>]}
[0m17:38:10.206419 [info ] [Thread-4 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.52s]
[0m17:38:10.208519 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m17:38:10.318591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1b2f0e5-fb8c-49f2-a1e2-8441ffa72646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9580c050>]}
[0m17:38:10.319579 [info ] [Thread-2 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.64s]
[0m17:38:10.321582 [debug] [Thread-2 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m17:38:10.324697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:10.325224 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m17:38:10.327079 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m17:38:10.328947 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m17:38:10.330804 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m17:38:10.332599 [debug] [MainThread]: Connection 'model.nba.stg_teams' was properly closed.
[0m17:38:10.334453 [debug] [MainThread]: Connection 'model.nba.stg_team_stats_by_season' was properly closed.
[0m17:38:10.336250 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m17:38:10.338190 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m17:38:10.340334 [info ] [MainThread]: 
[0m17:38:10.341962 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m17:38:10.345402 [debug] [MainThread]: Command end result
[0m17:38:10.396811 [info ] [MainThread]: 
[0m17:38:10.397570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:10.399506 [info ] [MainThread]: 
[0m17:38:10.401452 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:38:10.404066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9375997, "process_user_time": 3.850621, "process_kernel_time": 0.458175, "process_mem_max_rss": "239724", "process_in_blocks": "1120", "process_out_blocks": "4704"}
[0m17:38:10.405583 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:10.405437 after 7.94 seconds
[0m17:38:10.407309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9429f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1940d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e39a610>]}
[0m17:38:10.409115 [debug] [MainThread]: Flushing usage events
[0m17:38:16.587468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe9e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabed4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabee7850>]}


============================== 17:38:16.590743 | 09ec1b31-b78a-4711-b3ec-74525e23d108 ==============================
[0m17:38:16.590743 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:38:16.592854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:38:17.621067 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:38:17.621876 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:38:17.624111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14898d0>]}
[0m17:38:17.696284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac253cd0>]}
[0m17:38:17.697374 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:17.833325 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:38:17.988283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:17.988921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:17.991109 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:38:18.042946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96079b10>]}
[0m17:38:18.187455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939dfe50>]}
[0m17:38:18.188278 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:38:18.190116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939b2510>]}
[0m17:38:18.193546 [info ] [MainThread]: 
[0m17:38:18.194450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:18.201327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m17:38:18.202238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m17:38:18.224027 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:38:18.221244 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:38:18.226618 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:38:18.202997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m17:38:18.224629 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:38:18.228584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:18.233903 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:38:18.234558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:18.239881 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:38:18.243429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:18.787573 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.559 seconds
[0m17:38:18.789952 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:38:18.824504 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.590 seconds
[0m17:38:18.826546 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:38:18.833506 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.590 seconds
[0m17:38:18.835609 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:38:19.032504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09ec1b31-b78a-4711-b3ec-74525e23d108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939e7dd0>]}
[0m17:38:19.033382 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:38:19.035306 [info ] [MainThread]: 
[0m17:38:19.040011 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.c6333fefa5
[0m17:38:19.040622 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.95d0092ba8
[0m17:38:19.043843 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m17:38:19.041906 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m17:38:19.041223 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.fddfbe56a2
[0m17:38:19.045866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_player_id.95d0092ba8)
[0m17:38:19.051313 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.95d0092ba8
[0m17:38:19.049485 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m17:38:19.048343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.not_null_full_name.c6333fefa5)
[0m17:38:19.066609 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.unique_player_id.fddfbe56a2)
[0m17:38:19.068440 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.c6333fefa5
[0m17:38:19.070369 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.fddfbe56a2
[0m17:38:19.072478 [debug] [Thread-2 (]: Compilation Error in test not_null_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:38:19.086912 [debug] [Thread-1 (]: Compilation Error in test not_null_full_name (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:38:19.087763 [error] [Thread-2 (]: 2 of 3 ERROR not_null_player_id ................................................ [[31mERROR[0m in 0.04s]
[0m17:38:19.089051 [debug] [Thread-3 (]: Compilation Error in test unique_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'description'
[0m17:38:19.089731 [error] [Thread-1 (]: 1 of 3 ERROR not_null_full_name ................................................ [[31mERROR[0m in 0.04s]
[0m17:38:19.091731 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.95d0092ba8
[0m17:38:19.093523 [error] [Thread-3 (]: 3 of 3 ERROR unique_player_id .................................................. [[31mERROR[0m in 0.03s]
[0m17:38:19.095403 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.c6333fefa5
[0m17:38:19.099083 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.fddfbe56a2
[0m17:38:19.103714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:19.105028 [debug] [MainThread]: Connection 'test.nba.unique_player_id.fddfbe56a2' was properly closed.
[0m17:38:19.106889 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.95d0092ba8' was properly closed.
[0m17:38:19.108706 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.c6333fefa5' was properly closed.
[0m17:38:19.110597 [info ] [MainThread]: 
[0m17:38:19.112459 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m17:38:19.114741 [debug] [MainThread]: Command end result
[0m17:38:19.241663 [info ] [MainThread]: 
[0m17:38:19.242446 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:38:19.244430 [info ] [MainThread]: 
[0m17:38:19.246496 [error] [MainThread]:   Compilation Error in test not_null_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:38:19.248329 [info ] [MainThread]: 
[0m17:38:19.250351 [error] [MainThread]:   Compilation Error in test not_null_full_name (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:38:19.252213 [info ] [MainThread]: 
[0m17:38:19.254759 [error] [MainThread]:   Compilation Error in test unique_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'description'
[0m17:38:19.256617 [info ] [MainThread]: 
[0m17:38:19.258500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:38:19.261174 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.732874, "process_user_time": 3.196189, "process_kernel_time": 0.318623, "process_mem_max_rss": "234568", "process_in_blocks": "144", "process_out_blocks": "2944", "command_success": false}
[0m17:38:19.262713 [debug] [MainThread]: Command `dbt test` failed at 17:38:19.262568 after 2.73 seconds
[0m17:38:19.264476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad72cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901e2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f4db50>]}
[0m17:38:19.266287 [debug] [MainThread]: Flushing usage events
[0m17:48:01.811068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8192da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81922210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b9d790>]}


============================== 17:48:01.814403 | e536ab32-6f6e-4b22-94a6-77f2fbc31900 ==============================
[0m17:48:01.814403 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:48:01.816477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:02.860912 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:48:02.861748 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:48:02.863984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b942010>]}
[0m17:48:02.936543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cdfdd0>]}
[0m17:48:02.937671 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:48:03.074340 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:48:03.234091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:03.234744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:03.237075 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:48:03.289740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69a0d650>]}
[0m17:48:03.426255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff699528d0>]}
[0m17:48:03.427074 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:48:03.432882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8328a510>]}
[0m17:48:03.436817 [info ] [MainThread]: 
[0m17:48:03.443561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:48:03.471150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:48:03.503613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:48:03.506250 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:48:03.511079 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:48:03.500256 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:48:03.512866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:03.514804 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:48:03.521839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:03.523391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:48:03.530218 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:48:03.531151 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:48:03.533047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:04.286036 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.764 seconds
[0m17:48:04.288215 [debug] [ThreadPool]: On list_NBA: Close
[0m17:48:04.294100 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.761 seconds
[0m17:48:04.296077 [debug] [ThreadPool]: On list_NBA: Close
[0m17:48:04.298416 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.786 seconds
[0m17:48:04.303629 [debug] [ThreadPool]: On list_NBA: Close
[0m17:48:05.136354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m17:48:05.137155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m17:48:05.139573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m17:48:05.153388 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:48:05.156893 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:48:05.159482 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:48:05.160134 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:48:05.162147 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:48:05.164090 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:48:05.165971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:05.167843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:05.169698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:05.742051 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.572 seconds
[0m17:48:05.744357 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:48:05.755433 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.589 seconds
[0m17:48:05.757530 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:48:06.188283 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.020 seconds
[0m17:48:06.190292 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:48:06.464816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bad84d0>]}
[0m17:48:06.465714 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:48:06.467659 [info ] [MainThread]: 
[0m17:48:06.472378 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m17:48:06.472982 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m17:48:06.473554 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m17:48:06.474113 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m17:48:06.475059 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m17:48:06.475803 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m17:48:06.476658 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m17:48:06.477431 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m17:48:06.479367 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m17:48:06.481221 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m17:48:06.483046 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m17:48:06.484942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m17:48:06.486810 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m17:48:06.488613 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_games)
[0m17:48:06.499536 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m17:48:06.492348 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m17:48:06.494131 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m17:48:06.495854 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m17:48:06.497831 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m17:48:06.490412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_player_game_logs)
[0m17:48:06.508639 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m17:48:06.509336 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m17:48:06.511376 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m17:48:06.517616 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m17:48:06.518329 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m17:48:06.520319 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m17:48:06.527066 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m17:48:06.530584 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m17:48:06.531285 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m17:48:06.536821 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m17:48:06.540390 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m17:48:06.541041 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m17:48:06.558181 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m17:48:06.575343 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m17:48:06.579614 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m17:48:06.588462 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m17:48:06.589095 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m17:48:06.592625 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m17:48:06.596373 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m17:48:06.598041 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m17:48:06.602873 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m17:48:06.607355 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m17:48:06.611234 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m17:48:06.614482 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m17:48:06.693956 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m17:48:06.695083 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m17:48:06.695778 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:48:06.699710 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:48:06.701542 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:48:06.703449 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m17:48:06.705940 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:48:06.708002 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:06.709768 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m17:48:06.710422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:06.712343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:06.714276 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:48:06.716062 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:48:06.720151 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:48:06.725974 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:48:06.729653 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:07.332053 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m17:48:07.356769 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m17:48:07.358311 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m17:48:07.362825 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m17:48:07.365721 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m17:48:07.369215 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m17:48:07.387630 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m17:48:07.389959 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m17:48:07.464720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m17:48:07.467447 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m17:48:07.484262 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m17:48:07.486425 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m17:48:07.541371 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69571990>]}
[0m17:48:07.543597 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.05s]
[0m17:48:07.545437 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m17:48:07.550411 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff602804d0>]}
[0m17:48:07.551360 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.06s]
[0m17:48:07.553235 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m17:48:07.641633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ba8c950>]}
[0m17:48:07.642702 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff695aacd0>]}
[0m17:48:07.643647 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.15s]
[0m17:48:07.645730 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.14s]
[0m17:48:07.647639 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m17:48:07.649438 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m17:48:07.651515 [debug] [Thread-8 (]: Began running node model.nba.player_game_logs_agg_example
[0m17:48:07.653382 [debug] [Thread-6 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m17:48:07.656033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b911d10>]}
[0m17:48:07.655089 [info ] [Thread-8 (]: 7 of 12 START sql view model intermediate.player_game_logs_agg_example ......... [RUN]
[0m17:48:07.656928 [info ] [Thread-6 (]: 8 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m17:48:07.658927 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.17s]
[0m17:48:07.660799 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.player_game_logs_agg_example'
[0m17:48:07.662471 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_playoff_appearances_by_team_example)
[0m17:48:07.664564 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m17:48:07.666211 [debug] [Thread-8 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m17:48:07.668089 [debug] [Thread-6 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m17:48:07.670218 [debug] [Thread-3 (]: Began running node model.nba.fct_players_by_college_example
[0m17:48:07.670823 [debug] [Thread-7 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m17:48:07.677386 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m17:48:07.681117 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:48:07.681976 [info ] [Thread-3 (]: 9 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m17:48:07.683888 [info ] [Thread-7 (]: 10 of 12 START sql table model warehouse.fct_playoff_games_by_player_example ... [RUN]
[0m17:48:07.689378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_players_by_college_example)
[0m17:48:07.690189 [debug] [Thread-8 (]: Began executing node model.nba.player_game_logs_agg_example
[0m17:48:07.692035 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_games_by_player_example'
[0m17:48:07.692600 [debug] [Thread-6 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m17:48:07.694883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63561610>]}
[0m17:48:07.695545 [debug] [Thread-3 (]: Began compiling node model.nba.fct_players_by_college_example
[0m17:48:07.700270 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m17:48:07.701028 [debug] [Thread-7 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m17:48:07.724738 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:48:07.725677 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.21s]
[0m17:48:07.741307 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m17:48:07.736848 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m17:48:07.740285 [debug] [Thread-8 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m17:48:07.729080 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m17:48:07.744536 [debug] [Thread-6 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m17:48:07.752887 [debug] [Thread-6 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m17:48:07.751764 [debug] [Thread-7 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m17:48:07.749094 [debug] [Thread-8 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m17:48:07.754665 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m17:48:07.755463 [debug] [Thread-3 (]: Began executing node model.nba.fct_players_by_college_example
[0m17:48:07.759651 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m17:48:07.760341 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:48:07.766861 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m17:48:07.773576 [debug] [Thread-7 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m17:48:07.774342 [debug] [Thread-7 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m17:48:07.776851 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m17:48:07.777487 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:48:07.779396 [debug] [Thread-3 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m17:48:07.783294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:08.934784 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.174 seconds
[0m17:48:08.937123 [debug] [Thread-8 (]: On model.nba.player_game_logs_agg_example: Close
[0m17:48:08.969070 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.214 seconds
[0m17:48:08.971404 [debug] [Thread-6 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m17:48:09.133660 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82303490>]}
[0m17:48:09.134665 [info ] [Thread-6 (]: 8 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.47s]
[0m17:48:09.136698 [debug] [Thread-6 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m17:48:09.403862 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b96090>]}
[0m17:48:09.404866 [info ] [Thread-8 (]: 7 of 12 OK created sql view model intermediate.player_game_logs_agg_example .... [[32mSUCCESS 1[0m in 1.74s]
[0m17:48:09.406923 [debug] [Thread-8 (]: Finished running node model.nba.player_game_logs_agg_example
[0m17:48:09.408900 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m17:48:09.409456 [debug] [Thread-1 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m17:48:09.410569 [info ] [Thread-4 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m17:48:09.412508 [info ] [Thread-1 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m17:48:09.414314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_playoff_season_example)
[0m17:48:09.416179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now model.nba.fct_player_points_per_regular_season_example)
[0m17:48:09.417919 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m17:48:09.419868 [debug] [Thread-1 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m17:48:09.425245 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:48:09.428691 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:48:09.433361 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m17:48:09.437691 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:48:09.438315 [debug] [Thread-1 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m17:48:09.443225 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:48:09.446832 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m17:48:09.448299 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m17:48:09.450221 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m17:48:09.450890 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:09.452959 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m17:48:09.456869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:09.580798 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.797 seconds
[0m17:48:09.583273 [debug] [Thread-3 (]: On model.nba.fct_players_by_college_example: Close
[0m17:48:09.690519 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.913 seconds
[0m17:48:09.692873 [debug] [Thread-7 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m17:48:09.750545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6961e710>]}
[0m17:48:09.751599 [info ] [Thread-3 (]: 9 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 2.06s]
[0m17:48:09.753579 [debug] [Thread-3 (]: Finished running node model.nba.fct_players_by_college_example
[0m17:48:09.854568 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cef490>]}
[0m17:48:09.855554 [info ] [Thread-7 (]: 10 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 2.16s]
[0m17:48:09.857476 [debug] [Thread-7 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m17:48:10.751800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.295 seconds
[0m17:48:10.754014 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m17:48:11.003679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b9c590>]}
[0m17:48:11.004657 [info ] [Thread-1 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.59s]
[0m17:48:11.006696 [debug] [Thread-1 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m17:48:11.066918 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.616 seconds
[0m17:48:11.069093 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m17:48:11.253332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e536ab32-6f6e-4b22-94a6-77f2fbc31900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69646190>]}
[0m17:48:11.254315 [info ] [Thread-4 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.84s]
[0m17:48:11.256459 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m17:48:11.259563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:11.260155 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m17:48:11.262092 [debug] [MainThread]: Connection 'model.nba.stg_games' was properly closed.
[0m17:48:11.263959 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m17:48:11.265882 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m17:48:11.267713 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m17:48:11.269530 [debug] [MainThread]: Connection 'model.nba.stg_team_stats_by_season' was properly closed.
[0m17:48:11.271440 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m17:48:11.273352 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m17:48:11.275431 [info ] [MainThread]: 
[0m17:48:11.277133 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 7.83 seconds (7.83s).
[0m17:48:11.280592 [debug] [MainThread]: Command end result
[0m17:48:11.332678 [info ] [MainThread]: 
[0m17:48:11.333443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:11.335353 [info ] [MainThread]: 
[0m17:48:11.337182 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:48:11.339684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.591072, "process_user_time": 3.843893, "process_kernel_time": 0.480486, "process_mem_max_rss": "239056", "process_out_blocks": "4704", "process_in_blocks": "0"}
[0m17:48:11.341320 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:11.341156 after 9.59 seconds
[0m17:48:11.343030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843564d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84356e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819077d0>]}
[0m17:48:11.344925 [debug] [MainThread]: Flushing usage events
[0m17:48:17.082057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91de8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92115e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93096950>]}


============================== 17:48:17.085442 | 3e544bbe-d435-4127-9028-2d48805fc511 ==============================
[0m17:48:17.085442 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:48:17.087815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:18.128629 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:48:18.129447 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:48:18.131743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be23c90>]}
[0m17:48:18.203588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93081a50>]}
[0m17:48:18.204705 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:48:18.340924 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:48:18.504935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:18.505580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:18.507929 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:48:18.560040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79eb3f90>]}
[0m17:48:18.707674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff798b5010>]}
[0m17:48:18.708527 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:48:18.710322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7989e910>]}
[0m17:48:18.713745 [info ] [MainThread]: 
[0m17:48:18.714622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:48:18.721463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m17:48:18.722302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m17:48:18.723058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m17:48:18.741525 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:48:18.744333 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:48:18.748423 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:48:18.749087 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:48:18.750979 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:48:18.752835 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:48:18.754655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:18.756448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:18.758258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:19.647311 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.891 seconds
[0m17:48:19.649685 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:48:20.500139 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.745 seconds
[0m17:48:20.502236 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:48:20.643531 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.885 seconds
[0m17:48:20.645752 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:48:20.832977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e544bbe-d435-4127-9028-2d48805fc511', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79de13d0>]}
[0m17:48:20.833851 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:48:20.835717 [info ] [MainThread]: 
[0m17:48:20.840290 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.c6333fefa5
[0m17:48:20.840944 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.95d0092ba8
[0m17:48:20.841487 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.fddfbe56a2
[0m17:48:20.842105 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m17:48:20.844070 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m17:48:20.845957 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m17:48:20.848635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_full_name.c6333fefa5)
[0m17:48:20.849731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.not_null_player_id.95d0092ba8)
[0m17:48:20.851648 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.unique_player_id.fddfbe56a2)
[0m17:48:20.853421 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.c6333fefa5
[0m17:48:20.855298 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.95d0092ba8
[0m17:48:20.857127 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.fddfbe56a2
[0m17:48:20.891273 [debug] [Thread-1 (]: Compilation Error in test not_null_full_name (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:48:20.892480 [debug] [Thread-2 (]: Compilation Error in test not_null_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:48:20.893595 [debug] [Thread-3 (]: Compilation Error in test unique_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'description'
[0m17:48:20.894337 [error] [Thread-1 (]: 1 of 3 ERROR not_null_full_name ................................................ [[31mERROR[0m in 0.05s]
[0m17:48:20.896333 [error] [Thread-2 (]: 2 of 3 ERROR not_null_player_id ................................................ [[31mERROR[0m in 0.05s]
[0m17:48:20.898209 [error] [Thread-3 (]: 3 of 3 ERROR unique_player_id .................................................. [[31mERROR[0m in 0.05s]
[0m17:48:20.900109 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.c6333fefa5
[0m17:48:20.901995 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.95d0092ba8
[0m17:48:20.903784 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.fddfbe56a2
[0m17:48:20.910455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:20.911811 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.c6333fefa5' was properly closed.
[0m17:48:20.913778 [debug] [MainThread]: Connection 'test.nba.unique_player_id.fddfbe56a2' was properly closed.
[0m17:48:20.915699 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.95d0092ba8' was properly closed.
[0m17:48:20.917689 [info ] [MainThread]: 
[0m17:48:20.919436 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m17:48:20.921682 [debug] [MainThread]: Command end result
[0m17:48:21.046579 [info ] [MainThread]: 
[0m17:48:21.047361 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:48:21.049152 [info ] [MainThread]: 
[0m17:48:21.051162 [error] [MainThread]:   Compilation Error in test not_null_full_name (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:48:21.052950 [info ] [MainThread]: 
[0m17:48:21.054962 [error] [MainThread]:   Compilation Error in test not_null_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_not_null' takes no keyword argument 'description'
[0m17:48:21.056799 [info ] [MainThread]: 
[0m17:48:21.058781 [error] [MainThread]:   Compilation Error in test unique_player_id (models/staging/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'description'
[0m17:48:21.060643 [info ] [MainThread]: 
[0m17:48:21.062939 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m17:48:21.065496 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.0454764, "process_user_time": 3.194871, "process_kernel_time": 0.323531, "process_mem_max_rss": "233552", "process_out_blocks": "2936", "command_success": false, "process_in_blocks": "0"}
[0m17:48:21.067065 [debug] [MainThread]: Command `dbt test` failed at 17:48:21.066936 after 4.05 seconds
[0m17:48:21.068962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70201e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70201dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70201c10>]}
[0m17:48:21.070833 [debug] [MainThread]: Flushing usage events
[0m17:50:23.766351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad895250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8df850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8bdcd0>]}


============================== 17:50:23.769682 | 3805de47-d9d5-4d16-b78e-00cd177580b7 ==============================
[0m17:50:23.769682 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:50:23.772678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:24.805962 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:50:24.806786 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:50:24.808986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3805de47-d9d5-4d16-b78e-00cd177580b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad889710>]}
[0m17:50:24.881352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3805de47-d9d5-4d16-b78e-00cd177580b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc4bd10>]}
[0m17:50:24.882468 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:50:25.019901 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:50:25.176712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:25.178736 [debug] [MainThread]: Partial parsing: updated file: nba://models/staging/schema.yml
[0m17:50:25.467128 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:50:25.467900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3805de47-d9d5-4d16-b78e-00cd177580b7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95437dd0>]}
[0m17:50:25.481820 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/schema.yml:
  	test definition dictionary must have exactly one key, got [('unique', {'column_name': 'player_id', 'name': 'unique_player_id'}), ('description', 'Ensures that each player_id is unique in the table, preventing duplicate player records and maintaining data integrity.')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:50:25.483174 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7788463, "process_user_time": 3.073923, "process_kernel_time": 0.209585, "process_mem_max_rss": "221432", "process_out_blocks": "112", "command_success": false, "process_in_blocks": "0"}
[0m17:50:25.484788 [debug] [MainThread]: Command `dbt test` failed at 17:50:25.484659 after 1.78 seconds
[0m17:50:25.486593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f6a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad895e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979f3110>]}
[0m17:50:25.488421 [debug] [MainThread]: Flushing usage events
[0m17:52:41.980397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa769d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5783110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5aae010>]}


============================== 17:52:41.983757 | d010485d-faf8-448a-b1ea-77be0ec479eb ==============================
[0m17:52:41.983757 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:52:41.985998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:52:43.033561 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:52:43.034372 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:52:43.036547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd010485d-faf8-448a-b1ea-77be0ec479eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9ffb50>]}
[0m17:52:43.107985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd010485d-faf8-448a-b1ea-77be0ec479eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69edc10>]}
[0m17:52:43.109079 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:52:43.244093 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:52:43.398896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:43.400962 [debug] [MainThread]: Partial parsing: updated file: nba://models/staging/schema.yml
[0m17:52:43.700138 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/schema.yml:
  	test definition dictionary must have exactly one key, got [('name', 'unique_player_id'), ('description', 'Ensures that each player_id is unique in the table, preventing duplicate player records and maintaining data integrity.'), ('unique', {'column_name': 'player_id'})] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:52:43.701546 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.7848617, "process_user_time": 2.95104, "process_kernel_time": 0.367637, "process_mem_max_rss": "221432", "process_out_blocks": "96", "command_success": false, "process_in_blocks": "0"}
[0m17:52:43.703419 [debug] [MainThread]: Command `dbt test` failed at 17:52:43.703250 after 1.79 seconds
[0m17:52:43.705326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa593fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d767890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4a6a10>]}
[0m17:52:43.707262 [debug] [MainThread]: Flushing usage events
[0m17:53:50.408558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990dd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990d4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99293e50>]}


============================== 17:53:50.411911 | c08e4306-249f-442f-9c9e-21e1a3ec4bc2 ==============================
[0m17:53:50.411911 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:53:50.414214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:53:51.447260 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:53:51.448132 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:53:51.450478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830f5fd0>]}
[0m17:53:51.524191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99493d10>]}
[0m17:53:51.525302 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:53:51.662550 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:53:51.822536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:51.823172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:51.825406 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:53:51.877228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8117c750>]}
[0m17:53:52.029511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f4d310>]}
[0m17:53:52.030355 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:53:52.032171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80be6350>]}
[0m17:53:52.035764 [info ] [MainThread]: 
[0m17:53:52.036657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:53:52.043878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m17:53:52.044754 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m17:53:52.047584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m17:53:52.064117 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:53:52.066894 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:53:52.070991 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:53:52.071687 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:53:52.073743 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:53:52.075679 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:53:52.077587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:52.079469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:52.081549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:52.661513 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.582 seconds
[0m17:53:52.664029 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:53:52.700128 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.622 seconds
[0m17:53:52.702247 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:53:52.808051 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.726 seconds
[0m17:53:52.810346 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:53:53.002714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c08e4306-249f-442f-9c9e-21e1a3ec4bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991e5110>]}
[0m17:53:53.003628 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:53:53.005493 [info ] [MainThread]: 
[0m17:53:53.010054 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m17:53:53.010707 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m17:53:53.011308 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m17:53:53.011967 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m17:53:53.013847 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m17:53:53.015706 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m17:53:53.017612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.not_null_full_name.26df58b172)
[0m17:53:53.020194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_player_id.2d6184285e)
[0m17:53:53.021282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.unique_player_id.489f92cfc7)
[0m17:53:53.023218 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m17:53:53.025060 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m17:53:53.026981 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m17:53:53.046437 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m17:53:53.051237 [debug] [Thread-2 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m17:53:53.058329 [debug] [Thread-3 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m17:53:53.062855 [debug] [Thread-1 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m17:53:53.070866 [debug] [Thread-2 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m17:53:53.086802 [debug] [Thread-1 (]: Writing runtime sql for node "test.nba.not_null_full_name.26df58b172"
[0m17:53:53.089636 [debug] [Thread-2 (]: Writing runtime sql for node "test.nba.not_null_player_id.2d6184285e"
[0m17:53:53.091037 [debug] [Thread-3 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m17:53:53.096221 [debug] [Thread-3 (]: Writing runtime sql for node "test.nba.unique_player_id.489f92cfc7"
[0m17:53:53.097222 [debug] [Thread-1 (]: Using snowflake connection "test.nba.not_null_full_name.26df58b172"
[0m17:53:53.099905 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_full_name.26df58b172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_name
from NBA.staging.stg_common_player_info
where full_name is null



      
    ) dbt_internal_test
[0m17:53:53.100934 [debug] [Thread-2 (]: Using snowflake connection "test.nba.not_null_player_id.2d6184285e"
[0m17:53:53.101687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:53.102758 [debug] [Thread-3 (]: Using snowflake connection "test.nba.unique_player_id.489f92cfc7"
[0m17:53:53.104221 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_player_id.2d6184285e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from NBA.staging.stg_common_player_info
where player_id is null



      
    ) dbt_internal_test
[0m17:53:53.108308 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.unique_player_id.489f92cfc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    player_id as unique_field,
    count(*) as n_records

from NBA.staging.stg_common_player_info
where player_id is not null
group by player_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:53:53.109879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:53:53.111821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:53:53.623951 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m17:53:53.632981 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: Close
[0m17:53:53.789229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m17:53:53.791557 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: Close
[0m17:53:53.813007 [info ] [Thread-2 (]: 2 of 3 PASS not_null_player_id ................................................. [[32mPASS[0m in 0.79s]
[0m17:53:53.813983 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m17:53:53.833186 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m17:53:53.835446 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: Close
[0m17:53:53.973803 [info ] [Thread-1 (]: 1 of 3 PASS not_null_full_name ................................................. [[32mPASS[0m in 0.96s]
[0m17:53:53.974742 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m17:53:54.003060 [info ] [Thread-3 (]: 3 of 3 PASS unique_player_id ................................................... [[32mPASS[0m in 0.98s]
[0m17:53:54.004019 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m17:53:54.007076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:54.008361 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m17:53:54.010278 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m17:53:54.012146 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m17:53:54.014056 [info ] [MainThread]: 
[0m17:53:54.016069 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:53:54.018421 [debug] [MainThread]: Command end result
[0m17:53:54.145770 [info ] [MainThread]: 
[0m17:53:54.146534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:54.148373 [info ] [MainThread]: 
[0m17:53:54.150248 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:53:54.152698 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.8061736, "process_user_time": 3.29324, "process_kernel_time": 0.389201, "process_mem_max_rss": "233156", "process_in_blocks": "1120", "process_out_blocks": "3128"}
[0m17:53:54.154214 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:54.154083 after 3.81 seconds
[0m17:53:54.155931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9912be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb0a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990c6710>]}
[0m17:53:54.157721 [debug] [MainThread]: Flushing usage events
[0m17:54:06.594053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26ed850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2725350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2724910>]}


============================== 17:54:06.597363 | 9ccbc179-a978-487c-a73d-bfad7bb7acb4 ==============================
[0m17:54:06.597363 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:06.599481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:54:07.633910 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:54:07.634740 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:54:07.637000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb4d290>]}
[0m17:54:07.709543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a9fd10>]}
[0m17:54:07.710733 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:07.846777 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:08.033234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:08.033876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:08.036117 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:54:08.088003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a756890>]}
[0m17:54:08.219781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7c2490>]}
[0m17:54:08.220625 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:54:08.222418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90878150>]}
[0m17:54:08.226187 [info ] [MainThread]: 
[0m17:54:08.227101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:08.233879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:54:08.234707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:54:08.235466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m17:54:08.251520 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:54:08.254245 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:54:08.256768 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m17:54:08.257403 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:54:08.263221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:08.261289 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:54:08.269460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:08.259345 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m17:54:08.273195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:08.903359 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.634 seconds
[0m17:54:08.906019 [debug] [ThreadPool]: On list_NBA: Close
[0m17:54:08.907177 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.644 seconds
[0m17:54:08.911727 [debug] [ThreadPool]: On list_NBA: Close
[0m17:54:08.951634 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.678 seconds
[0m17:54:08.953710 [debug] [ThreadPool]: On list_NBA: Close
[0m17:54:09.106829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m17:54:09.107647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m17:54:09.108684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m17:54:09.118661 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:54:09.121386 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:54:09.123937 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:54:09.124577 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:54:09.126559 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:54:09.128397 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:54:09.130303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:09.132194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:09.134049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:09.591068 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.461 seconds
[0m17:54:09.593387 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:54:09.629429 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.497 seconds
[0m17:54:09.631725 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:54:09.677486 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m17:54:09.680140 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:54:09.853832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908c4910>]}
[0m17:54:09.854688 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:54:09.856530 [info ] [MainThread]: 
[0m17:54:09.861035 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m17:54:09.861597 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m17:54:09.862170 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m17:54:09.862730 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m17:54:09.863671 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m17:54:09.864379 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m17:54:09.865190 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m17:54:09.866045 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m17:54:09.867920 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m17:54:09.869862 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m17:54:09.871716 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m17:54:09.883417 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m17:54:09.875506 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m17:54:09.877852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m17:54:09.888798 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m17:54:09.881583 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m17:54:09.873621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m17:54:09.900617 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m17:54:09.907078 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m17:54:09.879639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_player_game_logs)
[0m17:54:09.897874 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m17:54:09.898604 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m17:54:09.885091 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m17:54:09.887040 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m17:54:09.909818 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m17:54:09.912391 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m17:54:09.917104 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m17:54:09.920635 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m17:54:09.921320 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m17:54:09.922136 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m17:54:09.926876 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m17:54:09.958948 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m17:54:09.964534 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m17:54:09.968328 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m17:54:09.968958 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m17:54:09.969525 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m17:54:09.974554 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m17:54:09.978538 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m17:54:09.980248 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m17:54:09.983530 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m17:54:09.984163 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m17:54:10.077624 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m17:54:10.068177 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m17:54:10.068956 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:54:10.071118 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:54:09.987478 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m17:54:10.080948 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m17:54:10.082153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:10.085022 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m17:54:10.086771 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m17:54:10.087382 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:10.091213 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:54:10.094561 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m17:54:10.096546 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m17:54:10.098177 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:54:10.102208 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:54:10.103845 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m17:54:10.111724 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:54:10.107746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:54:10.105815 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:54:10.791239 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m17:54:10.815911 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m17:54:10.864738 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m17:54:10.867073 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m17:54:10.869320 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m17:54:10.872907 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m17:54:10.908376 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m17:54:10.911198 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m17:54:10.915048 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m17:54:10.917198 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m17:54:10.978110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m17:54:10.980418 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m17:54:11.022471 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908b0a10>]}
[0m17:54:11.023506 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.13s]
[0m17:54:11.025523 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m17:54:11.027599 [debug] [Thread-8 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m17:54:11.029256 [info ] [Thread-8 (]: 7 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m17:54:11.031122 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_appearances_by_team_example'
[0m17:54:11.032883 [debug] [Thread-8 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m17:54:11.038191 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:54:11.043473 [debug] [Thread-8 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m17:54:11.066837 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:54:11.069944 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9083e490>]}
[0m17:54:11.071637 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.19s]
[0m17:54:11.073491 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m17:54:11.074577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8823f710>]}
[0m17:54:11.076786 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m17:54:11.079051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2798250>]}
[0m17:54:11.080449 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.19s]
[0m17:54:11.082252 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m17:54:11.084471 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.20s]
[0m17:54:11.086320 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m17:54:11.088601 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:54:11.090188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5f03d0>]}
[0m17:54:11.097080 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.21s]
[0m17:54:11.091089 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m17:54:11.098882 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m17:54:11.100963 [debug] [Thread-5 (]: Began running node model.nba.player_game_logs_agg_example
[0m17:54:11.104663 [info ] [Thread-5 (]: 8 of 12 START sql view model intermediate.player_game_logs_agg_example ......... [RUN]
[0m17:54:11.106436 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.player_game_logs_agg_example)
[0m17:54:11.108188 [debug] [Thread-5 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m17:54:11.115056 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m17:54:11.120292 [debug] [Thread-5 (]: Began executing node model.nba.player_game_logs_agg_example
[0m17:54:11.123565 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m17:54:11.133446 [debug] [Thread-5 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m17:54:11.134242 [debug] [Thread-5 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m17:54:11.136111 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m17:54:11.181252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a30dd10>]}
[0m17:54:11.182217 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.31s]
[0m17:54:11.184216 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m17:54:11.186205 [debug] [Thread-6 (]: Began running node model.nba.fct_players_by_college_example
[0m17:54:11.186752 [debug] [Thread-4 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m17:54:11.187903 [info ] [Thread-6 (]: 9 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m17:54:11.189713 [info ] [Thread-4 (]: 10 of 12 START sql table model warehouse.fct_playoff_games_by_player_example ... [RUN]
[0m17:54:11.191585 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_players_by_college_example)
[0m17:54:11.193419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_playoff_games_by_player_example)
[0m17:54:11.195249 [debug] [Thread-6 (]: Began compiling node model.nba.fct_players_by_college_example
[0m17:54:11.197140 [debug] [Thread-4 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m17:54:11.202204 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m17:54:11.205802 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m17:54:11.211050 [debug] [Thread-6 (]: Began executing node model.nba.fct_players_by_college_example
[0m17:54:11.214975 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m17:54:11.215609 [debug] [Thread-4 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m17:54:11.220542 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m17:54:11.223694 [debug] [Thread-6 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m17:54:11.225123 [debug] [Thread-6 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m17:54:11.227605 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m17:54:11.228209 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m17:54:11.230081 [debug] [Thread-4 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m17:54:11.233938 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:54:11.910018 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m17:54:11.912391 [debug] [Thread-5 (]: On model.nba.player_game_logs_agg_example: Close
[0m17:54:12.088474 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5f03d0>]}
[0m17:54:12.089486 [info ] [Thread-5 (]: 8 of 12 OK created sql view model intermediate.player_game_logs_agg_example .... [[32mSUCCESS 1[0m in 0.98s]
[0m17:54:12.091560 [debug] [Thread-5 (]: Finished running node model.nba.player_game_logs_agg_example
[0m17:54:12.093609 [debug] [Thread-7 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m17:54:12.094196 [debug] [Thread-2 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m17:54:12.095367 [info ] [Thread-7 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m17:54:12.099126 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.fct_player_points_per_playoff_season_example'
[0m17:54:12.100890 [debug] [Thread-7 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m17:54:12.097201 [info ] [Thread-2 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m17:54:12.106725 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:54:12.107540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_player_points_per_regular_season_example)
[0m17:54:12.111420 [debug] [Thread-2 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m17:54:12.116196 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:54:12.116828 [debug] [Thread-7 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m17:54:12.121983 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:54:12.124603 [debug] [Thread-2 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m17:54:12.128853 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:54:12.130325 [debug] [Thread-7 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m17:54:12.132919 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m17:54:12.135010 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:54:12.136473 [debug] [Thread-2 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m17:54:12.139490 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m17:54:12.141272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:12.630564 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.402 seconds
[0m17:54:12.632854 [debug] [Thread-6 (]: On model.nba.fct_players_by_college_example: Close
[0m17:54:12.642399 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.408 seconds
[0m17:54:12.644619 [debug] [Thread-4 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m17:54:12.666127 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.577 seconds
[0m17:54:12.668327 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m17:54:12.817406 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88361cd0>]}
[0m17:54:12.818434 [info ] [Thread-6 (]: 9 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 1.63s]
[0m17:54:12.820440 [debug] [Thread-6 (]: Finished running node model.nba.fct_players_by_college_example
[0m17:54:12.831983 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3b7a10>]}
[0m17:54:12.832985 [info ] [Thread-4 (]: 10 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.64s]
[0m17:54:12.835025 [debug] [Thread-4 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m17:54:12.864584 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27990d0>]}
[0m17:54:12.865581 [info ] [Thread-8 (]: 7 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.83s]
[0m17:54:12.867459 [debug] [Thread-8 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m17:54:13.310566 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m17:54:13.312787 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m17:54:13.394193 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.259 seconds
[0m17:54:13.396435 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m17:54:13.720347 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881fbd90>]}
[0m17:54:13.721374 [info ] [Thread-7 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.62s]
[0m17:54:13.723424 [debug] [Thread-7 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m17:54:13.804676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ccbc179-a978-487c-a73d-bfad7bb7acb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c16690>]}
[0m17:54:13.805650 [info ] [Thread-2 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.70s]
[0m17:54:13.807623 [debug] [Thread-2 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m17:54:13.810909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:13.811527 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m17:54:13.813421 [debug] [MainThread]: Connection 'model.nba.stg_common_player_info' was properly closed.
[0m17:54:13.815311 [debug] [MainThread]: Connection 'model.nba.stg_player_game_logs' was properly closed.
[0m17:54:13.817149 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m17:54:13.818988 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m17:54:13.820907 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m17:54:13.822772 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m17:54:13.824572 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m17:54:13.826585 [info ] [MainThread]: 
[0m17:54:13.828314 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m17:54:13.831744 [debug] [MainThread]: Command end result
[0m17:54:13.884435 [info ] [MainThread]: 
[0m17:54:13.885201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:13.887077 [info ] [MainThread]: 
[0m17:54:13.888925 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:54:13.891638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3606167, "process_user_time": 3.842533, "process_kernel_time": 0.443757, "process_mem_max_rss": "238780", "process_out_blocks": "4712", "process_in_blocks": "0"}
[0m17:54:13.893182 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:13.893038 after 7.36 seconds
[0m17:54:13.894905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa273dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa273c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5116e90>]}
[0m17:54:13.896688 [debug] [MainThread]: Flushing usage events
[0m17:54:29.098293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f8c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fc4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fc4a10>]}


============================== 17:54:29.101573 | 0cc1223d-2f5a-4def-b994-3cce4c0e1d5c ==============================
[0m17:54:29.101573 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:29.103709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:30.134641 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:54:30.135486 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:54:30.137695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f13e590>]}
[0m17:54:30.210374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d088410>]}
[0m17:54:30.211525 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:30.346812 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:30.501593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:30.502236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:30.504427 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:54:30.556413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cfdd210>]}
[0m17:54:30.703277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc56950>]}
[0m17:54:30.704136 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:54:30.705928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca7ac50>]}
[0m17:54:30.709453 [info ] [MainThread]: 
[0m17:54:30.710310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:30.717066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m17:54:30.717899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m17:54:30.720588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m17:54:30.736707 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:54:30.739315 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:54:30.743303 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:54:30.743959 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:54:30.745966 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:54:30.747826 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:54:30.749669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:30.751618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:30.753512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:31.330330 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.581 seconds
[0m17:54:31.332646 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:54:31.339869 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.586 seconds
[0m17:54:31.342546 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:54:31.343661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.592 seconds
[0m17:54:31.348107 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:54:31.529949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1223d-2f5a-4def-b994-3cce4c0e1d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950911d0>]}
[0m17:54:31.530896 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:54:31.532727 [info ] [MainThread]: 
[0m17:54:31.537579 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m17:54:31.538197 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m17:54:31.539013 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m17:54:31.539677 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m17:54:31.541728 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m17:54:31.543629 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m17:54:31.546446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.not_null_full_name.26df58b172)
[0m17:54:31.547649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_player_id.2d6184285e)
[0m17:54:31.549511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.unique_player_id.489f92cfc7)
[0m17:54:31.551343 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m17:54:31.553176 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m17:54:31.555002 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m17:54:31.573224 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m17:54:31.579416 [debug] [Thread-2 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m17:54:31.586660 [debug] [Thread-3 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m17:54:31.592066 [debug] [Thread-1 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m17:54:31.599139 [debug] [Thread-2 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m17:54:31.615169 [debug] [Thread-1 (]: Writing runtime sql for node "test.nba.not_null_full_name.26df58b172"
[0m17:54:31.615866 [debug] [Thread-3 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m17:54:31.618620 [debug] [Thread-2 (]: Writing runtime sql for node "test.nba.not_null_player_id.2d6184285e"
[0m17:54:31.623153 [debug] [Thread-3 (]: Writing runtime sql for node "test.nba.unique_player_id.489f92cfc7"
[0m17:54:31.626056 [debug] [Thread-1 (]: Using snowflake connection "test.nba.not_null_full_name.26df58b172"
[0m17:54:31.629053 [debug] [Thread-2 (]: Using snowflake connection "test.nba.not_null_player_id.2d6184285e"
[0m17:54:31.629765 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_full_name.26df58b172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_name
from NBA.staging.stg_common_player_info
where full_name is null



      
    ) dbt_internal_test
[0m17:54:31.632082 [debug] [Thread-3 (]: Using snowflake connection "test.nba.unique_player_id.489f92cfc7"
[0m17:54:31.632643 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_player_id.2d6184285e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from NBA.staging.stg_common_player_info
where player_id is null



      
    ) dbt_internal_test
[0m17:54:31.634129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:31.636014 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.unique_player_id.489f92cfc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    player_id as unique_field,
    count(*) as n_records

from NBA.staging.stg_common_player_info
where player_id is not null
group by player_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:54:31.637794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:31.641950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:54:32.135736 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m17:54:32.144863 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: Close
[0m17:54:32.182664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m17:54:32.184893 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: Close
[0m17:54:32.307667 [info ] [Thread-3 (]: 3 of 3 PASS unique_player_id ................................................... [[32mPASS[0m in 0.76s]
[0m17:54:32.308624 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m17:54:32.357782 [info ] [Thread-1 (]: 1 of 3 PASS not_null_full_name ................................................. [[32mPASS[0m in 0.81s]
[0m17:54:32.358747 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m17:54:32.388404 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m17:54:32.390617 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: Close
[0m17:54:32.564155 [info ] [Thread-2 (]: 2 of 3 PASS not_null_player_id ................................................. [[32mPASS[0m in 1.02s]
[0m17:54:32.565136 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m17:54:32.568294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:32.569577 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m17:54:32.571490 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m17:54:32.573367 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m17:54:32.575316 [info ] [MainThread]: 
[0m17:54:32.577141 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m17:54:32.579601 [debug] [MainThread]: Command end result
[0m17:54:32.706305 [info ] [MainThread]: 
[0m17:54:32.707076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:32.708950 [info ] [MainThread]: 
[0m17:54:32.710906 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:54:32.713650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6747618, "process_user_time": 3.312871, "process_kernel_time": 0.344457, "process_mem_max_rss": "233112", "process_out_blocks": "3128", "process_in_blocks": "0"}
[0m17:54:32.715230 [debug] [MainThread]: Command `dbt test` succeeded at 17:54:32.715082 after 3.68 seconds
[0m17:54:32.717065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99477c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979d2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f67650>]}
[0m17:54:32.719000 [debug] [MainThread]: Flushing usage events
[0m17:55:33.877288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b010210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1c3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1c3ed0>]}


============================== 17:55:33.880743 | b480f1d0-2b34-4ff1-bc5e-c97d95458bac ==============================
[0m17:55:33.880743 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:55:33.882843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:34.924110 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m17:55:34.924944 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m17:55:34.927300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7300a750>]}
[0m17:55:34.999592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c279d10>]}
[0m17:55:35.000764 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:55:35.135972 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:55:35.290767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:35.291408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:35.293647 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m17:55:35.345595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73008750>]}
[0m17:55:35.375654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72e2f350>]}
[0m17:55:35.376469 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m17:55:35.379719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72c27990>]}
[0m17:55:35.383722 [info ] [MainThread]: 
[0m17:55:35.384613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:35.391641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m17:55:35.411399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m17:55:35.413810 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m17:55:35.417929 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m17:55:35.420221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.414654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m17:55:35.417328 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m17:55:35.427697 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m17:55:35.428364 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m17:55:35.432310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.430344 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m17:55:35.440673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:35.980302 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.540 seconds
[0m17:55:35.983098 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m17:55:35.997457 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.565 seconds
[0m17:55:35.999686 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m17:55:36.241674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.821 seconds
[0m17:55:36.243888 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m17:55:36.435914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b480f1d0-2b34-4ff1-bc5e-c97d95458bac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72fd6990>]}
[0m17:55:36.436746 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:55:36.438505 [info ] [MainThread]: 
[0m17:55:36.450348 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m17:55:36.451048 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m17:55:36.456107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_games)
[0m17:55:36.457727 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m17:55:36.453010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_common_player_info)
[0m17:55:36.455440 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m17:55:36.451702 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m17:55:36.472618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_player_game_logs)
[0m17:55:36.454332 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m17:55:36.467783 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m17:55:36.468520 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m17:55:36.483542 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m17:55:36.456953 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m17:55:36.474378 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m17:55:36.476723 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m17:55:36.494714 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m17:55:36.486430 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m17:55:36.501570 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m17:55:36.493472 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m17:55:36.494112 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m17:55:36.507450 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m17:55:36.500345 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m17:55:36.488457 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m17:55:36.470862 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m17:55:36.509778 [debug] [Thread-8 (]: Began running node model.nba.fct_players_by_college_example
[0m17:55:36.510497 [debug] [Thread-7 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m17:55:36.511111 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m17:55:36.511687 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m17:55:36.512219 [debug] [Thread-1 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m17:55:36.528992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now test.nba.unique_player_id.489f92cfc7)
[0m17:55:36.531044 [debug] [Thread-1 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m17:55:36.517369 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m17:55:36.544756 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m17:55:36.522320 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.nba.not_null_full_name.26df58b172'
[0m17:55:36.548419 [debug] [Thread-7 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m17:55:36.527032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now test.nba.not_null_player_id.2d6184285e)
[0m17:55:36.514773 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m17:55:36.566810 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m17:55:36.519559 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_players_by_college_example'
[0m17:55:36.543428 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m17:55:36.546867 [debug] [Thread-5 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m17:55:36.576311 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.fct_playoff_appearances_by_team_example)
[0m17:55:36.578572 [debug] [Thread-5 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m17:55:36.560950 [debug] [Thread-7 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m17:55:36.516812 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m17:55:36.593514 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m17:55:36.574336 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m17:55:36.599246 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m17:55:36.561400 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m17:55:36.579174 [debug] [Thread-1 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m17:55:36.585906 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m17:55:36.571400 [debug] [Thread-8 (]: Began compiling node model.nba.fct_players_by_college_example
[0m17:55:36.596236 [debug] [Thread-7 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m17:55:36.525484 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m17:55:36.602664 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m17:55:36.624065 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m17:55:36.612314 [debug] [Thread-2 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m17:55:36.618415 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m17:55:36.619626 [debug] [Thread-7 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m17:55:36.621861 [debug] [Thread-4 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m17:55:36.622587 [debug] [Thread-3 (]: Began running node model.nba.player_game_logs_agg_example
[0m17:55:36.636892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.player_game_logs_agg_example)
[0m17:55:36.609565 [debug] [Thread-1 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m17:55:36.632598 [debug] [Thread-2 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m17:55:36.643572 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m17:55:36.634860 [debug] [Thread-8 (]: Began executing node model.nba.fct_players_by_college_example
[0m17:55:36.623086 [debug] [Thread-5 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m17:55:36.639542 [debug] [Thread-3 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m17:55:36.656209 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m17:55:36.647594 [debug] [Thread-8 (]: Finished running node model.nba.fct_players_by_college_example
[0m17:55:36.649786 [debug] [Thread-5 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m17:55:36.634212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_playoff_games_by_player_example)
[0m17:55:36.663218 [debug] [Thread-4 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m17:55:36.661759 [debug] [Thread-3 (]: Began executing node model.nba.player_game_logs_agg_example
[0m17:55:36.669527 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m17:55:36.670647 [debug] [Thread-3 (]: Finished running node model.nba.player_game_logs_agg_example
[0m17:55:36.675330 [debug] [Thread-6 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m17:55:36.675940 [debug] [Thread-7 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m17:55:36.679912 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.nba.not_null_full_name.26df58b172, now model.nba.fct_player_points_per_regular_season_example)
[0m17:55:36.681946 [debug] [Thread-7 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m17:55:36.676962 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_player_points_per_playoff_season_example)
[0m17:55:36.678473 [debug] [Thread-4 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m17:55:36.691991 [debug] [Thread-4 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m17:55:36.689607 [debug] [Thread-6 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m17:55:36.698947 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m17:55:36.686771 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m17:55:36.704180 [debug] [Thread-6 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m17:55:36.705224 [debug] [Thread-6 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m17:55:36.715495 [debug] [Thread-7 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m17:55:36.716583 [debug] [Thread-7 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m17:55:36.721398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:36.722799 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m17:55:36.725189 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m17:55:36.727007 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m17:55:36.729135 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m17:55:36.730978 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m17:55:36.732943 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m17:55:36.734950 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m17:55:36.737012 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m17:55:36.741369 [debug] [MainThread]: Command end result
[0m17:55:36.884334 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:55:36.884973 [info ] [MainThread]: Building catalog
[0m17:55:36.899025 [debug] [ThreadPool]: Acquiring new snowflake connection 'NBA.information_schema'
[0m17:55:37.007136 [debug] [ThreadPool]: Using snowflake connection "NBA.information_schema"
[0m17:55:37.008419 [debug] [ThreadPool]: On NBA.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "NBA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from NBA.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from NBA.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m17:55:37.010565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:43.866355 [debug] [ThreadPool]: SQL status: SUCCESS 340 in 6.856 seconds
[0m17:55:44.155246 [debug] [ThreadPool]: On NBA.information_schema: Close
[0m17:55:44.460887 [info ] [MainThread]: Catalog written to /workspaces/fxtn7c3oiwkalwzz/repository/nba/target/catalog.json
[0m17:55:44.462664 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.648215, "process_user_time": 3.57691, "process_kernel_time": 0.293023, "process_mem_max_rss": "235460", "process_out_blocks": "6848", "process_in_blocks": "0"}
[0m17:55:44.464312 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:55:44.464159 after 10.65 seconds
[0m17:55:44.465905 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:55:44.467776 [debug] [MainThread]: Connection 'NBA.information_schema' was properly closed.
[0m17:55:44.469728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b05afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791e6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4e5290>]}
[0m17:55:44.471599 [debug] [MainThread]: Flushing usage events
[0m03:39:41.718854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f17e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f17e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f17da10>]}


============================== 03:39:41.722184 | a539363b-7b69-4ded-ac27-22d24f9fc9dc ==============================
[0m03:39:41.722184 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:39:41.725243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select mart_season_scoring_leaders', 'send_anonymous_usage_stats': 'True'}
[0m03:39:42.751414 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m03:39:42.752228 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m03:39:42.754489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d1dff10>]}
[0m03:39:42.826275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff803e1d10>]}
[0m03:39:42.827408 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:39:42.963753 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:39:43.126329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:39:43.126974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:39:43.129198 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m03:39:43.181507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66e06e50>]}
[0m03:39:43.316455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67124090>]}
[0m03:39:43.317275 [info ] [MainThread]: Found 13 models, 12 data tests, 7 sources, 1 exposure, 461 macros
[0m03:39:43.319094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f943d0>]}
[0m03:39:43.322294 [info ] [MainThread]: 
[0m03:39:43.323113 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:39:43.325518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m03:39:43.341840 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m03:39:43.342473 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m03:39:43.344428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:44.558397 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.214 seconds
[0m03:39:44.560522 [debug] [ThreadPool]: On list_NBA: Close
[0m03:39:44.785341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m03:39:44.786242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m03:39:44.787449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_dbt_parker'
[0m03:39:44.797046 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m03:39:44.797780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m03:39:44.800381 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m03:39:44.802872 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m03:39:44.803491 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m03:39:44.807350 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m03:39:44.808333 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m03:39:44.810157 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m03:39:44.812069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:39:44.814000 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m03:39:44.815881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:44.817809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:44.822217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:45.474210 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.662 seconds
[0m03:39:45.476341 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m03:39:45.481917 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.660 seconds
[0m03:39:45.483979 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m03:39:45.615440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.798 seconds
[0m03:39:45.617933 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m03:39:45.619838 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.804 seconds
[0m03:39:45.624965 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m03:39:45.822704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d336490>]}
[0m03:39:45.823581 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:39:45.825422 [info ] [MainThread]: 
[0m03:39:45.832213 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m03:39:45.833028 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_parker.mart_season_scoring_leaders ............ [RUN]
[0m03:39:45.835384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.mart_season_scoring_leaders)
[0m03:39:45.838127 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m03:39:45.848449 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m03:39:45.854907 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m03:39:45.887525 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m03:39:45.895263 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m03:39:45.895971 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace transient table NBA.dbt_parker.mart_season_scoring_leaders
         as
        (

WITH player_season_stats AS (
    SELECT 
        player_id,
        player_name,
        season,
        SUM(points) as total_points,
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points) / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    WHERE 
        game_type = 'Regular Season'  -- Excluding playoff games to keep seasonal stats consistent
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_points DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT 
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1  -- Only selecting the top scorer for each season
ORDER BY 
    season DESC
        );
[0m03:39:45.898406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:39:48.175849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.277 seconds
[0m03:39:48.197144 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m03:39:48.421029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a539363b-7b69-4ded-ac27-22d24f9fc9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640ffbd0>]}
[0m03:39:48.422052 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_parker.mart_season_scoring_leaders ....... [[32mSUCCESS 1[0m in 2.58s]
[0m03:39:48.423957 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m03:39:48.426888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:39:48.428272 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m03:39:48.430507 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m03:39:48.433167 [debug] [MainThread]: Connection 'list_NBA_dbt_parker' was properly closed.
[0m03:39:48.435747 [debug] [MainThread]: Connection 'list_NBA_staging' was properly closed.
[0m03:39:48.438432 [info ] [MainThread]: 
[0m03:39:48.440833 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m03:39:48.443826 [debug] [MainThread]: Command end result
[0m03:39:48.573689 [info ] [MainThread]: 
[0m03:39:48.574479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:39:48.576325 [info ] [MainThread]: 
[0m03:39:48.578220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:39:48.580677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9219112, "process_user_time": 3.437433, "process_kernel_time": 0.544344, "process_mem_max_rss": "236248", "process_in_blocks": "2840", "process_out_blocks": "5192"}
[0m03:39:48.582210 [debug] [MainThread]: Command `dbt run` succeeded at 03:39:48.582089 after 6.92 seconds
[0m03:39:48.583976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f15ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ba2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ba3e50>]}
[0m03:39:48.585810 [debug] [MainThread]: Flushing usage events
[0m03:41:57.122025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d228d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d6fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d6eb50>]}


============================== 03:41:57.125394 | bb0d55b1-4e84-4fb3-8e48-0896ccc086ba ==============================
[0m03:41:57.125394 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:41:57.127411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_season_scoring_leaders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:41:58.174733 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m03:41:58.175549 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m03:41:58.177769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad93c90>]}
[0m03:41:58.251239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f75f90>]}
[0m03:41:58.252364 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:41:58.391375 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:41:58.557869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:41:58.558952 [debug] [MainThread]: Partial parsing: updated file: nba://models/marts/mart_season_scoring_leaders.sql
[0m03:41:58.837592 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:41:58.838365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ba3010>]}
[0m03:41:59.011675 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m03:41:59.101398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be70950>]}
[0m03:41:59.320772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd0fc50>]}
[0m03:41:59.321657 [info ] [MainThread]: Found 13 models, 12 data tests, 7 sources, 1 exposure, 461 macros
[0m03:41:59.323864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bede310>]}
[0m03:41:59.327672 [info ] [MainThread]: 
[0m03:41:59.331530 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:41:59.334159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m03:41:59.364580 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m03:41:59.365234 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m03:41:59.367374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:59.916224 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.549 seconds
[0m03:41:59.918324 [debug] [ThreadPool]: On list_NBA: Close
[0m03:42:00.112023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m03:42:00.112994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_dbt_parker'
[0m03:42:00.113839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m03:42:00.115310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m03:42:00.124475 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m03:42:00.134807 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m03:42:00.131439 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m03:42:00.134160 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m03:42:00.140476 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m03:42:00.136689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:00.138578 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m03:42:00.127427 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m03:42:00.142371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:00.146811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:00.148698 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m03:42:00.154943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:00.597873 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.451 seconds
[0m03:42:00.600059 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m03:42:00.602877 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.461 seconds
[0m03:42:00.606085 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m03:42:00.837240 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.682 seconds
[0m03:42:00.839342 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m03:42:01.536087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.399 seconds
[0m03:42:01.538347 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m03:42:01.717234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf446d0>]}
[0m03:42:01.718176 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:42:01.720009 [info ] [MainThread]: 
[0m03:42:01.724919 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m03:42:01.725777 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_parker.mart_season_scoring_leaders ............ [RUN]
[0m03:42:01.727707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.mart_season_scoring_leaders)
[0m03:42:01.729464 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m03:42:01.739727 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m03:42:01.744378 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m03:42:01.774720 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m03:42:01.780503 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m03:42:01.781270 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace transient table NBA.dbt_parker.mart_season_scoring_leaders
         as
        (

WITH player_season_stats AS (
    SELECT 
        player_id,
        player_name,
        season,
        SUM(points) as total_points
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points) / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    WHERE 
        game_type = 'Regular Season'  -- Excluding playoff games to keep seasonal stats consistent
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_points DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT 
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1  -- Only selecting the top scorer for each season
ORDER BY 
    season DESC
        );
[0m03:42:01.783246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:02.364837 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf14be-0106-6a8a-0000-00117a43829d
[0m03:42:02.365558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected 'COUNT'.
syntax error line 11 at position 14 unexpected 'DISTINCT'.
syntax error line 11 at position 32 unexpected 'as'.
syntax error line 26 at position 73 unexpected ')'.
[0m03:42:02.367878 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m03:42:02.555350 [debug] [Thread-1 (]: Database Error in model mart_season_scoring_leaders (models/marts/mart_season_scoring_leaders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'COUNT'.
  syntax error line 11 at position 14 unexpected 'DISTINCT'.
  syntax error line 11 at position 32 unexpected 'as'.
  syntax error line 26 at position 73 unexpected ')'.
  compiled code at target/run/nba/models/marts/mart_season_scoring_leaders.sql
[0m03:42:02.557301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb0d55b1-4e84-4fb3-8e48-0896ccc086ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2270c90>]}
[0m03:42:02.558979 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_parker.mart_season_scoring_leaders ... [[31mERROR[0m in 0.83s]
[0m03:42:02.560833 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m03:42:02.563711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:02.564231 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m03:42:02.566141 [debug] [MainThread]: Connection 'list_NBA_dbt_parker' was properly closed.
[0m03:42:02.567917 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m03:42:02.569712 [debug] [MainThread]: Connection 'list_NBA_staging' was properly closed.
[0m03:42:02.571736 [info ] [MainThread]: 
[0m03:42:02.573573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m03:42:02.575873 [debug] [MainThread]: Command end result
[0m03:42:02.629006 [info ] [MainThread]: 
[0m03:42:02.629790 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:42:02.631689 [info ] [MainThread]: 
[0m03:42:02.633713 [error] [MainThread]:   Database Error in model mart_season_scoring_leaders (models/marts/mart_season_scoring_leaders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'COUNT'.
  syntax error line 11 at position 14 unexpected 'DISTINCT'.
  syntax error line 11 at position 32 unexpected 'as'.
  syntax error line 26 at position 73 unexpected ')'.
  compiled code at target/run/nba/models/marts/mart_season_scoring_leaders.sql
[0m03:42:02.635465 [info ] [MainThread]: 
[0m03:42:02.637307 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:42:02.639861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.5795445, "process_user_time": 3.851482, "process_kernel_time": 0.29239, "process_mem_max_rss": "238188", "process_out_blocks": "4312", "command_success": false, "process_in_blocks": "0"}
[0m03:42:02.641410 [debug] [MainThread]: Command `dbt run` failed at 03:42:02.641266 after 5.58 seconds
[0m03:42:02.643086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0edc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3773410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3770c90>]}
[0m03:42:02.644882 [debug] [MainThread]: Flushing usage events
[0m03:54:06.429361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb355c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb387dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb355e2d0>]}


============================== 03:54:06.432691 | 9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb ==============================
[0m03:54:06.432691 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:06.434887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_season_scoring_leaders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:07.462178 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m03:54:07.462999 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m03:54:07.465285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d70eb90>]}
[0m03:54:07.537837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb390fd50>]}
[0m03:54:07.538921 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:07.674189 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:07.856530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:07.857310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:07.859522 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m03:54:07.913105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5dea10>]}
[0m03:54:08.048582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c2abd0>]}
[0m03:54:08.049390 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 1 exposure, 461 macros
[0m03:54:08.051214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b483710>]}
[0m03:54:08.054370 [info ] [MainThread]: 
[0m03:54:08.055939 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:54:08.058515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m03:54:08.078833 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m03:54:08.079461 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m03:54:08.081646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:08.907871 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.826 seconds
[0m03:54:08.910086 [debug] [ThreadPool]: On list_NBA: Close
[0m03:54:09.185612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m03:54:09.186455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m03:54:09.188047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_dbt_parker'
[0m03:54:09.196907 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m03:54:09.197858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m03:54:09.200524 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m03:54:09.203318 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m03:54:09.210440 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m03:54:09.207833 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m03:54:09.208480 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m03:54:09.215986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:09.212274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:09.214113 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m03:54:09.203967 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m03:54:09.222793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:09.224457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:09.805574 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.593 seconds
[0m03:54:09.807701 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m03:54:09.869204 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.645 seconds
[0m03:54:09.871462 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m03:54:09.934734 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.712 seconds
[0m03:54:09.937404 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m03:54:09.939835 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.724 seconds
[0m03:54:09.942027 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m03:54:10.117265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d69f810>]}
[0m03:54:10.118122 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:54:10.119992 [info ] [MainThread]: 
[0m03:54:10.124426 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m03:54:10.125175 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_parker.mart_season_scoring_leaders ............. [RUN]
[0m03:54:10.127056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.mart_season_scoring_leaders)
[0m03:54:10.128821 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m03:54:10.138099 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m03:54:10.142794 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m03:54:10.168311 [debug] [Thread-1 (]: Dropping relation "NBA"."DBT_PARKER"."MART_SEASON_SCORING_LEADERS" because it is of type table
[0m03:54:10.176714 [debug] [Thread-1 (]: Applying DROP to: "NBA"."DBT_PARKER"."MART_SEASON_SCORING_LEADERS"
[0m03:54:10.183301 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m03:54:10.183962 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
drop table if exists "NBA"."DBT_PARKER"."MART_SEASON_SCORING_LEADERS" cascade
[0m03:54:10.185945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:10.905902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m03:54:10.918189 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m03:54:10.924045 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m03:54:10.924723 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace   view NBA.dbt_parker.mart_season_scoring_leaders
  
   as (
    WITH player_season_stats AS (
    SELECT
        player_id,
        player_name,
        season,
        SUM(points) as total_points,
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points)::FLOAT / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        season,
        player_id,
        player_name,
        total_points,
        games_played,
        points_per_game,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_points DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1
  );
[0m03:54:11.474409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m03:54:11.495593 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m03:54:11.689615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9970a7fe-a30a-4b01-a6ee-c3a8ebb5a6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42e10d0>]}
[0m03:54:11.690649 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_parker.mart_season_scoring_leaders ........ [[32mSUCCESS 1[0m in 1.56s]
[0m03:54:11.692617 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m03:54:11.695534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:11.696754 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m03:54:11.698613 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m03:54:11.700474 [debug] [MainThread]: Connection 'list_NBA_dbt_parker' was properly closed.
[0m03:54:11.702365 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m03:54:11.704350 [info ] [MainThread]: 
[0m03:54:11.706130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m03:54:11.708394 [debug] [MainThread]: Command end result
[0m03:54:11.832420 [info ] [MainThread]: 
[0m03:54:11.833234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:54:11.835072 [info ] [MainThread]: 
[0m03:54:11.837024 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:54:11.839590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4703655, "process_user_time": 3.360246, "process_kernel_time": 0.300021, "process_mem_max_rss": "232664", "process_in_blocks": "1152", "process_out_blocks": "3112"}
[0m03:54:11.841450 [debug] [MainThread]: Command `dbt run` succeeded at 03:54:11.841305 after 5.47 seconds
[0m03:54:11.843297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fb1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fb0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb387e110>]}
[0m03:54:11.845205 [debug] [MainThread]: Flushing usage events
[0m04:30:02.564183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73d5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73d61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73d5850>]}


============================== 04:30:02.567403 | f161af01-2e17-422d-a20f-3d099a08b29e ==============================
[0m04:30:02.567403 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:30:02.569713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select mart_season_scoring_leaders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:03.592151 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m04:30:03.592951 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m04:30:03.595362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95433ad0>]}
[0m04:30:03.667098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8645b10>]}
[0m04:30:03.668234 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:30:03.805282 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:30:03.973288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:30:03.974286 [debug] [MainThread]: Partial parsing: updated file: nba://models/marts/mart_season_scoring_leaders.sql
[0m04:30:04.256615 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:30:04.257386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eee5610>]}
[0m04:30:04.396680 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m04:30:04.495410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5fb990>]}
[0m04:30:04.713662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e406cd0>]}
[0m04:30:04.714518 [info ] [MainThread]: Found 13 models, 10 data tests, 7 sources, 1 exposure, 461 macros
[0m04:30:04.716380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f11ba90>]}
[0m04:30:04.719518 [info ] [MainThread]: 
[0m04:30:04.720357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:30:04.722788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m04:30:04.738554 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m04:30:04.739219 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m04:30:04.741236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:05.578293 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.837 seconds
[0m04:30:05.580481 [debug] [ThreadPool]: On list_NBA: Close
[0m04:30:05.803464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m04:30:05.804382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m04:30:05.811192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m04:30:05.814822 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m04:30:05.815765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_dbt_parker'
[0m04:30:05.818346 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m04:30:05.822576 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m04:30:05.829921 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m04:30:05.827235 [debug] [ThreadPool]: Using snowflake connection "list_NBA_dbt_parker"
[0m04:30:05.833648 [debug] [ThreadPool]: On list_NBA_dbt_parker: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_dbt_parker"} */
show objects in NBA.dbt_parker limit 10000
[0m04:30:05.823255 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m04:30:05.831775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:05.827905 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m04:30:05.841851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:05.837458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:05.835524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:06.443385 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.606 seconds
[0m04:30:06.445761 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m04:30:06.466927 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.625 seconds
[0m04:30:06.468911 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m04:30:06.624919 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.793 seconds
[0m04:30:06.627090 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m04:30:07.250515 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.415 seconds
[0m04:30:07.252755 [debug] [ThreadPool]: On list_NBA_dbt_parker: Close
[0m04:30:07.906878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3a11d0>]}
[0m04:30:07.907807 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m04:30:07.909714 [info ] [MainThread]: 
[0m04:30:07.914781 [debug] [Thread-1 (]: Began running node model.nba.mart_season_scoring_leaders
[0m04:30:07.915663 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_parker.mart_season_scoring_leaders ............. [RUN]
[0m04:30:07.917548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_dbt_parker, now model.nba.mart_season_scoring_leaders)
[0m04:30:07.919273 [debug] [Thread-1 (]: Began compiling node model.nba.mart_season_scoring_leaders
[0m04:30:07.929091 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.mart_season_scoring_leaders"
[0m04:30:07.933727 [debug] [Thread-1 (]: Began executing node model.nba.mart_season_scoring_leaders
[0m04:30:07.964815 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.mart_season_scoring_leaders"
[0m04:30:07.970926 [debug] [Thread-1 (]: Using snowflake connection "model.nba.mart_season_scoring_leaders"
[0m04:30:07.971646 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.mart_season_scoring_leaders"} */
create or replace   view NBA.dbt_parker.mart_season_scoring_leaders
  
   as (
    WITH player_season_stats AS (
    SELECT
        player_id,
        player_name,
        season,
        SUM(points) as total_pts,
        COUNT(DISTINCT game_id) as games_played,
        ROUND(SUM(points)::FLOAT / COUNT(DISTINCT game_id), 2) as points_per_game
    FROM 
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id,
        player_name,
        season
),

ranked_players AS (
    SELECT 
        season,
        player_id,
        player_name,
        total_pts as total_points,
        games_played,
        points_per_game,
        ROW_NUMBER() OVER (PARTITION BY season ORDER BY total_pts DESC) as scoring_rank
    FROM 
        player_season_stats
)

SELECT
    season,
    player_id,
    player_name,
    total_points,
    games_played,
    points_per_game
FROM 
    ranked_players
WHERE 
    scoring_rank = 1
  );
[0m04:30:07.973495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:10.153168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.180 seconds
[0m04:30:10.176800 [debug] [Thread-1 (]: On model.nba.mart_season_scoring_leaders: Close
[0m04:30:10.618692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f161af01-2e17-422d-a20f-3d099a08b29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e62a350>]}
[0m04:30:10.619710 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_parker.mart_season_scoring_leaders ........ [[32mSUCCESS 1[0m in 2.70s]
[0m04:30:10.621703 [debug] [Thread-1 (]: Finished running node model.nba.mart_season_scoring_leaders
[0m04:30:10.624502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:10.625744 [debug] [MainThread]: Connection 'list_NBA_staging' was properly closed.
[0m04:30:10.627644 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m04:30:10.629540 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m04:30:10.631370 [debug] [MainThread]: Connection 'model.nba.mart_season_scoring_leaders' was properly closed.
[0m04:30:10.633328 [info ] [MainThread]: 
[0m04:30:10.635065 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m04:30:10.637261 [debug] [MainThread]: Command end result
[0m04:30:10.687831 [info ] [MainThread]: 
[0m04:30:10.688585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:10.690463 [info ] [MainThread]: 
[0m04:30:10.692317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:30:10.694956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.193103, "process_user_time": 3.766158, "process_kernel_time": 0.349643, "process_mem_max_rss": "239352", "process_out_blocks": "4232", "process_in_blocks": "0"}
[0m04:30:10.696440 [debug] [MainThread]: Command `dbt run` succeeded at 04:30:10.696314 after 8.19 seconds
[0m04:30:10.698171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab43ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e17050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73ab910>]}
[0m04:30:10.699960 [debug] [MainThread]: Flushing usage events
