[0m01:17:27.343683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1cee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b216e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b387d90>]}


============================== 01:17:27.347060 | 8cd3b9f6-b2c9-4661-b2ea-87246d2420c5 ==============================
[0m01:17:27.347060 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:17:27.349012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_common_player_info', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:17:28.379644 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:17:28.380464 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:17:28.382783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8923be10>]}
[0m01:17:28.455068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b593d90>]}
[0m01:17:28.456208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:17:28.594900 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:17:28.766253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:28.766891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:28.769071 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:17:28.816139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893eb890>]}
[0m01:17:28.938291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831c2fd0>]}
[0m01:17:28.939112 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 460 macros
[0m01:17:28.940971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893c0c50>]}
[0m01:17:28.944170 [info ] [MainThread]: 
[0m01:17:28.945071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:28.947525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:17:28.964808 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:17:28.965454 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:17:28.967489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:29.515655 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m01:17:29.517650 [debug] [ThreadPool]: On list_NBA: Close
[0m01:17:29.698361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:17:29.699269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:17:29.700957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:17:29.709988 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:17:29.712649 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:17:29.715070 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:17:29.715676 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:17:29.717596 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:17:29.719430 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:17:29.721281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:29.723061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:29.724931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:30.167232 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.442 seconds
[0m01:17:30.169422 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:17:30.324011 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m01:17:30.326650 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:17:30.327923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.605 seconds
[0m01:17:30.330838 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:17:30.532506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f088d0>]}
[0m01:17:30.533364 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:17:30.536288 [info ] [MainThread]: 
[0m01:17:30.544327 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:17:30.545210 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_common_player_info ..................... [RUN]
[0m01:17:30.547383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_common_player_info)
[0m01:17:30.549196 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:17:30.558764 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:17:30.574872 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:17:30.609123 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:17:30.624990 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:17:30.625748 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:17:30.627586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:31.256079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m01:17:31.281492 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:17:31.469859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd3b9f6-b2c9-4661-b2ea-87246d2420c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83183e10>]}
[0m01:17:31.481443 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_common_player_info ................ [[32mSUCCESS 1[0m in 0.92s]
[0m01:17:31.482412 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:17:31.486128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:31.488022 [debug] [MainThread]: Connection 'model.nba.stg_common_player_info' was properly closed.
[0m01:17:31.489902 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:17:31.492381 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m01:17:31.494854 [info ] [MainThread]: 
[0m01:17:31.497357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m01:17:31.500316 [debug] [MainThread]: Command end result
[0m01:17:31.551684 [info ] [MainThread]: 
[0m01:17:31.552486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:31.554268 [info ] [MainThread]: 
[0m01:17:31.556247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:17:31.558763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.279582, "process_user_time": 3.213458, "process_kernel_time": 0.301261, "process_mem_max_rss": "232192", "process_in_blocks": "1112", "process_out_blocks": "2904"}
[0m01:17:31.560893 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:31.560738 after 4.28 seconds
[0m01:17:31.562673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc38cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1a7810>]}
[0m01:17:31.564525 [debug] [MainThread]: Flushing usage events
[0m01:17:39.039035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d54dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d4a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f076d0>]}


============================== 01:17:39.042313 | 5baefe50-b396-4bf3-975b-91ec22ef2664 ==============================
[0m01:17:39.042313 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:17:39.044466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m01:17:40.075875 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:17:40.076714 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:17:40.079050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa219e050>]}
[0m01:17:40.151343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb910bd50>]}
[0m01:17:40.152469 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:17:40.289437 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:17:40.432180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:40.432818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:40.435146 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:17:40.482773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dee310>]}
[0m01:17:40.619068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0854f50>]}
[0m01:17:40.619942 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 460 macros
[0m01:17:40.621799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d4be10>]}
[0m01:17:40.625399 [info ] [MainThread]: 
[0m01:17:40.626257 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:17:40.633242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:17:40.634103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:17:40.642168 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:17:40.653161 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:17:40.655974 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:17:40.658546 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:17:40.659182 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:17:40.664941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:40.663001 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:17:40.661095 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:17:40.670259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:40.671651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:41.192347 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.527 seconds
[0m01:17:41.194827 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:17:41.287270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.617 seconds
[0m01:17:41.289451 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:17:41.416045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.744 seconds
[0m01:17:41.418326 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:17:41.586593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baefe50-b396-4bf3-975b-91ec22ef2664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21dd7d0>]}
[0m01:17:41.587458 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:17:41.589289 [info ] [MainThread]: 
[0m01:17:41.593851 [debug] [Thread-1 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m01:17:41.594445 [debug] [Thread-2 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.595010 [debug] [Thread-3 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.595658 [info ] [Thread-1 (]: 1 of 3 START test not_null_full_name ........................................... [RUN]
[0m01:17:41.597596 [info ] [Thread-2 (]: 2 of 3 START test not_null_player_id ........................................... [RUN]
[0m01:17:41.599461 [info ] [Thread-3 (]: 3 of 3 START test unique_player_id ............................................. [RUN]
[0m01:17:41.602134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now test.nba.not_null_full_name.26df58b172)
[0m01:17:41.603223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now test.nba.not_null_player_id.2d6184285e)
[0m01:17:41.605068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now test.nba.unique_player_id.489f92cfc7)
[0m01:17:41.606906 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m01:17:41.608647 [debug] [Thread-2 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.610493 [debug] [Thread-3 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.628399 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.632990 [debug] [Thread-2 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.639868 [debug] [Thread-3 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.647042 [debug] [Thread-1 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m01:17:41.653015 [debug] [Thread-2 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m01:17:41.670400 [debug] [Thread-1 (]: Writing runtime sql for node "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.673438 [debug] [Thread-2 (]: Writing runtime sql for node "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.674046 [debug] [Thread-3 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m01:17:41.680864 [debug] [Thread-3 (]: Writing runtime sql for node "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.683946 [debug] [Thread-2 (]: Using snowflake connection "test.nba.not_null_player_id.2d6184285e"
[0m01:17:41.685111 [debug] [Thread-1 (]: Using snowflake connection "test.nba.not_null_full_name.26df58b172"
[0m01:17:41.686158 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_player_id.2d6184285e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select player_id
from NBA.staging.stg_common_player_info
where player_id is null



      
    ) dbt_internal_test
[0m01:17:41.687968 [debug] [Thread-3 (]: Using snowflake connection "test.nba.unique_player_id.489f92cfc7"
[0m01:17:41.688603 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.not_null_full_name.26df58b172"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select full_name
from NBA.staging.stg_common_player_info
where full_name is null



      
    ) dbt_internal_test
[0m01:17:41.690449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:17:41.692350 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "test.nba.unique_player_id.489f92cfc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    player_id as unique_field,
    count(*) as n_records

from NBA.staging.stg_common_player_info
where player_id is not null
group by player_id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:17:41.694209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:41.698251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:17:42.290059 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m01:17:42.300558 [debug] [Thread-2 (]: On test.nba.not_null_player_id.2d6184285e: Close
[0m01:17:42.314663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:17:42.317222 [debug] [Thread-1 (]: On test.nba.not_null_full_name.26df58b172: Close
[0m01:17:42.324801 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m01:17:42.326965 [debug] [Thread-3 (]: On test.nba.unique_player_id.489f92cfc7: Close
[0m01:17:42.483004 [info ] [Thread-2 (]: 2 of 3 PASS not_null_player_id ................................................. [[32mPASS[0m in 0.88s]
[0m01:17:42.483964 [debug] [Thread-2 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m01:17:42.516375 [info ] [Thread-3 (]: 3 of 3 PASS unique_player_id ................................................... [[32mPASS[0m in 0.91s]
[0m01:17:42.517399 [debug] [Thread-3 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m01:17:42.518487 [info ] [Thread-1 (]: 1 of 3 PASS not_null_full_name ................................................. [[32mPASS[0m in 0.92s]
[0m01:17:42.521323 [debug] [Thread-1 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m01:17:42.524223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:42.524812 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m01:17:42.526691 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m01:17:42.528561 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m01:17:42.530498 [info ] [MainThread]: 
[0m01:17:42.532343 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m01:17:42.534754 [debug] [MainThread]: Command end result
[0m01:17:42.661155 [info ] [MainThread]: 
[0m01:17:42.661905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:42.663829 [info ] [MainThread]: 
[0m01:17:42.665723 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:17:42.668334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6889415, "process_user_time": 3.207024, "process_kernel_time": 0.430943, "process_mem_max_rss": "232880", "process_in_blocks": "112", "process_out_blocks": "3112"}
[0m01:17:42.669830 [debug] [MainThread]: Command `dbt test` succeeded at 01:17:42.669697 after 3.69 seconds
[0m01:17:42.671694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb795c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb796610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb797b50>]}
[0m01:17:42.673595 [debug] [MainThread]: Flushing usage events
[0m01:22:37.532309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b33110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b7bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b7bf90>]}


============================== 01:22:37.535662 | 6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0 ==============================
[0m01:22:37.535662 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:37.537840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select player_game_logs_agg_example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:38.584383 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:22:38.585199 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:22:38.587474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bb3c50>]}
[0m01:22:38.659409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d81c10>]}
[0m01:22:38.660526 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:38.796365 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:22:38.944888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:22:38.945867 [debug] [MainThread]: Partial parsing: updated file: nba://models/intermediate/player_game_logs_agg_example.sql
[0m01:22:39.255779 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:22:39.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f9f4b90>]}
[0m01:22:39.454524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fa89310>]}
[0m01:22:39.455374 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:22:39.457211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee8e350>]}
[0m01:22:39.460220 [info ] [MainThread]: 
[0m01:22:39.461743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:22:39.464130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:22:39.478883 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:22:39.479532 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:22:39.481553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.205520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.724 seconds
[0m01:22:40.207516 [debug] [ThreadPool]: On list_NBA: Close
[0m01:22:40.386973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:22:40.387893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:22:40.401234 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:22:40.398476 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:22:40.401817 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:22:40.405877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.404001 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:22:40.388714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:22:40.410166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:40.413904 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:22:40.416697 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:22:40.418571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:40.973958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.555 seconds
[0m01:22:40.976418 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:22:41.000360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.590 seconds
[0m01:22:41.002438 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:22:41.011372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.605 seconds
[0m01:22:41.013483 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:22:41.187634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f895810>]}
[0m01:22:41.188500 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:22:41.190285 [info ] [MainThread]: 
[0m01:22:41.194968 [debug] [Thread-1 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:22:41.195789 [info ] [Thread-1 (]: 1 of 1 START sql view model intermediate.player_game_logs_agg_example .......... [RUN]
[0m01:22:41.197690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.player_game_logs_agg_example)
[0m01:22:41.199456 [debug] [Thread-1 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:22:41.211668 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:22:41.218435 [debug] [Thread-1 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:22:41.248463 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:22:41.258042 [debug] [Thread-1 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:22:41.258857 [debug] [Thread-1 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:22:41.260915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:41.903641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m01:22:41.928026 [debug] [Thread-1 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:22:42.088885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6014eb66-35f3-4bdb-b8c1-46f4ece3e8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89150f90>]}
[0m01:22:42.089917 [info ] [Thread-1 (]: 1 of 1 OK created sql view model intermediate.player_game_logs_agg_example ..... [[32mSUCCESS 1[0m in 0.89s]
[0m01:22:42.092047 [debug] [Thread-1 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:22:42.094901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:42.096225 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:22:42.098073 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:22:42.099970 [debug] [MainThread]: Connection 'list_NBA_staging' was properly closed.
[0m01:22:42.101892 [info ] [MainThread]: 
[0m01:22:42.103687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m01:22:42.105850 [debug] [MainThread]: Command end result
[0m01:22:42.155234 [info ] [MainThread]: 
[0m01:22:42.156030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:42.157816 [info ] [MainThread]: 
[0m01:22:42.159677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:22:42.162256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6920414, "process_user_time": 3.535202, "process_kernel_time": 0.3437, "process_mem_max_rss": "235044", "process_in_blocks": "1112", "process_out_blocks": "4040"}
[0m01:22:42.163728 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:42.163602 after 4.69 seconds
[0m01:22:42.165505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a57f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a57cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b0b6d0>]}
[0m01:22:42.167293 [debug] [MainThread]: Flushing usage events
[0m01:22:58.994751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9150910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9152550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9151650>]}


============================== 01:22:58.998055 | 0b65e6de-cbc0-4470-a509-550b98ec07ad ==============================
[0m01:22:58.998055 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:22:59.000291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_player_points_per_playoff_season_example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:00.041735 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:23:00.042577 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:23:00.044799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931c3350>]}
[0m01:23:00.118520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3b5d50>]}
[0m01:23:00.119669 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:00.254934 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:00.405374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:00.406023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:00.408246 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:23:00.455650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9188d50>]}
[0m01:23:00.576999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fd2f10>]}
[0m01:23:00.577840 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:23:00.579645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9120c3d0>]}
[0m01:23:00.582586 [info ] [MainThread]: 
[0m01:23:00.584123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:00.586445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:00.603756 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:00.604409 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:00.606457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.159729 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.553 seconds
[0m01:23:01.161784 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:01.319107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:23:01.320081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:23:01.321695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:23:01.336581 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:23:01.333727 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:23:01.339203 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:23:01.341075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.337215 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:23:01.330788 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:23:01.348900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:01.350930 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:23:01.355023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:01.864275 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.523 seconds
[0m01:23:01.866616 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:23:01.880861 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.532 seconds
[0m01:23:01.881982 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.527 seconds
[0m01:23:01.883927 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:23:01.886782 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:23:02.099689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92553d0>]}
[0m01:23:02.100547 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:23:02.102431 [info ] [MainThread]: 
[0m01:23:02.107154 [debug] [Thread-1 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.108000 [info ] [Thread-1 (]: 1 of 1 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:23:02.109852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:23:02.111696 [debug] [Thread-1 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.121623 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.128432 [debug] [Thread-1 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:02.161369 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.169034 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:02.169756 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:23:02.171573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:03.711918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.540 seconds
[0m01:23:03.745947 [debug] [Thread-1 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:23:03.925049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b65e6de-cbc0-4470-a509-550b98ec07ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fdf2d0>]}
[0m01:23:03.926069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.81s]
[0m01:23:03.928259 [debug] [Thread-1 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:03.931500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:03.932029 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:23:03.934453 [debug] [MainThread]: Connection 'list_NBA_warehouse' was properly closed.
[0m01:23:03.952009 [debug] [MainThread]: Connection 'list_NBA_intermediate' was properly closed.
[0m01:23:03.954718 [info ] [MainThread]: 
[0m01:23:03.957181 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m01:23:03.960002 [debug] [MainThread]: Command end result
[0m01:23:04.010175 [info ] [MainThread]: 
[0m01:23:04.011650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:04.014220 [info ] [MainThread]: 
[0m01:23:04.016768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:23:04.019948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.085011, "process_user_time": 3.100673, "process_kernel_time": 0.38883, "process_mem_max_rss": "231340", "process_in_blocks": "1112", "process_out_blocks": "2912"}
[0m01:23:04.022827 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:04.022654 after 5.09 seconds
[0m01:23:04.025410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa919c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb7a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91368d0>]}
[0m01:23:04.027985 [debug] [MainThread]: Flushing usage events
[0m01:23:10.397575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07ee6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0853ad0>]}


============================== 01:23:10.400963 | e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed ==============================
[0m01:23:10.400963 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:23:10.403105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:23:11.462772 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:23:11.463616 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:23:11.465894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a81b9d0>]}
[0m01:23:11.537980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a05c10>]}
[0m01:23:11.539073 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:11.676341 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:11.822011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:11.822684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:11.824802 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:23:11.872951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8883c4d0>]}
[0m01:23:12.004481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887d3590>]}
[0m01:23:12.005784 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 461 macros
[0m01:23:12.007551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885d8bd0>]}
[0m01:23:12.011557 [info ] [MainThread]: 
[0m01:23:12.013247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:12.020984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.021876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.022686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:23:12.039556 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.042312 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.045597 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:23:12.046258 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.048201 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.050052 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:23:12.051857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.053706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.055547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:12.583456 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.528 seconds
[0m01:23:12.585444 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.625208 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.573 seconds
[0m01:23:12.627178 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.629574 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.576 seconds
[0m01:23:12.631806 [debug] [ThreadPool]: On list_NBA: Close
[0m01:23:12.835454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:23:12.846852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:23:12.847842 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:23:12.848704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m01:23:12.851506 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:23:12.852123 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:23:12.856062 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:23:12.856691 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:23:12.858519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:12.860388 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:23:12.862322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:12.866395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:13.275238 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.417 seconds
[0m01:23:13.277531 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:23:13.333846 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.467 seconds
[0m01:23:13.336089 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:23:13.398220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.536 seconds
[0m01:23:13.400657 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:23:13.563205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07dd950>]}
[0m01:23:13.564096 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:23:13.565865 [info ] [MainThread]: 
[0m01:23:13.571131 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:23:13.571787 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:23:13.576990 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m01:23:13.572992 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:23:13.573794 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:23:13.583702 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m01:23:13.575237 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m01:23:13.572382 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:23:13.579461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:23:13.581433 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m01:23:13.574442 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:23:13.586047 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:23:13.588029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m01:23:13.590357 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m01:23:13.604409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_player_game_logs)
[0m01:23:13.606201 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:23:13.598160 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m01:23:13.599853 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:23:13.602408 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:23:13.624795 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:23:13.595433 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:23:13.627480 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:23:13.616669 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:23:13.621313 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:23:13.593049 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:23:13.615787 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:23:13.632217 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:23:13.632841 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:23:13.633435 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:23:13.640069 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:23:13.640905 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:23:13.649645 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:23:13.674292 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:23:13.685030 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:23:13.687128 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:23:13.691544 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m01:23:13.695295 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m01:23:13.695981 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:23:13.717555 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m01:23:13.707964 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:23:13.721036 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.713970 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m01:23:13.726504 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.720166 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m01:23:13.708846 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m01:23:13.723861 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m01:23:13.724531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:13.706039 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:23:13.728290 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:23:13.730206 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:23:13.733918 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.738279 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m01:23:13.742527 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m01:23:13.745526 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:23:13.747451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:23:13.749355 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:23:13.757476 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m01:23:13.760380 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:23:13.758417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:23:13.762184 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:23:14.347437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m01:23:14.445402 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m01:23:14.451705 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m01:23:14.452413 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:23:14.454603 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m01:23:14.455555 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m01:23:14.457605 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m01:23:14.465055 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m01:23:14.467407 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m01:23:14.472858 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m01:23:14.527868 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m01:23:14.530187 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m01:23:14.623708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883933d0>]}
[0m01:23:14.624713 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.03s]
[0m01:23:14.627055 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:23:14.629853 [debug] [Thread-8 (]: Began running node model.nba.fct_players_by_college_example
[0m01:23:14.631047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864bf710>]}
[0m01:23:14.632377 [info ] [Thread-8 (]: 7 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m01:23:14.636641 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_players_by_college_example'
[0m01:23:14.634863 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.03s]
[0m01:23:14.633899 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8641f890>]}
[0m01:23:14.637621 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b4a50>]}
[0m01:23:14.638317 [debug] [Thread-8 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:23:14.640375 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:23:14.642304 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.02s]
[0m01:23:14.651529 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:23:14.648736 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:23:14.649818 [debug] [Thread-1 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.650387 [debug] [Thread-7 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:23:14.644161 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.06s]
[0m01:23:14.657130 [info ] [Thread-1 (]: 8 of 12 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m01:23:14.664026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now model.nba.fct_playoff_games_by_player_example)
[0m01:23:14.660550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa26fc410>]}
[0m01:23:14.659593 [info ] [Thread-7 (]: 9 of 12 START sql view model intermediate.player_game_logs_agg_example ......... [RUN]
[0m01:23:14.669692 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.player_game_logs_agg_example'
[0m01:23:14.658539 [debug] [Thread-8 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:23:14.665790 [debug] [Thread-1 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.700027 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.662222 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:23:14.671366 [debug] [Thread-7 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:23:14.711087 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:23:14.667918 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.07s]
[0m01:23:14.714118 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:23:14.696170 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m01:23:14.704787 [debug] [Thread-1 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:23:14.716804 [debug] [Thread-7 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:23:14.727822 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:23:14.723999 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m01:23:14.722854 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.729716 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a948150>]}
[0m01:23:14.730799 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m01:23:14.738960 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:23:14.737452 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.14s]
[0m01:23:14.736315 [debug] [Thread-7 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:23:14.746595 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:23:14.744885 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:23:14.741783 [debug] [Thread-1 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m01:23:14.748344 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:23:14.750533 [debug] [Thread-3 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.752029 [debug] [Thread-1 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m01:23:14.756182 [info ] [Thread-3 (]: 10 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m01:23:14.757676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:14.759587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_playoff_appearances_by_team_example)
[0m01:23:14.763643 [debug] [Thread-3 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.768864 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.773653 [debug] [Thread-3 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:14.776904 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.783304 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m01:23:14.784045 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m01:23:14.785845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:23:15.439493 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m01:23:15.441983 [debug] [Thread-7 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:23:15.633211 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a7490>]}
[0m01:23:15.634175 [info ] [Thread-7 (]: 9 of 12 OK created sql view model intermediate.player_game_logs_agg_example .... [[32mSUCCESS 1[0m in 0.96s]
[0m01:23:15.637244 [debug] [Thread-7 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:23:15.640125 [debug] [Thread-2 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.640855 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.642212 [info ] [Thread-2 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:23:15.647701 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:23:15.645104 [info ] [Thread-4 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m01:23:15.650328 [debug] [Thread-2 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.658359 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.652420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_regular_season_example)
[0m01:23:15.663168 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.668528 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.669116 [debug] [Thread-2 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:15.675048 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.676328 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:23:15.680507 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.684226 [debug] [Thread-2 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:23:15.685069 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:23:15.686516 [debug] [Thread-4 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m01:23:15.689362 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m01:23:15.687229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:23:15.691428 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:23:15.947165 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.208 seconds
[0m01:23:15.949433 [debug] [Thread-8 (]: On model.nba.fct_players_by_college_example: Close
[0m01:23:16.086644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m01:23:16.088919 [debug] [Thread-1 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m01:23:16.153075 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8833fed0>]}
[0m01:23:16.154455 [info ] [Thread-8 (]: 7 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 1.52s]
[0m01:23:16.157726 [debug] [Thread-8 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:23:16.184863 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.399 seconds
[0m01:23:16.187410 [debug] [Thread-3 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m01:23:16.255633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa153d4d0>]}
[0m01:23:16.256593 [info ] [Thread-1 (]: 8 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.59s]
[0m01:23:16.259724 [debug] [Thread-1 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:23:16.357466 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1567710>]}
[0m01:23:16.358463 [info ] [Thread-3 (]: 10 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.60s]
[0m01:23:16.360804 [debug] [Thread-3 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:23:16.879711 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.192 seconds
[0m01:23:16.882357 [debug] [Thread-2 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:23:17.051381 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07a7310>]}
[0m01:23:17.052389 [info ] [Thread-2 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.40s]
[0m01:23:17.055640 [debug] [Thread-2 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:23:17.066480 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m01:23:17.068715 [debug] [Thread-4 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m01:23:17.238064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e96d8af8-b8e9-492c-a7ec-fe1cee2c08ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff883b6610>]}
[0m01:23:17.239019 [info ] [Thread-4 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.59s]
[0m01:23:17.241086 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:23:17.244364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:17.245633 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:23:17.247473 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:23:17.249309 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:23:17.251194 [debug] [MainThread]: Connection 'model.nba.stg_team_stats_by_season' was properly closed.
[0m01:23:17.253577 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:23:17.255495 [debug] [MainThread]: Connection 'model.nba.stg_teams' was properly closed.
[0m01:23:17.257540 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:23:17.260083 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:23:17.262650 [info ] [MainThread]: 
[0m01:23:17.265137 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m01:23:17.269103 [debug] [MainThread]: Command end result
[0m01:23:17.321028 [info ] [MainThread]: 
[0m01:23:17.321814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:17.323785 [info ] [MainThread]: 
[0m01:23:17.326078 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:23:17.328612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.990214, "process_user_time": 3.833849, "process_kernel_time": 0.444224, "process_mem_max_rss": "238392", "process_out_blocks": "4696", "process_in_blocks": "0"}
[0m01:23:17.330189 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:17.330035 after 6.99 seconds
[0m01:23:17.332182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c8fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa31eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15aefd0>]}
[0m01:23:17.334078 [debug] [MainThread]: Flushing usage events
[0m01:25:16.855527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fe9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8011610>]}


============================== 01:25:16.858930 | e77697ba-4586-419e-a8fb-a358d36099d5 ==============================
[0m01:25:16.858930 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:16.861091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls --select exposure:*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:25:17.931101 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:25:17.931923 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:25:17.934131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0077e50>]}
[0m01:25:18.008211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9281d10>]}
[0m01:25:18.009370 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:18.147890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:18.313644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:18.314288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:18.316511 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:25:18.369525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd87050>]}
[0m01:25:18.517479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e1d150>]}
[0m01:25:18.518332 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:25:18.520108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e77697ba-4586-419e-a8fb-a358d36099d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0011090>]}
[0m01:25:18.523133 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.7292532, "process_user_time": 2.758059, "process_kernel_time": 0.429697, "process_mem_max_rss": "221756", "process_in_blocks": "1144", "process_out_blocks": "1344"}
[0m01:25:18.524632 [debug] [MainThread]: Command `dbt ls` succeeded at 01:25:18.524504 after 1.73 seconds
[0m01:25:18.526354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa4a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaa4ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fce850>]}
[0m01:25:18.528187 [debug] [MainThread]: Flushing usage events
[0m01:25:36.024246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0442790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb048bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb046a6d0>]}


============================== 01:25:36.027603 | 4b5a853c-70a3-411f-9164-8f3d4eac4aac ==============================
[0m01:25:36.027603 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:36.029664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m01:25:37.056800 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:25:37.057618 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:25:37.059755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986c2790>]}
[0m01:25:37.131836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16d9d90>]}
[0m01:25:37.132972 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:25:37.270043 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:37.421955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:37.422588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:37.424888 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:25:37.477083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9845e990>]}
[0m01:25:37.501108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98107e50>]}
[0m01:25:37.501928 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:25:37.503728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982d3290>]}
[0m01:25:37.507481 [info ] [MainThread]: 
[0m01:25:37.508355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:37.515033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_intermediate'
[0m01:25:37.516021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_warehouse'
[0m01:25:37.516820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA_staging'
[0m01:25:37.539333 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:25:37.541947 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:25:37.544484 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:25:37.545122 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:25:37.547007 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:25:37.548847 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:25:37.550747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:37.552570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:37.554347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:38.094250 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m01:25:38.096475 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:25:38.100990 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m01:25:38.103201 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:25:38.169583 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m01:25:38.171881 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:25:38.355273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5a853c-70a3-411f-9164-8f3d4eac4aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985282d0>]}
[0m01:25:38.356127 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:25:38.357983 [info ] [MainThread]: 
[0m01:25:38.362676 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:25:38.363274 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:25:38.363850 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:25:38.365702 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:25:38.366272 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:25:38.366944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_common_player_info)
[0m01:25:38.367940 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:25:38.368628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:25:38.370664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_player_game_logs)
[0m01:25:38.372699 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:25:38.374588 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:25:38.376294 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:25:38.378249 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:25:38.379991 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:25:38.381788 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:25:38.383610 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:25:38.385467 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:25:38.394575 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:25:38.395262 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:25:38.400174 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:25:38.403634 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:25:38.407114 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:25:38.410472 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:25:38.415838 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:25:38.418476 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:25:38.420994 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:25:38.423728 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:25:38.426152 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:25:38.434068 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:25:38.428541 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:25:38.429113 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:25:38.430424 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:25:38.432268 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:25:38.427779 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:25:38.435848 [debug] [Thread-8 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.437675 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:25:38.439477 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:25:38.443113 [debug] [Thread-5 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:25:38.444937 [debug] [Thread-2 (]: Began running node model.nba.fct_players_by_college_example
[0m01:25:38.445481 [debug] [Thread-3 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.446051 [debug] [Thread-7 (]: Began running node test.nba.not_null_full_name.26df58b172
[0m01:25:38.446613 [debug] [Thread-1 (]: Began running node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.447379 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_appearances_by_team_example'
[0m01:25:38.449066 [debug] [Thread-6 (]: Began running node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.452800 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.player_game_logs_agg_example)
[0m01:25:38.454617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nba.stg_games, now model.nba.fct_players_by_college_example)
[0m01:25:38.467477 [debug] [Thread-2 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:25:38.458678 [debug] [Thread-7 (]: Acquiring new snowflake connection 'test.nba.not_null_full_name.26df58b172'
[0m01:25:38.472815 [debug] [Thread-7 (]: Began compiling node test.nba.not_null_full_name.26df58b172
[0m01:25:38.461961 [debug] [Thread-8 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.463834 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now test.nba.unique_player_id.489f92cfc7)
[0m01:25:38.465604 [debug] [Thread-5 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:25:38.456504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_playoff_games_by_player_example)
[0m01:25:38.472136 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:25:38.460131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nba.stg_common_player_info, now test.nba.not_null_player_id.2d6184285e)
[0m01:25:38.503008 [debug] [Thread-1 (]: Began compiling node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.490848 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:25:38.491606 [debug] [Thread-6 (]: Began compiling node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.498455 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:25:38.499188 [debug] [Thread-3 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.487102 [debug] [Thread-7 (]: Writing injected SQL for node "test.nba.not_null_full_name.26df58b172"
[0m01:25:38.510643 [debug] [Thread-2 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:25:38.511394 [debug] [Thread-1 (]: Writing injected SQL for node "test.nba.not_null_player_id.2d6184285e"
[0m01:25:38.523058 [debug] [Thread-6 (]: Writing injected SQL for node "test.nba.unique_player_id.489f92cfc7"
[0m01:25:38.525814 [debug] [Thread-8 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.529752 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:25:38.530379 [debug] [Thread-5 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:25:38.544385 [debug] [Thread-5 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:25:38.535871 [debug] [Thread-7 (]: Began executing node test.nba.not_null_full_name.26df58b172
[0m01:25:38.538580 [debug] [Thread-1 (]: Began executing node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.539684 [debug] [Thread-8 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:25:38.541133 [debug] [Thread-6 (]: Began executing node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.533432 [debug] [Thread-2 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:25:38.546105 [debug] [Thread-3 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.547223 [debug] [Thread-4 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.547825 [debug] [Thread-5 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.549081 [debug] [Thread-7 (]: Finished running node test.nba.not_null_full_name.26df58b172
[0m01:25:38.550952 [debug] [Thread-1 (]: Finished running node test.nba.not_null_player_id.2d6184285e
[0m01:25:38.554571 [debug] [Thread-6 (]: Finished running node test.nba.unique_player_id.489f92cfc7
[0m01:25:38.558252 [debug] [Thread-3 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:25:38.559770 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.fct_player_points_per_playoff_season_example)
[0m01:25:38.561598 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.player_game_logs_agg_example, now model.nba.fct_player_points_per_regular_season_example)
[0m01:25:38.570877 [debug] [Thread-4 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.572611 [debug] [Thread-5 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.577466 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:25:38.581318 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:25:38.586866 [debug] [Thread-4 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.587921 [debug] [Thread-4 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:25:38.588429 [debug] [Thread-5 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.591616 [debug] [Thread-5 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:25:38.599806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:38.600428 [debug] [MainThread]: Connection 'test.nba.not_null_player_id.2d6184285e' was properly closed.
[0m01:25:38.602421 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:25:38.604248 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:25:38.606166 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:25:38.607998 [debug] [MainThread]: Connection 'test.nba.unique_player_id.489f92cfc7' was properly closed.
[0m01:25:38.609838 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:25:38.611696 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:25:38.613522 [debug] [MainThread]: Connection 'test.nba.not_null_full_name.26df58b172' was properly closed.
[0m01:25:38.617057 [debug] [MainThread]: Command end result
[0m01:25:38.754641 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:25:38.755243 [info ] [MainThread]: Building catalog
[0m01:25:38.769008 [debug] [ThreadPool]: Acquiring new snowflake connection 'NBA.information_schema'
[0m01:25:38.863234 [debug] [ThreadPool]: Using snowflake connection "NBA.information_schema"
[0m01:25:38.864301 [debug] [ThreadPool]: On NBA.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "NBA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from NBA.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from NBA.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_common_player_info' and upper("table_name") = upper('stg_common_player_info')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_regular_season_example' and upper("table_name") = upper('fct_player_points_per_regular_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_SPEND_BY_SEASON' and upper("table_name") = upper('TEAM_SPEND_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_games_by_player_example' and upper("table_name") = upper('fct_playoff_games_by_player_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_player_game_logs' and upper("table_name") = upper('stg_player_game_logs')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_player_points_per_playoff_season_example' and upper("table_name") = upper('fct_player_points_per_playoff_season_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_teams' and upper("table_name") = upper('stg_teams')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'GAMES' and upper("table_name") = upper('GAMES')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_GAME_LOGS' and upper("table_name") = upper('PLAYER_GAME_LOGS')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_games' and upper("table_name") = upper('stg_games')

                )
             or 
                (
                    
    "table_schema" ilike 'intermediate' and upper("table_schema") = upper('intermediate')

                    and 
    "table_name" ilike 'player_game_logs_agg_example' and upper("table_name") = upper('player_game_logs_agg_example')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_spend_by_season' and upper("table_name") = upper('stg_team_spend_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'PLAYER_SALARIES_BY_SEASON' and upper("table_name") = upper('PLAYER_SALARIES_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_playoff_appearances_by_team_example' and upper("table_name") = upper('fct_playoff_appearances_by_team_example')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAMS' and upper("table_name") = upper('TEAMS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'TEAM_STATS_BY_SEASON' and upper("table_name") = upper('TEAM_STATS_BY_SEASON')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'COMMON_PLAYER_INFO' and upper("table_name") = upper('COMMON_PLAYER_INFO')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_team_stats_by_season' and upper("table_name") = upper('stg_team_stats_by_season')

                )
             or 
                (
                    
    "table_schema" ilike 'warehouse' and upper("table_schema") = upper('warehouse')

                    and 
    "table_name" ilike 'fct_players_by_college_example' and upper("table_name") = upper('fct_players_by_college_example')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m01:25:38.865979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:45.483820 [debug] [ThreadPool]: SQL status: SUCCESS 340 in 6.618 seconds
[0m01:25:46.384288 [debug] [ThreadPool]: On NBA.information_schema: Close
[0m01:25:46.669162 [info ] [MainThread]: Catalog written to /workspaces/fxtn7c3oiwkalwzz/repository/nba/target/catalog.json
[0m01:25:46.671376 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.706602, "process_user_time": 3.723911, "process_kernel_time": 0.401499, "process_mem_max_rss": "239032", "process_in_blocks": "3056", "process_out_blocks": "8944"}
[0m01:25:46.672320 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:25:46.672193 after 10.71 seconds
[0m01:25:46.673886 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:25:46.675650 [debug] [MainThread]: Connection 'NBA.information_schema' was properly closed.
[0m01:25:46.677566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0929390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2eacbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ea21d0>]}
[0m01:25:46.679542 [debug] [MainThread]: Flushing usage events
[0m01:26:32.023992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e282e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e21b950>]}


============================== 01:26:32.027598 | f3b9192c-19d1-48ca-bd70-232da83e312c ==============================
[0m01:26:32.027598 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:26:32.030079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:33.068776 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:26:33.069602 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:26:33.071812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b9192c-19d1-48ca-bd70-232da83e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7689d290>]}
[0m01:26:33.144303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b9192c-19d1-48ca-bd70-232da83e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f499b10>]}
[0m01:26:33.167653 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m01:26:33.172073 [error] [MainThread]: Traceback (most recent call last):
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m01:26:33.173453 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.2146667, "process_user_time": 2.520541, "process_kernel_time": 0.191561, "process_mem_max_rss": "212596", "process_in_blocks": "72", "process_out_blocks": "3032", "command_success": false}
[0m01:26:33.175189 [debug] [MainThread]: Command `dbt docs serve` failed at 01:26:33.175037 after 1.22 seconds
[0m01:26:33.176899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e264c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff762e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e228a50>]}
[0m01:26:33.178771 [debug] [MainThread]: Flushing usage events
[0m01:27:17.393965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de97110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de978d0>]}


============================== 01:27:17.397247 | 967686e0-e51a-4b8d-8354-0e9f869e49cd ==============================
[0m01:27:17.397247 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:27:17.399291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:27:18.450841 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:27:18.451691 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:27:18.453924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967686e0-e51a-4b8d-8354-0e9f869e49cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ff8410>]}
[0m01:27:18.526625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967686e0-e51a-4b8d-8354-0e9f869e49cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e20fe10>]}
[0m01:27:32.947256 [error] [MainThread]: Encountered an error:

[0m01:27:32.950752 [error] [MainThread]: Traceback (most recent call last):
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/dbt/dbt-1.8-latest/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/pyenv/versions/3.11.8/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pyenv/versions/3.11.8/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m01:27:32.952220 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 15.621014, "process_user_time": 2.594236, "process_kernel_time": 0.180687, "process_mem_max_rss": "212332", "process_in_blocks": "40", "process_out_blocks": "3032", "command_success": false}
[0m01:27:32.953946 [debug] [MainThread]: Command `dbt docs serve` failed at 01:27:32.953810 after 15.62 seconds
[0m01:27:32.955642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de81490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de4f450>]}
[0m01:27:32.957458 [debug] [MainThread]: Flushing usage events
[0m01:28:02.669009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f32250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f7ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f7bb10>]}


============================== 01:28:02.672387 | 30b6fa2b-f359-4844-b519-a136ca768101 ==============================
[0m01:28:02.672387 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:28:02.674673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/fxtn7c3oiwkalwzz', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/fxtn7c3oiwkalwzz/repository/nba/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:03.708907 [info ] [MainThread]: Initializing dbt-loom=0.7.0
[0m01:28:03.709735 [info ] [MainThread]: dbt-loom: Patching ref protection methods to support dbt-loom dependencies.
[0m01:28:03.712089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af7fb90>]}
[0m01:28:03.785086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12f7e10>]}
[0m01:28:03.786212 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:28:03.924890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:28:04.083969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:04.084603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:04.086709 [info ] [MainThread]: dbt-loom: Injecting nodes
[0m01:28:04.138643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5ff10>]}
[0m01:28:04.270396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c90310>]}
[0m01:28:04.271288 [info ] [MainThread]: Found 12 models, 3 data tests, 7 sources, 1 exposure, 461 macros
[0m01:28:04.273047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c046d0>]}
[0m01:28:04.276681 [info ] [MainThread]: 
[0m01:28:04.277498 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:04.284213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.285050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.293080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NBA'
[0m01:28:04.301783 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.307689 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.306996 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.304560 [debug] [ThreadPool]: Using snowflake connection "list_NBA"
[0m01:28:04.310483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:04.312357 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.314226 [debug] [ThreadPool]: On list_NBA: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA"} */
show terse schemas in database NBA
    limit 10000
[0m01:28:04.319476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:04.320865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:05.016153 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.706 seconds
[0m01:28:05.018172 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.024527 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.705 seconds
[0m01:28:05.026331 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.258677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.938 seconds
[0m01:28:05.260621 [debug] [ThreadPool]: On list_NBA: Close
[0m01:28:05.755258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_warehouse)
[0m01:28:05.765738 [debug] [ThreadPool]: Using snowflake connection "list_NBA_warehouse"
[0m01:28:05.766477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_intermediate)
[0m01:28:05.772173 [debug] [ThreadPool]: Using snowflake connection "list_NBA_intermediate"
[0m01:28:05.767965 [debug] [ThreadPool]: On list_NBA_warehouse: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_warehouse"} */
show objects in NBA.warehouse limit 10000
[0m01:28:05.772769 [debug] [ThreadPool]: On list_NBA_intermediate: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_intermediate"} */
show objects in NBA.intermediate limit 10000
[0m01:28:05.767342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_NBA, now list_NBA_staging)
[0m01:28:05.774699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:05.776549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:05.780576 [debug] [ThreadPool]: Using snowflake connection "list_NBA_staging"
[0m01:28:05.785865 [debug] [ThreadPool]: On list_NBA_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "connection_name": "list_NBA_staging"} */
show objects in NBA.staging limit 10000
[0m01:28:05.787690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:06.359535 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.583 seconds
[0m01:28:06.361669 [debug] [ThreadPool]: On list_NBA_intermediate: Close
[0m01:28:06.880626 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.093 seconds
[0m01:28:06.882922 [debug] [ThreadPool]: On list_NBA_staging: Close
[0m01:28:06.959866 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.185 seconds
[0m01:28:06.962071 [debug] [ThreadPool]: On list_NBA_warehouse: Close
[0m01:28:07.214557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f6fcd0>]}
[0m01:28:07.215427 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:28:07.217262 [info ] [MainThread]: 
[0m01:28:07.221818 [debug] [Thread-1 (]: Began running node model.nba.stg_common_player_info
[0m01:28:07.222394 [debug] [Thread-2 (]: Began running node model.nba.stg_games
[0m01:28:07.222950 [debug] [Thread-3 (]: Began running node model.nba.stg_player_game_logs
[0m01:28:07.223527 [debug] [Thread-4 (]: Began running node model.nba.stg_team_spend_by_season
[0m01:28:07.225374 [debug] [Thread-5 (]: Began running node model.nba.stg_team_stats_by_season
[0m01:28:07.232482 [info ] [Thread-5 (]: 5 of 12 START sql view model staging.stg_team_stats_by_season .................. [RUN]
[0m01:28:07.224981 [info ] [Thread-1 (]: 1 of 12 START sql view model staging.stg_common_player_info .................... [RUN]
[0m01:28:07.226829 [info ] [Thread-2 (]: 2 of 12 START sql view model staging.stg_games ................................. [RUN]
[0m01:28:07.228664 [info ] [Thread-3 (]: 3 of 12 START sql view model staging.stg_player_game_logs ...................... [RUN]
[0m01:28:07.230555 [info ] [Thread-4 (]: 4 of 12 START sql view model staging.stg_team_spend_by_season .................. [RUN]
[0m01:28:07.225893 [debug] [Thread-6 (]: Began running node model.nba.stg_teams
[0m01:28:07.234358 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.nba.stg_team_stats_by_season'
[0m01:28:07.236099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_NBA_warehouse, now model.nba.stg_common_player_info)
[0m01:28:07.237994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_NBA_staging, now model.nba.stg_games)
[0m01:28:07.239812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_NBA_intermediate, now model.nba.stg_player_game_logs)
[0m01:28:07.241723 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.nba.stg_team_spend_by_season'
[0m01:28:07.243596 [info ] [Thread-6 (]: 6 of 12 START sql view model staging.stg_teams ................................. [RUN]
[0m01:28:07.245257 [debug] [Thread-5 (]: Began compiling node model.nba.stg_team_stats_by_season
[0m01:28:07.247110 [debug] [Thread-1 (]: Began compiling node model.nba.stg_common_player_info
[0m01:28:07.248961 [debug] [Thread-2 (]: Began compiling node model.nba.stg_games
[0m01:28:07.250835 [debug] [Thread-3 (]: Began compiling node model.nba.stg_player_game_logs
[0m01:28:07.252641 [debug] [Thread-4 (]: Began compiling node model.nba.stg_team_spend_by_season
[0m01:28:07.254704 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.nba.stg_teams'
[0m01:28:07.263741 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.stg_team_stats_by_season"
[0m01:28:07.267303 [debug] [Thread-1 (]: Writing injected SQL for node "model.nba.stg_common_player_info"
[0m01:28:07.272380 [debug] [Thread-2 (]: Writing injected SQL for node "model.nba.stg_games"
[0m01:28:07.275706 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.stg_player_game_logs"
[0m01:28:07.278965 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.stg_team_spend_by_season"
[0m01:28:07.279710 [debug] [Thread-6 (]: Began compiling node model.nba.stg_teams
[0m01:28:07.285509 [debug] [Thread-5 (]: Began executing node model.nba.stg_team_stats_by_season
[0m01:28:07.287306 [debug] [Thread-1 (]: Began executing node model.nba.stg_common_player_info
[0m01:28:07.289039 [debug] [Thread-2 (]: Began executing node model.nba.stg_games
[0m01:28:07.294543 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.stg_teams"
[0m01:28:07.295153 [debug] [Thread-3 (]: Began executing node model.nba.stg_player_game_logs
[0m01:28:07.303407 [debug] [Thread-4 (]: Began executing node model.nba.stg_team_spend_by_season
[0m01:28:07.329152 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.stg_team_stats_by_season"
[0m01:28:07.332522 [debug] [Thread-1 (]: Writing runtime sql for node "model.nba.stg_common_player_info"
[0m01:28:07.335885 [debug] [Thread-2 (]: Writing runtime sql for node "model.nba.stg_games"
[0m01:28:07.340942 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.stg_player_game_logs"
[0m01:28:07.345485 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.stg_team_spend_by_season"
[0m01:28:07.346098 [debug] [Thread-6 (]: Began executing node model.nba.stg_teams
[0m01:28:07.351933 [debug] [Thread-5 (]: Using snowflake connection "model.nba.stg_team_stats_by_season"
[0m01:28:07.354500 [debug] [Thread-1 (]: Using snowflake connection "model.nba.stg_common_player_info"
[0m01:28:07.356185 [debug] [Thread-2 (]: Using snowflake connection "model.nba.stg_games"
[0m01:28:07.360007 [debug] [Thread-3 (]: Using snowflake connection "model.nba.stg_player_game_logs"
[0m01:28:07.438433 [debug] [Thread-4 (]: Using snowflake connection "model.nba.stg_team_spend_by_season"
[0m01:28:07.439773 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.stg_teams"
[0m01:28:07.440466 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_stats_by_season"} */
create or replace   view NBA.staging.stg_team_stats_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_STATS_BY_SEASON
),
renamed AS (
    SELECT 
        team_id,
        team_city,
        team_name,
        year AS season,
        gp AS games_played,
        wins,
        losses,
        conf_rank AS conference_rank,
        div_rank AS division_rank,
        po_wins AS playoff_wins,
        po_losses AS playoff_losses,
        nba_finals_appearance,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg3m AS three_pointers_made,
        fg3a AS three_pointers_attempted,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        pf AS personal_fouls,
        stl AS steals,
        tov AS turnovers,
        blk AS blocks,
        pts AS points
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.442576 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_common_player_info"} */
create or replace   view NBA.staging.stg_common_player_info
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.COMMON_PLAYER_INFO
),

renamed AS (
    SELECT 
        person_id AS player_id,
        first_name,
        last_name,
        display_first_last AS full_name,
        display_last_comma_first,
        display_fi_last,
        player_slug,
        birthdate,
        school,
        country,
        last_affiliation,
        height,
        weight,
        season_exp AS seasons_played,
        jersey,
        position,
        rosterstatus AS roster_status,
        games_played_current_season_flag,
        team_id,
        team_name,
        team_abbreviation,
        team_code,
        team_city,
        playercode,
        from_year AS first_year_played,
        to_year AS last_year_played,
        dleague_flag AS g_league_has_played,
        nba_flag AS nba_has_played,
        games_played_flag AS games_played,
        draft_year,
        draft_round,
        draft_number,
        greatest_75_flag AS greatest_75_member
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.444438 [debug] [Thread-2 (]: On model.nba.stg_games: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_games"} */
create or replace   view NBA.staging.stg_games
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.GAMES
),


renamed AS (
    SELECT 
        season_id,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl,
        min AS game_duration_mins,
        pts AS points,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        stl AS steals,
        blk AS blocks,
        tov AS turnovers,
        pf AS personal_fouls,
        plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.446308 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_player_game_logs"} */
create or replace   view NBA.staging.stg_player_game_logs
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.PLAYER_GAME_LOGS
),


renamed AS (
    SELECT
        player_id,
        player_name,
        nickname,
        team_id,
        team_abbreviation,
        team_name,
        game_id,
        game_date,
        matchup,
        wl as win_loss,
        min AS mins_played,
        fgm AS field_goals_made,
        fga AS field_goals_attempted,
        fg_pct AS field_goal_pct,
        fg3m AS three_point_made,
        fg3a AS three_point_attempted,
        fg3_pct AS three_point_pct,
        ftm AS free_throws_made,
        fta AS free_throws_attempted,
        ft_pct AS free_throw_pct,
        oreb AS offensive_rebounds,
        dreb AS defensive_rebounds,
        reb AS total_rebounds,
        ast AS assists,
        tov AS turnovers,
        stl AS steals,
        blk AS blocks,
        pf AS personal_fouls,
        pts AS points,
        plus_minus AS plus_minus,
        season,
        game_type
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:28:07.448107 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_team_spend_by_season"} */
create or replace   view NBA.staging.stg_team_spend_by_season
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAM_SPEND_BY_SEASON
),

renamed as (
    SELECT 
        team_id,
        team_city,
        team_name,
        full_name,
        year as season,
        total_spend as team_payroll,
        active_payroll,
        dead_payroll,
        luxury_tax_payroll,
        luxury_tax_space,
        luxury_tax_bill
    FROM 
        source
)

SELECT
    *
FROM
    renamed
  );
[0m01:28:07.451801 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:28:07.453555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.454698 [debug] [Thread-6 (]: Using snowflake connection "model.nba.stg_teams"
[0m01:28:07.455945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:28:07.457878 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:28:07.459764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:28:07.465974 [debug] [Thread-6 (]: On model.nba.stg_teams: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.stg_teams"} */
create or replace   view NBA.staging.stg_teams
  
   as (
    WITH source AS (
    SELECT 
        *
    FROM 
        NBA.PUBLIC.TEAMS
),

renamed AS (
    SELECT
        id as team_id,
        full_name,
        abbreviation as team_name_abbreviation,
        nickname,
        city,
        state,
        year_founded
    FROM
        source
)

SELECT 
    *
FROM
    renamed
  );
[0m01:28:07.474068 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m01:28:08.085444 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m01:28:08.109878 [debug] [Thread-5 (]: On model.nba.stg_team_stats_by_season: Close
[0m01:28:08.121554 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m01:28:08.123812 [debug] [Thread-6 (]: On model.nba.stg_teams: Close
[0m01:28:08.132220 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m01:28:08.134348 [debug] [Thread-4 (]: On model.nba.stg_team_spend_by_season: Close
[0m01:28:08.145251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m01:28:08.147936 [debug] [Thread-1 (]: On model.nba.stg_common_player_info: Close
[0m01:28:08.169967 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m01:28:08.172242 [debug] [Thread-3 (]: On model.nba.stg_player_game_logs: Close
[0m01:28:08.275332 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2610810>]}
[0m01:28:08.276359 [info ] [Thread-5 (]: 5 of 12 OK created sql view model staging.stg_team_stats_by_season ............. [[32mSUCCESS 1[0m in 1.04s]
[0m01:28:08.278331 [debug] [Thread-5 (]: Finished running node model.nba.stg_team_stats_by_season
[0m01:28:08.280356 [debug] [Thread-8 (]: Began running node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.282242 [info ] [Thread-8 (]: 7 of 12 START sql table model warehouse.fct_playoff_appearances_by_team_example  [RUN]
[0m01:28:08.284107 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.nba.fct_playoff_appearances_by_team_example'
[0m01:28:08.285764 [debug] [Thread-8 (]: Began compiling node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.291112 [debug] [Thread-8 (]: Writing injected SQL for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.293265 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m01:28:08.294873 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98acbd50>]}
[0m01:28:08.297413 [debug] [Thread-2 (]: On model.nba.stg_games: Close
[0m01:28:08.297975 [debug] [Thread-8 (]: Began executing node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:08.298835 [info ] [Thread-6 (]: 6 of 12 OK created sql view model staging.stg_teams ............................ [[32mSUCCESS 1[0m in 1.04s]
[0m01:28:08.325759 [debug] [Thread-8 (]: Writing runtime sql for node "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.327189 [debug] [Thread-6 (]: Finished running node model.nba.stg_teams
[0m01:28:08.329056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b4b650>]}
[0m01:28:08.334103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b5c5d0>]}
[0m01:28:08.335041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fcc9d0>]}
[0m01:28:08.337181 [debug] [Thread-8 (]: Using snowflake connection "model.nba.fct_playoff_appearances_by_team_example"
[0m01:28:08.338077 [info ] [Thread-4 (]: 4 of 12 OK created sql view model staging.stg_team_spend_by_season ............. [[32mSUCCESS 1[0m in 1.09s]
[0m01:28:08.339928 [info ] [Thread-1 (]: 1 of 12 OK created sql view model staging.stg_common_player_info ............... [[32mSUCCESS 1[0m in 1.10s]
[0m01:28:08.341782 [info ] [Thread-3 (]: 3 of 12 OK created sql view model staging.stg_player_game_logs ................. [[32mSUCCESS 1[0m in 1.10s]
[0m01:28:08.343441 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_appearances_by_team_example"} */
create or replace transient table NBA.warehouse.fct_playoff_appearances_by_team_example
         as
        (-- Calculate playoff appearances and percentages for NBA teams

-- Common Table Expressions (CTEs)
-- Select relevant team stats and identify the most recent season for each team
WITH recent_team_stats AS (
    SELECT
        team_id,
        team_name,
        season,
        -- Use ROW_NUMBER() to assign a unique rank (rn) to each row within a team's partition
        -- The rows are ordered by season in descending order for each team
        -- This ensures that the most recent season gets rn = 1 for each team
        ROW_NUMBER() OVER (PARTITION BY team_id ORDER BY season DESC) AS rn,
        -- Check if both playoff_wins and playoff_losses are equal to zero
        -- If true, set playoff_appearance to 0; otherwise, set it to 1
        CASE WHEN playoff_wins = 0 AND playoff_losses = 0 THEN 0 ELSE 1 END AS playoff_appearance
    FROM
        NBA.staging.stg_team_stats_by_season
    WHERE 
        season NOT IN ('2023-2024')
),

-- Determine the most recent team name for each team
most_recent_team_names AS (
    SELECT
        team_id,
        team_name
    FROM
        recent_team_stats
    WHERE
        rn = 1
),

-- Count seasons played and sum playoff appearances for each team
seasons_played AS (
    SELECT
        team_id,
        COUNT(team_id) AS seasons_played,
        SUM(playoff_appearance) AS playoff_appearances
    FROM
        recent_team_stats
    GROUP BY
        team_id
),

-- Calculate playoff appearance percentage for each team
playoff_appearance_pct AS (
    SELECT 
        sp.team_id,
        sp.seasons_played,
        sp.playoff_appearances,
        -- Calculate playoff appearance percentage (playoff_appearances / seasons_played)
        sp.playoff_appearances / sp.seasons_played AS playoff_appearance_pct
    FROM
        seasons_played sp
)

-- Final query to retrieve results
SELECT 
    pat.team_id,
    mrt.team_name,
    pat.seasons_played,
    pat.playoff_appearances,
    pat.playoff_appearance_pct
FROM
    playoff_appearance_pct pat
JOIN
    most_recent_team_names mrt ON pat.team_id = mrt.team_id
ORDER BY 
    pat.playoff_appearances DESC
        );
[0m01:28:08.345336 [debug] [Thread-4 (]: Finished running node model.nba.stg_team_spend_by_season
[0m01:28:08.347188 [debug] [Thread-1 (]: Finished running node model.nba.stg_common_player_info
[0m01:28:08.348985 [debug] [Thread-3 (]: Finished running node model.nba.stg_player_game_logs
[0m01:28:08.350639 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m01:28:08.354587 [debug] [Thread-5 (]: Began running node model.nba.fct_players_by_college_example
[0m01:28:08.356333 [debug] [Thread-6 (]: Began running node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.356877 [debug] [Thread-4 (]: Began running node model.nba.player_game_logs_agg_example
[0m01:28:08.360282 [info ] [Thread-5 (]: 8 of 12 START sql table model warehouse.fct_players_by_college_example ......... [RUN]
[0m01:28:08.361861 [info ] [Thread-6 (]: 9 of 12 START sql table model warehouse.fct_playoff_games_by_player_example .... [RUN]
[0m01:28:08.363737 [info ] [Thread-4 (]: 10 of 12 START sql view model intermediate.player_game_logs_agg_example ........ [RUN]
[0m01:28:08.365540 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_stats_by_season, now model.nba.fct_players_by_college_example)
[0m01:28:08.367288 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.nba.stg_teams, now model.nba.fct_playoff_games_by_player_example)
[0m01:28:08.369096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nba.stg_team_spend_by_season, now model.nba.player_game_logs_agg_example)
[0m01:28:08.370919 [debug] [Thread-5 (]: Began compiling node model.nba.fct_players_by_college_example
[0m01:28:08.372712 [debug] [Thread-6 (]: Began compiling node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.374537 [debug] [Thread-4 (]: Began compiling node model.nba.player_game_logs_agg_example
[0m01:28:08.379461 [debug] [Thread-5 (]: Writing injected SQL for node "model.nba.fct_players_by_college_example"
[0m01:28:08.383319 [debug] [Thread-6 (]: Writing injected SQL for node "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.388783 [debug] [Thread-4 (]: Writing injected SQL for node "model.nba.player_game_logs_agg_example"
[0m01:28:08.393376 [debug] [Thread-5 (]: Began executing node model.nba.fct_players_by_college_example
[0m01:28:08.399644 [debug] [Thread-5 (]: Writing runtime sql for node "model.nba.fct_players_by_college_example"
[0m01:28:08.400391 [debug] [Thread-6 (]: Began executing node model.nba.fct_playoff_games_by_player_example
[0m01:28:08.402535 [debug] [Thread-4 (]: Began executing node model.nba.player_game_logs_agg_example
[0m01:28:08.407545 [debug] [Thread-6 (]: Writing runtime sql for node "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.410920 [debug] [Thread-4 (]: Writing runtime sql for node "model.nba.player_game_logs_agg_example"
[0m01:28:08.412813 [debug] [Thread-5 (]: Using snowflake connection "model.nba.fct_players_by_college_example"
[0m01:28:08.418787 [debug] [Thread-6 (]: Using snowflake connection "model.nba.fct_playoff_games_by_player_example"
[0m01:28:08.419427 [debug] [Thread-5 (]: On model.nba.fct_players_by_college_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_players_by_college_example"} */
create or replace transient table NBA.warehouse.fct_players_by_college_example
         as
        (-- The initial Common Table Expression (CTE) aggregates player game logs. It identifies players who have played more than 0 minutes, essentially filtering out players who have no playing time recorded.
WITH players_by_college AS (
    SELECT 
        school,
        count(*) as player_count
    FROM 
        NBA.staging.stg_common_player_info
    WHERE
        school is not null -- This ensures that only rows with a non-null school are included
    GROUP BY
        school
    ORDER BY
        player_count DESC -- This orders the results by the number of players, from highest to lowest
)

SELECT 
    *
FROM 
    players_by_college
        );
[0m01:28:08.420128 [debug] [Thread-6 (]: On model.nba.fct_playoff_games_by_player_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_playoff_games_by_player_example"} */
create or replace transient table NBA.warehouse.fct_playoff_games_by_player_example
         as
        (WITH playoff_stats AS (
    SELECT
        player_id,
        player_name,
        COUNT(*) AS playoff_games,
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS playoff_wins
    FROM
        NBA.staging.stg_player_game_logs
    WHERE
        game_type = 'Playoffs'
    AND
        mins_played > 0
    GROUP BY
        player_id,
        player_name
),
playoff_win_percentage AS (
    SELECT
        player_id,
        player_name,
        playoff_games,
        playoff_wins,
        (CAST(playoff_wins AS FLOAT) / playoff_games) AS win_percentage
    FROM
        playoff_stats
), 

nba_greatest AS (
    SELECT
        player_id,
        greatest_75_member
    FROM
        NBA.staging.stg_common_player_info
),

joined AS (
    SELECT
        pwp.*,
        ng.greatest_75_member
    FROM 
        playoff_win_percentage pwp
    JOIN nba_greatest ng ON
        pwp.player_id = ng.player_id
)

SELECT
    player_id,
    CASE 
        WHEN greatest_75_member = 'true' THEN player_name || '*'
        ELSE player_name
    END AS player_name,
    playoff_games,
    playoff_wins,
    win_percentage
FROM
    joined
ORDER BY
    playoff_games DESC, playoff_wins DESC
        );
[0m01:28:08.424460 [debug] [Thread-4 (]: Using snowflake connection "model.nba.player_game_logs_agg_example"
[0m01:28:08.425102 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m01:28:08.427069 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m01:28:08.429018 [debug] [Thread-4 (]: On model.nba.player_game_logs_agg_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.player_game_logs_agg_example"} */
create or replace   view NBA.intermediate.player_game_logs_agg_example
  
   as (
    -- Aggregate player game logs for regular season games
WITH player_game_logs_agg AS (
    SELECT 
        player_id,
        player_name,
        season,
        game_type,
        -- Total field goals made by the player
        SUM(field_goals_made) AS field_goals_made,
        -- Total field goals attempted by the player
        SUM(field_goals_attempted) AS field_goals_attempted,
        -- Field goal percentage using macro
        
    CASE 
        WHEN SUM(field_goals_attempted) = 0 OR SUM(field_goals_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(field_goals_made) AS FLOAT) / CAST(SUM(field_goals_attempted) AS FLOAT) * 100, 2)
    END
 AS field_goal_pct,
        -- Total three-point field goals made by the player
        SUM(three_point_made) AS three_point_made,
        -- Total three-point field goals attempted by the player
        SUM(three_point_attempted) AS three_point_attempted,
        -- Three-point field goal percentage using macro
        
    CASE 
        WHEN SUM(three_point_attempted) = 0 OR SUM(three_point_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(three_point_made) AS FLOAT) / CAST(SUM(three_point_attempted) AS FLOAT) * 100, 2)
    END
 AS three_point_pct,
        -- Total free throws made by the player
        SUM(free_throws_made) AS free_throws_made,
        -- Total free throws attempted by the player
        SUM(free_throws_attempted) AS free_throws_attempted,
        -- Free throw percentage using macro
        
    CASE 
        WHEN SUM(free_throws_attempted) = 0 OR SUM(free_throws_attempted) IS NULL THEN 0
        ELSE ROUND(CAST(SUM(free_throws_made) AS FLOAT) / CAST(SUM(free_throws_attempted) AS FLOAT) * 100, 2)
    END
 AS free_throw_pct,
        -- Total rebounds grabbed by the player
        SUM(total_rebounds) AS total_rebounds,
        -- Total offensive rebounds grabbed by the player
        SUM(offensive_rebounds) AS offensive_rebounds,
        -- Total defensive rebounds grabbed by the player
        SUM(defensive_rebounds) AS defensive_rebounds,
        -- Total assists made by the player
        SUM(assists) AS assists,
        -- Total blocks made by the player
        SUM(blocks) AS blocks,
        -- Total steals made by the player
        SUM(steals) AS steals,
        -- Total personal fouls committed by the player
        SUM(personal_fouls) AS personal_fouls,
        -- Total turnovers committed by the player
        SUM(turnovers) AS turnovers,
        -- Total points scored by the player
        SUM(points) AS total_points,
        -- Plus-minus statistic for the player
        AVG(points) AS avg_points,
        -- Plus-minus statistic for the player 
        SUM(plus_minus) AS plus_minus,
        -- Total minutes played by the player
        SUM(mins_played) AS mins_played,
        -- Count of losses when the player participated
        SUM(CASE WHEN win_loss = 'L' THEN 1 ELSE 0 END) AS loss_counter,
        -- Count of wins when the player participated
        SUM(CASE WHEN win_loss = 'W' THEN 1 ELSE 0 END) AS win_counter,
        -- Count of games played (excluding games with 0 minutes played)
        SUM(CASE WHEN mins_played > 0 THEN 1 ELSE 0 END) AS games_played_counter
    FROM 
        -- Reference to the source data table containing player game logs
        NBA.staging.stg_player_game_logs
    GROUP BY 
        player_id, player_name, season, game_type
)

-- Select all aggregated player game statistics
SELECT
    * 
FROM
    player_game_logs_agg
  );
[0m01:28:08.434955 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:28:08.491776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b7b710>]}
[0m01:28:08.492758 [info ] [Thread-2 (]: 2 of 12 OK created sql view model staging.stg_games ............................ [[32mSUCCESS 1[0m in 1.25s]
[0m01:28:08.494664 [debug] [Thread-2 (]: Finished running node model.nba.stg_games
[0m01:28:09.192453 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m01:28:09.194783 [debug] [Thread-4 (]: On model.nba.player_game_logs_agg_example: Close
[0m01:28:09.398140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0f38d0>]}
[0m01:28:09.399143 [info ] [Thread-4 (]: 10 of 12 OK created sql view model intermediate.player_game_logs_agg_example ... [[32mSUCCESS 1[0m in 1.03s]
[0m01:28:09.401285 [debug] [Thread-4 (]: Finished running node model.nba.player_game_logs_agg_example
[0m01:28:09.403285 [debug] [Thread-7 (]: Began running node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.403927 [debug] [Thread-3 (]: Began running node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.405018 [info ] [Thread-7 (]: 11 of 12 START sql table model warehouse.fct_player_points_per_playoff_season_example  [RUN]
[0m01:28:09.406976 [info ] [Thread-3 (]: 12 of 12 START sql table model warehouse.fct_player_points_per_regular_season_example  [RUN]
[0m01:28:09.408888 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.nba.fct_player_points_per_playoff_season_example'
[0m01:28:09.410652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nba.stg_player_game_logs, now model.nba.fct_player_points_per_regular_season_example)
[0m01:28:09.412519 [debug] [Thread-7 (]: Began compiling node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.414388 [debug] [Thread-3 (]: Began compiling node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.419731 [debug] [Thread-7 (]: Writing injected SQL for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.423168 [debug] [Thread-3 (]: Writing injected SQL for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.427715 [debug] [Thread-7 (]: Began executing node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:09.430916 [debug] [Thread-7 (]: Writing runtime sql for node "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.431516 [debug] [Thread-3 (]: Began executing node model.nba.fct_player_points_per_regular_season_example
[0m01:28:09.436302 [debug] [Thread-3 (]: Writing runtime sql for node "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.439728 [debug] [Thread-7 (]: Using snowflake connection "model.nba.fct_player_points_per_playoff_season_example"
[0m01:28:09.441126 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_playoff_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_playoff_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per playoff season
most_points_per_playoff_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Playoffs' -- Filter the data to include only playoff games
)

SELECT 
    *
FROM 
    most_points_per_playoff_season
ORDER BY 
    total_points DESC
        );
[0m01:28:09.443123 [debug] [Thread-3 (]: Using snowflake connection "model.nba.fct_player_points_per_regular_season_example"
[0m01:28:09.443740 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m01:28:09.445652 [debug] [Thread-3 (]: On model.nba.fct_player_points_per_regular_season_example: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nba", "target_name": "dev", "node_id": "model.nba.fct_player_points_per_regular_season_example"} */
create or replace transient table NBA.warehouse.fct_player_points_per_regular_season_example
         as
        (-- Define a Common Table Expression (CTE) to select player game log details
WITH source AS (
    -- Selecting specific columns from the player game logs aggregated example table
    SELECT 
        player_id,       -- Unique identifier for each player
        player_name,     -- Name of the player
        season,          -- NBA season
        total_points,    -- Total Points scored by the player
        avg_points,      -- Average Points scored by the player
        game_type        -- Type of the game (e.g., "Regular Season", "Playoffs")
    FROM
        NBA.intermediate.player_game_logs_agg_example -- Reference to the aggregated player game logs table
),

-- Define a second CTE to select players with the most points per regular season
most_points_per_regular_season as (
    SELECT
        player_id,
        -- Concatenate player name with season, extracting the last two digits of the season start year
        -- and removing any spaces, then wrapping the season in parentheses
        CONCAT(player_name, ' (', REPLACE(SUBSTRING(season, 3, 6), ' ', ''), ')') AS player_season,
        total_points,
        avg_points
    FROM 
        source
    WHERE
        game_type = 'Regular Season' -- Filter the data to include only regular season games
)

SELECT 
    *
FROM 
    most_points_per_regular_season
ORDER BY 
    total_points DESC
        );
[0m01:28:09.449538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:28:09.708801 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 1.284 seconds
[0m01:28:09.711139 [debug] [Thread-5 (]: On model.nba.fct_players_by_college_example: Close
[0m01:28:09.787057 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 1.436 seconds
[0m01:28:09.790213 [debug] [Thread-8 (]: On model.nba.fct_playoff_appearances_by_team_example: Close
[0m01:28:09.797826 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 1.371 seconds
[0m01:28:09.799863 [debug] [Thread-6 (]: On model.nba.fct_playoff_games_by_player_example: Close
[0m01:28:09.901460 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c93310>]}
[0m01:28:09.902487 [info ] [Thread-5 (]: 8 of 12 OK created sql table model warehouse.fct_players_by_college_example .... [[32mSUCCESS 1[0m in 1.54s]
[0m01:28:09.904584 [debug] [Thread-5 (]: Finished running node model.nba.fct_players_by_college_example
[0m01:28:09.957403 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b62290>]}
[0m01:28:09.958466 [info ] [Thread-8 (]: 7 of 12 OK created sql table model warehouse.fct_playoff_appearances_by_team_example  [[32mSUCCESS 1[0m in 1.67s]
[0m01:28:09.960376 [debug] [Thread-8 (]: Finished running node model.nba.fct_playoff_appearances_by_team_example
[0m01:28:09.968924 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2188610>]}
[0m01:28:09.969864 [info ] [Thread-6 (]: 9 of 12 OK created sql table model warehouse.fct_playoff_games_by_player_example  [[32mSUCCESS 1[0m in 1.60s]
[0m01:28:09.971701 [debug] [Thread-6 (]: Finished running node model.nba.fct_playoff_games_by_player_example
[0m01:28:10.698445 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.249 seconds
[0m01:28:10.700629 [debug] [Thread-3 (]: On model.nba.fct_player_points_per_regular_season_example: Close
[0m01:28:10.714324 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m01:28:10.716508 [debug] [Thread-7 (]: On model.nba.fct_player_points_per_playoff_season_example: Close
[0m01:28:10.882012 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b0e810>]}
[0m01:28:10.883010 [info ] [Thread-3 (]: 12 of 12 OK created sql table model warehouse.fct_player_points_per_regular_season_example  [[32mSUCCESS 1[0m in 1.47s]
[0m01:28:10.885059 [debug] [Thread-3 (]: Finished running node model.nba.fct_player_points_per_regular_season_example
[0m01:28:10.929025 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b6fa2b-f359-4844-b519-a136ca768101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d51910>]}
[0m01:28:10.930047 [info ] [Thread-7 (]: 11 of 12 OK created sql table model warehouse.fct_player_points_per_playoff_season_example  [[32mSUCCESS 1[0m in 1.52s]
[0m01:28:10.932097 [debug] [Thread-7 (]: Finished running node model.nba.fct_player_points_per_playoff_season_example
[0m01:28:10.937533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:10.938119 [debug] [MainThread]: Connection 'model.nba.stg_games' was properly closed.
[0m01:28:10.940446 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_regular_season_example' was properly closed.
[0m01:28:10.942826 [debug] [MainThread]: Connection 'model.nba.stg_common_player_info' was properly closed.
[0m01:28:10.944968 [debug] [MainThread]: Connection 'model.nba.fct_players_by_college_example' was properly closed.
[0m01:28:10.947314 [debug] [MainThread]: Connection 'model.nba.player_game_logs_agg_example' was properly closed.
[0m01:28:10.949194 [debug] [MainThread]: Connection 'model.nba.fct_playoff_games_by_player_example' was properly closed.
[0m01:28:10.950961 [debug] [MainThread]: Connection 'model.nba.fct_playoff_appearances_by_team_example' was properly closed.
[0m01:28:10.952800 [debug] [MainThread]: Connection 'model.nba.fct_player_points_per_playoff_season_example' was properly closed.
[0m01:28:10.954831 [info ] [MainThread]: 
[0m01:28:10.956523 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m01:28:10.959963 [debug] [MainThread]: Command end result
[0m01:28:11.011413 [info ] [MainThread]: 
[0m01:28:11.012169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:11.014060 [info ] [MainThread]: 
[0m01:28:11.015949 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m01:28:11.018512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.409383, "process_user_time": 3.972234, "process_kernel_time": 0.4092, "process_mem_max_rss": "243340", "process_out_blocks": "9168", "process_in_blocks": "0"}
[0m01:28:11.020015 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:11.019864 after 8.41 seconds
[0m01:28:11.021787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3992250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a7e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f0b5d0>]}
[0m01:28:11.023594 [debug] [MainThread]: Flushing usage events
